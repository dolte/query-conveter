<mapper namespace="kr.or.komca.center..mapper.Mapper">
<delete id="SQLindtn_rept_save2_DEL1" parameterType="">
Delete from
	GIBU.TBRA_REPT_ERR
where
	UPSO_CD = #{upsoCd}
</delete>

<select id="SQLindtn_rept_save2_SEL2" parameterType="" resultType="">
SELECT
	DECODE(COMPN_DAY, NULL, 1, DECODE(JUDG_CD, 2, 1, 4, 1, 0)) ACCU_CNT,
	JUDG_CD
FROM
	(
		SELECT
			UPSO_CD,
			COMPN_DAY,
			JUDG_CD
		FROM
			GIBU.TBRA_ACCU
		WHERE
			UPSO_CD = #{upsoCd}
			AND COMPN_DAY IS NULL
		ORDER BY
			ACCU_DAY DESC
	)
WHERE
	ROWNUM = 1
</select>

<select id="SQLindtn_rept_save2_SEL3" parameterType="" resultType="">
SELECT
	REPT_DAY,
	REPT_NUM,
	REPT_GBN,
	UPSO_CD,
	START_YRMN,
	END_YRMN,
	REPT_AMT,
	COMIS,
	RECV_DAY,
	ACCN_NUM,
	ERR_GBN,
	ERR_CTENT
FROM
	GIBU.TBRA_REPT_ERR
WHERE
	REPT_DAY = #{reptDay}
	AND REPT_GBN = #{reptGbn}
	AND UPSO_CD = #{upsoCd}
</select>

<select id="SQLindtn_rept_save2_SEL8" parameterType="" resultType="">
SELECT
	ACCU_GBN
FROM
	GIBU.TBRA_NOTE
WHERE
	UPSO_CD = #{upsoCd}
	AND REPT_DAY = #{reptDay}
	AND REPT_NUM = #{reptNum}
	AND REPT_GBN = #{reptGbn}
	AND ROWNUM = 1
</select>

<select id="SQLrept_detail_select_SEL1" parameterType="" resultType="">
SELECT
	B.MONPRNCFEE,
	B.BSTYP_CD,
	B.UPSO_GRAD,
	B.GRAD,
	C.GRADNM,
	A.MNGEMSTR_NM,
	A.CLSBS_YRMN,
	A.STAFF_CD,
	E.HAN_NM STAFF_NM,
	A.UPSO_CD,
	A.UPSO_NM,
	GIBU.FT_GET_LAST_REPT_YRMN(#{upsoCd}, 8) LAST_YRMN,
	NVL(D.BALANCE, 0) BALANCE,
	NVL(F.ACCU_CNT, 0) ACCU_CNT,
	F.JUDG_CD,
	A.BRAN_CD,
	G.CLAIM_CNT,
	A.SONG_STUDENT,
	A.AERO_STUDENT
FROM
	GIBU.TBRA_UPSO A,
	(
		SELECT
			UPSO_CD,
			BSTYP_CD,
			UPSO_GRAD,
			MONPRNCFEE,
			GRAD
		FROM
			(
				SELECT
					UPSO_CD,
					BSTYP_CD,
					UPSO_GRAD,
					MONPRNCFEE,
					TRIM(BSTYP_CD) || UPSO_GRAD GRAD
				FROM
					GIBU.TBRA_UPSORTAL_INFO
				WHERE
					UPSO_CD = #{upsoCd}
				ORDER BY
					CHG_DAY DESC,
					CHG_NUM DESC
			)
		WHERE
			ROWNUM = 1
	) B,
	GIBU.TBRA_BSTYPGRAD C,
	(
		SELECT
			#{upsoCd} UPSO_CD,
			NVL(SUM(BALANCE), 0) BALANCE
		FROM
			(
				SELECT
					BALANCE
				FROM
					GIBU.TBRA_REPT_BALANCE
				WHERE
					UPSO_CD = #{upsoCd}
				ORDER BY
					PROC_DAY DESC,
					PROC_NUM DESC
			)
		WHERE
			ROWNUM = 1
	) D,
	INSA.TINS_MST01 E,
	(
		SELECT
			DECODE(COMPN_DAY, NULL, 1, DECODE(JUDG_CD, 2, 1, 4, 1, 0)) ACCU_CNT,
			JUDG_CD,
			UPSO_CD
		FROM
			(
				SELECT
					UPSO_CD,
					COMPN_DAY,
					JUDG_CD
				FROM
					GIBU.TBRA_ACCU
				WHERE
					UPSO_CD = #{upsoCd}
					AND COMPN_DAY IS NULL
				ORDER BY
					ACCU_DAY DESC
			)
		WHERE
			ROWNUM = 1
	) F,
	(
		SELECT
			COUNT(UPSO_CD) CLAIM_CNT
		FROM
			GIBU.TBRA_DLGTN_CLAIM
		WHERE
			UPSO_CD = #{upsoCd}
			AND COMPN_DAY IS NULL
	) G
WHERE
	A.UPSO_CD = #{upsoCd}
	AND B.UPSO_CD = A.UPSO_CD
	AND C.BSTYP_CD = B.BSTYP_CD
	AND C.GRAD_GBN = B.UPSO_GRAD
	AND D.UPSO_CD = A.UPSO_CD
	AND F.UPSO_CD (+) = A.UPSO_CD
	AND E.STAFF_NUM(+) = A.STAFF_CD
</select>

<select id="SQLrept_detail_select_SEL2" parameterType="" resultType="">
SELECT
	A.UPSO_CD,
	A.REPT_DAY,
	A.REPT_NUM,
	A.REPT_GBN,
	MAX(A.DEMD_YRMN) DEMD_YRMN,
	B.DISTR_GBN,
	A.DISTR_SEQ,
	A.ACCU_GBN
FROM
	GIBU.TBRA_NOTE A,
	GIBU.TBRA_REPT B
WHERE
	A.UPSO_CD = #{upsoCd}
	AND A.NOTE_YRMN = #{noteYrmn}
	AND A.NOTE_NUM = '0001'
	AND B.REPT_DAY = A.REPT_DAY
	AND B.REPT_NUM = A.REPT_NUM
	AND B.REPT_GBN = A.REPT_GBN
GROUP BY
	A.UPSO_CD,
	A.REPT_DAY,
	A.REPT_NUM,
	A.REPT_GBN,
	A.ACCU_GBN,
	B.DISTR_GBN,
	A.DISTR_SEQ
</select>

<select id="SQLrept_detail_select_SEL27" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	C.SOL_ORG_AMT TOT_USE_AMT,
	C.SOL_ADDT_AMT TOT_ADDT_AMT,
	C.SOL_ORG_AMT + C.SOL_ADDT_AMT TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	D.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	C.COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
	) A,
	(
		SELECT
			XA.BRAN_CD,
			XA.REPT_DAY,
			XA.REPT_NUM,
			XA.REPT_GBN,
			XA.DISTR_GBN,
			XA.DISTR_SEQ,
			XA.DISTR_AMT AS REPT_AMT,
			XB.RECV_DAY,
			XB.COMIS,
			XB.BANK_CD,
			XB.ACCN_NUM,
			XA.REMAK,
			XB.MAPPING_DAY
		FROM
			GIBU.TBRA_REPT_UPSO_DISTR XA,
			GIBU.TBRA_REPT XB
		WHERE
			XA.UPSO_CD = #{upsoCd}
			AND XA.REPT_DAY = #{reptDay}
			AND XA.REPT_NUM = #{reptNum}
			AND XA.REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
			AND XB.REPT_DAY = XA.REPT_DAY
			AND XB.REPT_NUM = XA.REPT_NUM
			AND XB.REPT_GBN = XA.REPT_GBN
	) B,
	(
		SELECT
			SOL_ORG_AMT,
			SOL_ADDT_AMT,
			COMPN_DAY,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
		FROM
			GIBU.TBRA_ACCU
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
	) C,
	ACCT.TCAC_BANK D
WHERE
	D.BANK_CD = B.BANK_CD
	AND A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND A.DISTR_SEQ(+) = B.DISTR_SEQ
	AND C.REPT_DAY(+) = B.REPT_DAY
	AND C.REPT_NUM(+) = B.REPT_NUM
	AND C.REPT_GBN(+) = B.REPT_GBN
	AND C.DISTR_SEQ(+) = B.DISTR_SEQ
</select>

<select id="SQLrept_detail_select_SEL28" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.MONPRNCFEE,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_OCR XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_select_SEL29" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	C.SOL_AMT TOT_USE_AMT,
	0 TOT_ADDT_AMT,
	C.SOL_AMT TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	D.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	'' AS COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
	) A,
	(
		SELECT
			XA.BRAN_CD,
			XA.REPT_DAY,
			XA.REPT_NUM,
			XA.REPT_GBN,
			XA.DISTR_GBN,
			XA.DISTR_SEQ,
			XA.DISTR_AMT AS REPT_AMT,
			XB.RECV_DAY,
			XB.COMIS,
			XB.BANK_CD,
			XB.ACCN_NUM,
			XA.REMAK,
			XB.MAPPING_DAY
		FROM
			GIBU.TBRA_REPT_UPSO_DISTR XA,
			GIBU.TBRA_REPT XB
		WHERE
			XA.UPSO_CD = #{upsoCd}
			AND XA.REPT_DAY = #{reptDay}
			AND XA.REPT_NUM = #{reptNum}
			AND XA.REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
			AND XB.REPT_DAY = XA.REPT_DAY
			AND XB.REPT_NUM = XA.REPT_NUM
			AND XB.REPT_GBN = XA.REPT_GBN
	) B,
	(
		SELECT
			SOL_AMT,
			UPSO_CD,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
		FROM
			GIBU.TBRA_DLGTN_CLAIM
		WHERE
			UPSO_CD = #{upsoCd}
	) C,
	ACCT.TCAC_BANK D
WHERE
	D.BANK_CD = B.BANK_CD
	AND A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND A.DISTR_SEQ(+) = B.DISTR_SEQ
	AND C.REPT_DAY(+) = B.REPT_DAY
	AND C.REPT_NUM(+) = B.REPT_NUM
	AND C.REPT_GBN(+) = B.REPT_GBN
	AND C.DISTR_SEQ(+) = B.DISTR_SEQ
</select>

<select id="SQLrept_detail_select_SEL30" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_OCR XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_select_SEL9" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	NULL TOT_USE_AMT,
	NULL TOT_ADDT_AMT,
	NULL TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.DISTR_AMT AS REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	C.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	'' AS COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			DISTR_SEQ
	) A,
	(
		SELECT
			XA.BRAN_CD,
			XA.REPT_DAY,
			XA.REPT_NUM,
			XA.REPT_GBN,
			XA.DISTR_GBN,
			XA.DISTR_SEQ,
			XA.DISTR_AMT,
			XB.RECV_DAY,
			(
				CASE
					WHEN XA.REPT_GBN = '08'
					AND XA.DISTR_SEQ > 1 THEN TO_NUMBER('')
					ELSE XB.COMIS
				END
			) AS COMIS,
			XB.BANK_CD,
			XB.ACCN_NUM,
			XA.REMAK,
			XB.MAPPING_DAY
		FROM
			GIBU.TBRA_REPT_UPSO_DISTR XA,
			GIBU.TBRA_REPT XB
		WHERE
			XA.UPSO_CD = #{upsoCd}
			AND XA.REPT_DAY = #{reptDay}
			AND XA.REPT_NUM = #{reptNum}
			AND XA.REPT_GBN = #{reptGbn}
			AND DISTR_SEQ = #{distrSeq}
			AND XB.REPT_DAY = XA.REPT_DAY
			AND XB.REPT_NUM = XA.REPT_NUM
			AND XB.REPT_GBN = XA.REPT_GBN
	) B,
	ACCT.TCAC_BANK C
WHERE
	A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND A.DISTR_SEQ(+) = B.DISTR_SEQ
	AND C.BANK_CD (+) = B.BANK_CD
</select>

<select id="SQLrept_detail_select_SEL13" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_OCR XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_select_SEL4" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	C.SOL_ORG_AMT TOT_USE_AMT,
	C.SOL_ADDT_AMT TOT_ADDT_AMT,
	C.SOL_ORG_AMT + C.SOL_ADDT_AMT TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	D.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	C.COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
	) A,
	(
		SELECT
			BRAN_CD,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			NULL DISTR_GBN,
			NULL DISTR_SEQ,
			REPT_AMT,
			RECV_DAY,
			COMIS,
			BANK_CD,
			ACCN_NUM,
			REMAK,
			MAPPING_DAY
		FROM
			GIBU.TBRA_REPT
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
	) B,
	(
		SELECT
			SOL_ORG_AMT,
			SOL_ADDT_AMT,
			COMPN_DAY,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
		FROM
			GIBU.TBRA_ACCU
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
	) C,
	ACCT.TCAC_BANK D
WHERE
	D.BANK_CD = B.BANK_CD
	AND A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND C.REPT_DAY(+) = B.REPT_DAY
	AND C.REPT_NUM(+) = B.REPT_NUM
	AND C.REPT_GBN(+) = B.REPT_GBN
</select>

<select id="SQLrept_detail_select_SEL12" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.MONPRNCFEE,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_OCR XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_select_SEL8" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	C.SOL_AMT TOT_USE_AMT,
	0 TOT_ADDT_AMT,
	C.SOL_AMT TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	D.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	'' AS COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
	) A,
	(
		SELECT
			BRAN_CD,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			NULL DISTR_GBN,
			NULL DISTR_SEQ,
			REPT_AMT,
			RECV_DAY,
			COMIS,
			BANK_CD,
			ACCN_NUM,
			REMAK,
			MAPPING_DAY
		FROM
			GIBU.TBRA_REPT
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
	) B,
	(
		SELECT
			SOL_AMT,
			UPSO_CD,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
		FROM
			GIBU.TBRA_DLGTN_CLAIM
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
	) C,
	ACCT.TCAC_BANK D
WHERE
	D.BANK_CD = B.BANK_CD
	AND A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND C.REPT_DAY(+) = B.REPT_DAY
	AND C.REPT_NUM(+) = B.REPT_NUM
	AND C.REPT_GBN(+) = B.REPT_GBN
</select>

<select id="SQLrept_detail_select_SEL19" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_OCR XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_select_SEL6" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	C.TOT_USE_AMT,
	C.TOT_ADDT_AMT,
	C.TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	D.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	'' AS COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
	) A,
	(
		SELECT
			BRAN_CD,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			NULL DISTR_GBN,
			NULL DISTR_SEQ,
			REPT_AMT,
			RECV_DAY,
			COMIS,
			BANK_CD,
			ACCN_NUM,
			REMAK,
			UPSO_CD,
			MAPPING_DAY
		FROM
			GIBU.TBRA_REPT
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
	) B,
	(
		SELECT
			TOT_USE_AMT,
			TOT_ADDT_AMT,
			TOT_DEMD_AMT,
			UPSO_CD
		FROM
			GIBU.TBRA_DEMD_AUTO
		WHERE
			DEMD_YRMN || UPSO_CD = (
				SELECT
					MAX(DEMD_YRMN) || #{upsoCd}
				FROM
					GIBU.TBRA_DEMD_REPT
				WHERE
					UPSO_CD = #{upsoCd}
					AND REPT_DAY = #{reptDay}
					AND REPT_NUM = #{reptNum}
					AND REPT_GBN = #{reptGbn}
			)
	) C,
	ACCT.TCAC_BANK D
WHERE
	D.BANK_CD = B.BANK_CD
	AND A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND C.UPSO_CD (+) = B.UPSO_CD
</select>

<select id="SQLrept_detail_select_SEL11" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_AUTO XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_select_SEL10" parameterType="" resultType="">
SELECT
	DECODE(A.START_YRMN, NULL, NULL, A.START_YRMN || '01') START_YRMN,
	DECODE(A.END_YRMN, NULL, NULL, A.END_YRMN || '01') END_YRMN,
	C.TOT_USE_AMT,
	C.TOT_ADDT_AMT,
	C.TOT_DEMD_AMT,
	B.BRAN_CD REPT_BRAN,
	B.RECV_DAY,
	B.REPT_AMT,
	B.COMIS,
	B.BANK_CD,
	B.ACCN_NUM,
	D.BANK_NM,
	B.REMAK,
	B.DISTR_GBN,
	B.DISTR_SEQ,
	'' AS COMPN_DAY,
	#{reptDay} AS REPT_DAY,
	#{reptNum} AS REPT_NUM,
	#{reptGbn} AS REPT_GBN,
	#{demdYrmn} AS DEMD_YRMN,
	B.MAPPING_DAY
FROM
	(
		SELECT
			MIN(NOTE_YRMN) START_YRMN,
			MAX(NOTE_YRMN) END_YRMN,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
		GROUP BY
			REPT_DAY,
			REPT_NUM,
			REPT_GBN
	) A,
	(
		SELECT
			BRAN_CD,
			REPT_DAY,
			REPT_NUM,
			REPT_GBN,
			NULL DISTR_GBN,
			NULL DISTR_SEQ,
			REPT_AMT,
			RECV_DAY,
			COMIS,
			BANK_CD,
			ACCN_NUM,
			REMAK,
			UPSO_CD,
			MAPPING_DAY
		FROM
			GIBU.TBRA_REPT
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_DAY = #{reptDay}
			AND REPT_NUM = #{reptNum}
			AND REPT_GBN = #{reptGbn}
	) B,
	(
		SELECT
			TOT_USE_AMT,
			TOT_ADDT_AMT,
			TOT_DEMD_AMT,
			UPSO_CD
		FROM
			GIBU.TBRA_DEMD_OCR
		WHERE
			DEMD_YRMN || UPSO_CD = (
				SELECT
					MAX(DEMD_YRMN) || #{upsoCd}
				FROM
					GIBU.TBRA_DEMD_REPT
				WHERE
					UPSO_CD = #{upsoCd}
					AND REPT_DAY = #{reptDay}
					AND REPT_NUM = #{reptNum}
					AND REPT_GBN = #{reptGbn}
			)
	) C,
	ACCT.TCAC_BANK D
WHERE
	D.BANK_CD(+) = B.BANK_CD
	AND A.REPT_DAY(+) = B.REPT_DAY
	AND A.REPT_NUM(+) = B.REPT_NUM
	AND A.REPT_GBN(+) = B.REPT_GBN
	AND C.UPSO_CD (+) = B.UPSO_CD
</select>

<select id="SQLrept_detail_select_SEL14" parameterType="" resultType="">
SELECT
	XC.UPSO_CD,
	XC.DEMD_YRMN || '01' DEMD_YRMN,
	DECODE(XC.START_YRMN, NULL, NULL, XC.START_YRMN || '01') START_YRMN,
	DECODE(XC.END_YRMN, NULL, NULL, XC.END_YRMN || '01') END_YRMN,
	XC.TOT_DEMD_AMT,
	XC.TOT_USE_AMT,
	XC.TOT_ADDT_AMT,
	XC.TOT_EADDT_AMT,
	XC.DEMD_GBN,
	XD.CODE_NM DEMD_GBN_NM,
	XA.NOTE_YRMN
FROM
	GIBU.TBRA_NOTE XA,
	GIBU.TBRA_DEMD_OCR XC,
	FIDU.TENV_CODE XD
WHERE
	XA.NOTE_YRMN = #{noteYrmn}
	AND XA.UPSO_CD = #{upsoCd}
	AND XC.UPSO_CD = XA.UPSO_CD
	AND XC.DEMD_YRMN = XA.DEMD_YRMN
	AND XD.HIGH_CD = '00141'
	AND XD.CODE_CD = XC.DEMD_GBN
ORDER BY
	XC.DEMD_YRMN DESC
</select>

<select id="SQLrept_init_SEL1" parameterType="" resultType="">
SELECT
	B.MONPRNCFEE,
	B.BSTYP_CD,
	B.UPSO_GRAD,
	B.GRAD,
	C.GRADNM,
	A.MNGEMSTR_NM,
	A.CLSBS_YRMN,
	A.OPBI_DAY,
	A.STAFF_CD,
	E.HAN_NM STAFF_NM,
	A.UPSO_CD,
	A.UPSO_NM,
	GIBU.FT_GET_LAST_REPT_YRMN(#{upsoCd}, 8) LAST_YRMN,
	GIBU.FT_GET_START_REPT_YRMN(#{upsoCd}, 8) START_YRMN,
	NVL(D.BALANCE, 0) BALANCE,
	NVL(F.ACCU_CNT, 0) ACCU_CNT,
	F.JUDG_CD,
	A.BRAN_CD,
	G.CLAIM_CNT
FROM
	GIBU.TBRA_UPSO A,
	(
		SELECT
			UPSO_CD,
			BSTYP_CD,
			UPSO_GRAD,
			MONPRNCFEE,
			GRAD
		FROM
			(
				SELECT
					UPSO_CD,
					BSTYP_CD,
					UPSO_GRAD,
					MONPRNCFEE,
					TRIM(BSTYP_CD) || UPSO_GRAD GRAD
				FROM
					GIBU.TBRA_UPSORTAL_INFO
				WHERE
					UPSO_CD = #{upsoCd}
				ORDER BY
					CHG_DAY DESC,
					CHG_NUM DESC
			)
		WHERE
			ROWNUM = 1
	) B,
	GIBU.TBRA_BSTYPGRAD C,
	(
		SELECT
			#{upsoCd} UPSO_CD,
			NVL(SUM(BALANCE), 0) BALANCE
		FROM
			(
				SELECT
					BALANCE
				FROM
					GIBU.TBRA_REPT_BALANCE
				WHERE
					UPSO_CD = #{upsoCd}
				ORDER BY
					PROC_DAY DESC,
					PROC_NUM DESC
			)
		WHERE
			ROWNUM = 1
	) D,
	INSA.TINS_MST01 E,
	(
		SELECT
			DECODE(COMPN_DAY, NULL, 1, DECODE(JUDG_CD, 2, 1, 4, 1, 0)) ACCU_CNT,
			JUDG_CD,
			UPSO_CD
		FROM
			(
				SELECT
					UPSO_CD,
					COMPN_DAY,
					JUDG_CD
				FROM
					GIBU.TBRA_ACCU
				WHERE
					UPSO_CD = #{upsoCd}
					AND COMPN_DAY IS NULL
				ORDER BY
					ACCU_DAY DESC
			)
		WHERE
			ROWNUM = 1
	) F,
	(
		SELECT
			COUNT(UPSO_CD) CLAIM_CNT
		FROM
			GIBU.TBRA_DLGTN_CLAIM
		WHERE
			UPSO_CD = #{upsoCd}
			AND COMPN_DAY IS NULL
	) G
WHERE
	A.UPSO_CD = #{upsoCd}
	AND B.UPSO_CD = A.UPSO_CD
	AND C.BSTYP_CD = B.BSTYP_CD
	AND C.GRAD_GBN = B.UPSO_GRAD
	AND D.UPSO_CD = A.UPSO_CD
	AND F.UPSO_CD(+) = A.UPSO_CD
	AND E.STAFF_NUM(+) = A.STAFF_CD
</select>

<select id="SQLrept_init_SEL2" parameterType="" resultType="">
SELECT
	AA.UPSO_CD BB_UPSO_CD,
	AA.YRMN BB_REPT_YRMN,
	AA.MM BB_MM,
	AA.REPT_GBN BB_REPT_GBN,
	AA.CODE_NM BB_CODE_NM,
	AA.USE_AMT BB_USE_AMT,
	AA.REPT_DAY BB_REPT_DAY,
	AA.REPT_NUM BB_REPT_NUM,
	AA.RECV_DAY BB_RECV_DAY,
	AA.ACCU_GBN BB_ACCU_GBN,
	AA.DISTR_SEQ BB_DISTR_SEQ,
	AA.MAPPING_DAY BB_MAPPING_DAY,
	BB.UPSO_CD B_UPSO_CD,
	BB.YRMN B_REPT_YRMN,
	BB.MM B_MM,
	BB.REPT_GBN B_REPT_GBN,
	BB.CODE_NM B_CODE_NM,
	BB.USE_AMT B_USE_AMT,
	BB.REPT_DAY B_REPT_DAY,
	BB.REPT_NUM B_REPT_NUM,
	BB.RECV_DAY B_RECV_DAY,
	BB.ACCU_GBN B_ACCU_GBN,
	BB.DISTR_SEQ B_DISTR_SEQ,
	BB.MAPPING_DAY B_MAPPING_DAY,
	CC.UPSO_CD,
	CC.YRMN REPT_YRMN,
	CC.MM,
	CC.REPT_GBN,
	CC.CODE_NM,
	CC.USE_AMT,
	CC.REPT_DAY,
	CC.REPT_NUM,
	CC.RECV_DAY,
	CC.ACCU_GBN,
	CC.DISTR_SEQ,
	CC.MAPPING_DAY
FROM
	(
		SELECT
			ZB.YRMN,
			ZB.MM,
			ZA.UPSO_CD,
			ZA.NOTE_YRMN,
			ZA.REPT_GBN,
			DECODE(
				ZA.ACCU_GBN,
				NULL,
				ZA.CODE_NM,
				'06',
				'채권',
				'22',
				DECODE(ACCU_SOLCNT, 1, '고소해결', '고소분납')
			) CODE_NM,
			ZA.USE_AMT,
			ZA.REPT_DAY,
			ZA.REPT_NUM,
			ZA.RECV_DAY,
			ZA.ACCU_GBN,
			ZA.DISTR_SEQ,
			CASE
				WHEN REPT_GBN BETWEEN '11' AND '19' THEN REPT_DAY
				ELSE MAPPING_DAY
			END MAPPING_DAY
		FROM
			(
				SELECT
					A.UPSO_CD,
					A.NOTE_YRMN,
					A.REPT_GBN,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1)
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NOT NULL
							AND A.NOTE_YRMN BETWEEN SOL_START_YRMN AND SOL_END_YRMN
					) ACCU_SOLCNT,
					D.ACCU_CNT,
					A.USE_AMT,
					A.REPT_DAY,
					A.REPT_NUM,
					A.RECV_DAY,
					A.ACCU_GBN,
					A.DISTR_SEQ,
					A.MAPPING_DAY,
					C.CODE_NM
				FROM
					GIBU.TBRA_NOTE A,
					FIDU.TENV_CODE C,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1) ACCU_CNT
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NULL
					) D
				WHERE
					A.UPSO_CD = #{upsoCd}
					AND A.NOTE_YRMN BETWEEN TO_NUMBER(#{bbYear1}) -  2 || '01'
					AND TO_NUMBER(#{bbYear1}) -  2 || '12'
					AND C.HIGH_CD = '00141'
					AND DECODE(A.ACCU_GBN, NULL, A.REPT_GBN, A.ACCU_GBN) = C.CODE_CD
			) ZA,
			(
				SELECT
					YRMN,
					MM
				FROM
					GIBU.COPY_YRMN
				WHERE
					YYYY = TO_NUMBER(#{bbYear1}) -  2
			) ZB
		WHERE
			ZA.NOTE_YRMN(+) = ZB.YRMN
	) AA,
	(
		SELECT
			ZB.YRMN,
			ZB.MM,
			ZA.UPSO_CD,
			ZA.NOTE_YRMN,
			ZA.REPT_GBN,
			DECODE(
				ZA.ACCU_GBN,
				NULL,
				ZA.CODE_NM,
				'06',
				'채권',
				'22',
				DECODE(ACCU_SOLCNT, 1, '고소해결', '고소분납')
			) CODE_NM,
			ZA.USE_AMT,
			ZA.REPT_DAY,
			ZA.REPT_NUM,
			ZA.RECV_DAY,
			ZA.ACCU_GBN,
			ZA.DISTR_SEQ,
			CASE
				WHEN REPT_GBN BETWEEN '11' AND '19' THEN REPT_DAY
				ELSE MAPPING_DAY
			END MAPPING_DAY
		FROM
			(
				SELECT
					A.UPSO_CD,
					A.NOTE_YRMN,
					A.REPT_GBN,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1)
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NOT NULL
							AND A.NOTE_YRMN BETWEEN SOL_START_YRMN AND SOL_END_YRMN
					) ACCU_SOLCNT,
					D.ACCU_CNT,
					A.USE_AMT,
					A.REPT_DAY,
					A.REPT_NUM,
					A.RECV_DAY,
					A.ACCU_GBN,
					A.DISTR_SEQ,
					A.MAPPING_DAY,
					C.CODE_NM
				FROM
					GIBU.TBRA_NOTE A,
					FIDU.TENV_CODE C,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1) ACCU_CNT
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NULL
					) D
				WHERE
					A.UPSO_CD = #{upsoCd}
					AND A.NOTE_YRMN BETWEEN TO_NUMBER(#{bYear1}) -  1 || '01'
					AND TO_NUMBER(#{bYear1}) -  1 || '12'
					AND C.HIGH_CD = '00141'
					AND DECODE(A.ACCU_GBN, NULL, A.REPT_GBN, A.ACCU_GBN) = C.CODE_CD
			) ZA,
			(
				SELECT
					YRMN,
					MM
				FROM
					GIBU.COPY_YRMN
				WHERE
					YYYY = TO_NUMBER(#{bYear1}) -  1
			) ZB
		WHERE
			ZA.NOTE_YRMN(+) = ZB.YRMN
	) BB,
	(
		SELECT
			ZB.YRMN,
			ZB.MM,
			ZA.UPSO_CD,
			ZA.NOTE_YRMN,
			ZA.REPT_GBN,
			DECODE(
				ZA.ACCU_GBN,
				NULL,
				ZA.CODE_NM,
				'06',
				'채권',
				'22',
				DECODE(ACCU_SOLCNT, 1, '고소해결', '고소분납')
			) CODE_NM,
			ZA.USE_AMT,
			ZA.REPT_DAY,
			ZA.REPT_NUM,
			ZA.RECV_DAY,
			ZA.ACCU_GBN,
			ZA.DISTR_SEQ,
			CASE
				WHEN REPT_GBN BETWEEN '11' AND '19' THEN REPT_DAY
				ELSE MAPPING_DAY
			END MAPPING_DAY
		FROM
			(
				SELECT
					A.UPSO_CD,
					A.NOTE_YRMN,
					A.REPT_GBN,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1)
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NOT NULL
							AND A.NOTE_YRMN BETWEEN SOL_START_YRMN AND SOL_END_YRMN
					) ACCU_SOLCNT,
					D.ACCU_CNT,
					A.USE_AMT,
					A.REPT_DAY,
					A.REPT_NUM,
					A.RECV_DAY,
					A.ACCU_GBN,
					A.DISTR_SEQ,
					A.MAPPING_DAY,
					C.CODE_NM
				FROM
					GIBU.TBRA_NOTE A,
					FIDU.TENV_CODE C,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1) ACCU_CNT
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NULL
					) D
				WHERE
					A.UPSO_CD = #{upsoCd}
					AND A.NOTE_YRMN BETWEEN #{year} || '01'
					AND #{year} || '12'
					AND C.HIGH_CD = '00141'
					AND DECODE(A.ACCU_GBN, NULL, A.REPT_GBN, A.ACCU_GBN) = C.CODE_CD
			) ZA,
			(
				SELECT
					YRMN,
					MM
				FROM
					GIBU.COPY_YRMN
				WHERE
					YYYY = #{year}
			) ZB
		WHERE
			ZA.NOTE_YRMN(+) = ZB.YRMN
	) CC
WHERE
	BB.MM = AA.MM
	AND CC.MM = AA.MM
ORDER BY
	AA.MM
</select>

<select id="SQLrept_init_SEL3" parameterType="" resultType="">
SELECT
	BRAN_CD,
	UPSO_CD,
	DEMD_YRMN,
	CLSBS_YRMN,
	GIBU.FT_SPLIT(DEMDS, ',', 0) START_YRMN,
	GIBU.FT_SPLIT(DEMDS, ',', 1) END_YRMN,
	GIBU.FT_SPLIT(DEMDS, ',', 2) BSTYP_CD,
	GIBU.FT_SPLIT(DEMDS, ',', 3) UPSO_GRAD,
	GIBU.FT_SPLIT(DEMDS, ',', 4) MONPRNCFEE,
	GIBU.FT_SPLIT(DEMDS, ',', 6) DEMD_GBN,
	GIBU.FT_SPLIT(DEMDS, ',', 7) DEMD_MMCNT,
	GIBU.FT_SPLIT(DEMDS, ',', 8) TOT_USE_AMT,
	GIBU.FT_SPLIT(DEMDS, ',', 9) TOT_ADDT_AMT,
	GIBU.FT_SPLIT(DEMDS, ',', 10) TOT_EADDT_AMT,
	GIBU.FT_SPLIT(DEMDS, ',', 11) DSCT_AMT,
	GIBU.FT_SPLIT(DEMDS, ',', 12) TOT_DEMD_AMT,
	(
		SELECT
			CODE_NM
		FROM
			FIDU.TENV_CODE
		WHERE
			HIGH_CD = '00141'
			AND CODE_CD = GIBU.FT_SPLIT(DEMDS, ',', 6)
	) DEMD_GBN_NM,
	0 AS ADJ_AMT,
	'' AS ADJ_GBN
FROM
	(
		SELECT
			XA.BRAN_CD,
			XA.UPSO_CD,
			XA.CLSBS_YRMN,
			XB.END_YRMN DEMD_YRMN,
			GIBU.FT_GET_DEMD_AMT2(
				XA.UPSO_CD,
				XB.START_YRMN,
				XB.END_YRMN,
				XC.DEMD_YRMN,
				'O'
			) DEMDS
		FROM
			GIBU.TBRA_UPSO XA,
			(
				SELECT
					GIBU.FT_GET_START_REPT_YRMN(#{upsoCd}, 6) START_YRMN,
					TO_CHAR(SYSDATE, 'YYYYMM') END_YRMN
				FROM
					DUAL
			) XB,
			(
				SELECT
					MAX(DEMD_YRMN) DEMD_YRMN
				FROM
					GIBU.TBRA_DEMD_OCR
			) XC
		WHERE
			XA.UPSO_CD = #{upsoCd}
	)
</select>

<select id="SQLrept_init_SEL4" parameterType="" resultType="">
SELECT
	XB.UPSO_CD,
	XB.DEMD_YRMN || '01' DEMD_YRMN,
	XC.CODE_NM AS DEMD_GBN_NM,
	XB.MONPRNCFEE,
	XB.TOT_USE_AMT,
	XB.TOT_ADDT_AMT,
	XB.TOT_EADDT_AMT,
	XB.TOT_DEMD_AMT,
	XB.DEMD_GBN,
	XB.START_YRMN || '01' AS START_YRMN,
	XB.END_YRMN || '01' AS END_YRMN
FROM
	(
		SELECT
			NVL(MAX(NOTE_YRMN), '190001') DEMD_YRMN
		FROM
			GIBU.TBRA_NOTE
		WHERE
			UPSO_CD = #{upsoCd}
			AND REPT_GBN IN (
				SELECT
					CODE_CD
				FROM
					FIDU.TENV_CODE
				WHERE
					HIGH_CD = '00141'
					AND CODE_ETC = 'A'
			)
	) XA,
	GIBU.TBRA_DEMD_OCR XB,
	FIDU.TENV_CODE XC
WHERE
	XB.DEMD_YRMN > XA.DEMD_YRMN
	AND XB.UPSO_CD = #{upsoCd}
	AND XC.HIGH_CD = '00141'
	AND XC.CODE_CD = XB.DEMD_GBN
ORDER BY
	XB.DEMD_YRMN DESC
</select>

<select id="SQLrept_detail_SEL1" parameterType="" resultType="">
SELECT
	AA.UPSO_CD BB_UPSO_CD,
	AA.YRMN BB_REPT_YRMN,
	AA.MM BB_MM,
	AA.REPT_GBN BB_REPT_GBN,
	AA.CODE_NM BB_CODE_NM,
	AA.USE_AMT BB_USE_AMT,
	AA.REPT_DAY BB_REPT_DAY,
	AA.REPT_NUM BB_REPT_NUM,
	AA.RECV_DAY BB_RECV_DAY,
	AA.ACCU_GBN BB_ACCU_GBN,
	AA.DISTR_SEQ BB_DISTR_SEQ,
	AA.MAPPING_DAY BB_MAPPING_DAY,
	BB.UPSO_CD B_UPSO_CD,
	BB.YRMN B_REPT_YRMN,
	BB.MM B_MM,
	BB.REPT_GBN B_REPT_GBN,
	BB.CODE_NM B_CODE_NM,
	BB.USE_AMT B_USE_AMT,
	BB.REPT_DAY B_REPT_DAY,
	BB.REPT_NUM B_REPT_NUM,
	BB.RECV_DAY B_RECV_DAY,
	BB.ACCU_GBN B_ACCU_GBN,
	BB.DISTR_SEQ B_DISTR_SEQ,
	BB.MAPPING_DAY B_MAPPING_DAY,
	CC.UPSO_CD,
	CC.YRMN REPT_YRMN,
	CC.MM,
	CC.REPT_GBN,
	CC.CODE_NM,
	CC.USE_AMT,
	CC.REPT_DAY,
	CC.REPT_NUM,
	CC.RECV_DAY,
	CC.ACCU_GBN,
	CC.DISTR_SEQ,
	CC.MAPPING_DAY
FROM
	(
		SELECT
			ZB.YRMN,
			ZB.MM,
			ZA.UPSO_CD,
			ZA.NOTE_YRMN,
			ZA.REPT_GBN,
			DECODE(
				ZA.ACCU_GBN,
				NULL,
				ZA.CODE_NM,
				'06',
				'채권',
				'22',
				DECODE(ACCU_SOLCNT, 1, '고소해결', '고소분납')
			) CODE_NM,
			ZA.USE_AMT,
			ZA.REPT_DAY,
			ZA.REPT_NUM,
			ZA.RECV_DAY,
			ZA.ACCU_GBN,
			ZA.DISTR_SEQ,
			CASE
				WHEN REPT_GBN BETWEEN '11' AND '19' THEN REPT_DAY
				WHEN REPT_GBN = '04' THEN REPT_DAY
				ELSE MAPPING_DAY
			END MAPPING_DAY
		FROM
			(
				SELECT
					A.UPSO_CD,
					A.NOTE_YRMN,
					A.REPT_GBN,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1)
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NOT NULL
							AND A.NOTE_YRMN BETWEEN SOL_START_YRMN AND SOL_END_YRMN
							AND JUDG_CD NOT IN ('2', '3', '4', '8')
					) ACCU_SOLCNT,
					D.ACCU_CNT,
					A.USE_AMT,
					A.REPT_DAY,
					A.REPT_NUM,
					A.RECV_DAY,
					A.ACCU_GBN,
					A.DISTR_SEQ,
					A.MAPPING_DAY,
					C.CODE_NM
				FROM
					GIBU.TBRA_NOTE A,
					FIDU.TENV_CODE C,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1) ACCU_CNT
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NULL
					) D
				WHERE
					A.UPSO_CD = #{upsoCd}
					AND A.NOTE_YRMN BETWEEN TO_NUMBER(#{bbYear1}) -  2 || '01'
					AND TO_NUMBER(#{bbYear1}) -  2 || '12'
					AND C.HIGH_CD = '00141'
					AND DECODE(A.ACCU_GBN, NULL, A.REPT_GBN, A.ACCU_GBN) = C.CODE_CD
			) ZA,
			(
				SELECT
					YRMN,
					MM
				FROM
					GIBU.COPY_YRMN
				WHERE
					YYYY = TO_NUMBER(#{bbYear1}) -  2
			) ZB
		WHERE
			ZA.NOTE_YRMN(+) = ZB.YRMN
	) AA,
	(
		SELECT
			ZB.YRMN,
			ZB.MM,
			ZA.UPSO_CD,
			ZA.NOTE_YRMN,
			ZA.REPT_GBN,
			DECODE(
				ZA.ACCU_GBN,
				NULL,
				ZA.CODE_NM,
				'06',
				'채권',
				'22',
				DECODE(ACCU_SOLCNT, 1, '고소해결', '고소분납')
			) CODE_NM,
			ZA.USE_AMT,
			ZA.REPT_DAY,
			ZA.REPT_NUM,
			ZA.RECV_DAY,
			ZA.ACCU_GBN,
			ZA.DISTR_SEQ,
			CASE
				WHEN REPT_GBN BETWEEN '11' AND '19' THEN REPT_DAY
				WHEN REPT_GBN = '04' THEN REPT_DAY
				ELSE MAPPING_DAY
			END MAPPING_DAY
		FROM
			(
				SELECT
					A.UPSO_CD,
					A.NOTE_YRMN,
					A.REPT_GBN,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1)
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NOT NULL
							AND A.NOTE_YRMN BETWEEN SOL_START_YRMN AND SOL_END_YRMN
							AND JUDG_CD NOT IN ('2', '3', '4', '8')
					) ACCU_SOLCNT,
					D.ACCU_CNT,
					A.USE_AMT,
					A.REPT_DAY,
					A.REPT_NUM,
					A.RECV_DAY,
					A.ACCU_GBN,
					A.DISTR_SEQ,
					A.MAPPING_DAY,
					C.CODE_NM
				FROM
					GIBU.TBRA_NOTE A,
					FIDU.TENV_CODE C,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1) ACCU_CNT
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NULL
					) D
				WHERE
					A.UPSO_CD = #{upsoCd}
					AND A.NOTE_YRMN BETWEEN TO_NUMBER(#{bYear1}) -  1 || '01'
					AND TO_NUMBER(#{bYear1}) -  1 || '12'
					AND C.HIGH_CD = '00141'
					AND DECODE(A.ACCU_GBN, NULL, A.REPT_GBN, A.ACCU_GBN) = C.CODE_CD
			) ZA,
			(
				SELECT
					YRMN,
					MM
				FROM
					GIBU.COPY_YRMN
				WHERE
					YYYY = TO_NUMBER(#{bYear1}) -  1
			) ZB
		WHERE
			ZA.NOTE_YRMN(+) = ZB.YRMN
	) BB,
	(
		SELECT
			ZB.YRMN,
			ZB.MM,
			ZA.UPSO_CD,
			ZA.NOTE_YRMN,
			ZA.REPT_GBN,
			DECODE(
				ZA.ACCU_GBN,
				NULL,
				ZA.CODE_NM,
				'06',
				'채권',
				'22',
				DECODE(ACCU_SOLCNT, 1, '고소해결', '고소분납')
			) CODE_NM,
			ZA.USE_AMT,
			ZA.REPT_DAY,
			ZA.REPT_NUM,
			ZA.RECV_DAY,
			ZA.ACCU_GBN,
			ZA.DISTR_SEQ,
			CASE
				WHEN REPT_GBN BETWEEN '11' AND '19' THEN REPT_DAY
				WHEN REPT_GBN = '04' THEN REPT_DAY
				ELSE MAPPING_DAY
			END MAPPING_DAY
		FROM
			(
				SELECT
					A.UPSO_CD,
					A.NOTE_YRMN,
					A.REPT_GBN,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1)
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NOT NULL
							AND A.NOTE_YRMN BETWEEN SOL_START_YRMN AND SOL_END_YRMN
							AND JUDG_CD NOT IN ('2', '3', '4', '8')
					) ACCU_SOLCNT,
					D.ACCU_CNT,
					A.USE_AMT,
					A.REPT_DAY,
					A.REPT_NUM,
					A.RECV_DAY,
					A.ACCU_GBN,
					A.DISTR_SEQ,
					A.MAPPING_DAY,
					C.CODE_NM
				FROM
					GIBU.TBRA_NOTE A,
					FIDU.TENV_CODE C,
					(
						SELECT
							DECODE(COUNT(UPSO_CD), 0, 0, 1) ACCU_CNT
						FROM
							GIBU.TBRA_ACCU
						WHERE
							UPSO_CD = #{upsoCd}
							AND COMPN_DAY IS NULL
					) D
				WHERE
					A.UPSO_CD = #{upsoCd}
					AND A.NOTE_YRMN BETWEEN #{year} || '01'
					AND #{year} || '12'
					AND C.HIGH_CD = '00141'
					AND DECODE(A.ACCU_GBN, NULL, A.REPT_GBN, A.ACCU_GBN) = C.CODE_CD
			) ZA,
			(
				SELECT
					YRMN,
					MM
				FROM
					GIBU.COPY_YRMN
				WHERE
					YYYY = #{year}
			) ZB
		WHERE
			ZA.NOTE_YRMN(+) = ZB.YRMN
	) CC
WHERE
	BB.MM = AA.MM
	AND CC.MM = AA.MM
ORDER BY
	AA.MM
</select>

<select id="SQLrept_detail_SEL2" parameterType="" resultType="">
SELECT
	ACCU_DAY,
	ACCU_NUM,
	ACCU_BRAN,
	ACCU_GBN,
	SOL_START_YRMN,
	SOL_END_YRMN,
	SOL_ORG_AMT,
	SOL_ADDT_AMT,
	JUDG_CD
FROM
	(
		SELECT
			ACCU_DAY,
			ACCU_NUM,
			ACCU_BRAN,
			ACCU_GBN,
			SOL_START_YRMN,
			SOL_END_YRMN,
			SOL_ORG_AMT,
			SOL_ADDT_AMT,
			JUDG_CD,
			(
				SELECT
					COUNT(YRMN)
				FROM
					GIBU.COPY_YRMN
				WHERE
					YRMN NOT IN (
						SELECT
							NOTE_YRMN
						FROM
							GIBU.TBRA_NOTE
						WHERE
							UPSO_CD = #{upsoCd}
					)
					AND YRMN BETWEEN A.SOL_START_YRMN
					AND A.SOL_END_YRMN
			) DEMD_MMCNT
		FROM
			GIBU.TBRA_ACCU A
		WHERE
			UPSO_CD = #{upsoCd}
			AND COMPN_DAY IS NULL
		ORDER BY
			ACCU_DAY DESC,
			ACCU_NUM DESC
	)
WHERE
	ROWNUM = 1
</select>

</mapper>