<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="776" Id="bra03_s05" Left="8" OnLoadCompleted="form_OnLoadCompleted" PidAttrib="7" Title="자동이체&#32;신청업소&#32;UPLOAD" Top="8" Ver="1.0" Width="1048" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_UpsoInfo" UseClientLayout="1">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIOWN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ADDR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTO_CLIENTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRAD" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTYP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_GRAD" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ReptAuto" UseClientLayout="1">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBFR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_REQDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYER_PHONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="BEGNG_RELSDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_GBN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPRES_ID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ReptAuto_tail" UseClientLayout="1">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="R_NEW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="R_TERM_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="R_CHG_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="A_TERM_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="A_CHG_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="O_NEW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="OR_TERM_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="OA_TERM_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="O_CHG_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ReptAuto_head" UseClientLayout="1">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="OCR_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_ReptAuto_err" OnRowPosChanged="ds_ReptAuto_err_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="CHK_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTO_ACCNNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRAD" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBFR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_REQDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYER_PHONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BEGNG_RELSDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPRES_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_GBN_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ReptAuto_Result" UseClientLayout="1">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRAD" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBFR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_REQDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYER_PHONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BEGNG_RELSDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_GBN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPTNUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Proc_day" UseClientLayout="1">
				<Contents>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<record>
						<PROC_DAY></PROC_DAY>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SendAuto_Result" UseClientLayout="1">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRAD" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBFR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_REQDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYER_PHONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BEGNG_RELSDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_GBN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPTNUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_80_result" UseClientLayout="1">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRAD" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNGEMSTR_RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBFR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_REQDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYER_PHONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BEGNG_RELSDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_GBN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPTNUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_80_file" UseClientLayout="1">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBFR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_REQDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESINUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYER_PHONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="BEGNG_RELSDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPT_GBN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPRES_ID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SendAuto_Data">
				<Contents>
					<colinfo id="SEQ_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPTN_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGATR_PAYPRES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_EXTENTION" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_ROUT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_flag">
				<Contents>
					<colinfo id="PROC_STAT" size="256" summ="default" type="STRING"/>
					<record>
						<PROC_STAT></PROC_STAT>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="white" Bottom="125" Height="26" Id="Shape2" Left="87" LineColor="user3" Right="1037" TabOrder="24" Top="99" Type="Rectangle" Width="950"></Shape>
		<Shape BKColor="white" Bottom="98" Height="26" Id="Shape1" Left="87" LineColor="user3" Right="1037" TabOrder="23" Top="72" Type="Rectangle" Width="950"></Shape>
		<Image FillType="STRETCH" Height="41" Id="Image15" ImageID="C_search_bg" Left="26" TabOrder="6" TabStop="FALSE" Top="19" Width="1006"></Image>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static2" Left="18" Style="box_tx" TabOrder="3" Text="시작시간" Top="72" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static3" Left="18" Style="box_tx" TabOrder="4" Text="종료시간" Top="99" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static4" Left="290" Style="box_tx" TabOrder="5" Text="전체건수" Top="72" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static5" Left="290" Style="box_tx" TabOrder="6" Text="처리건수" Top="99" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static6" Left="562" Style="box_tx" TabOrder="7" Text="생성건수" Top="72" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static7" Left="562" Style="box_tx" TabOrder="8" Text="에러건수" Top="99" VAlign="Middle" Width="70"></Static>
		<FileDialog Bottom="48" Height="24" Id="fdg_Auto" Left="936" Right="960" TabOrder="32" Top="24" Width="24"></FileDialog>
		<File Bottom="48" Height="24" Id="fil_Auto" Left="960" Right="984" TabOrder="32" Top="24" Width="24"></File>
		<Tab Height="632" Id="tabResult" Left="16" TabIndex="2" TabOrder="3" TabStop="FALSE" Top="136" Width="1022">
			<Contents>
				<TabPage BorderColor="black" Height="603" Id="tabAutoResult" ImageID="C_tab" Left="2" TabOrder="34" Text="81생성결과" Top="27" Width="1018">
					<Grid BindDataset="ds_ReptAuto_Result" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="587" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="576" Id="grd_AutoResult" InputPanel="FALSE" Left="6" LineColor="silver" Right="1012" RowHeight="20" Style="grid" TabOrder="1" TabStop="true" Top="11" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1006">
						<contents>
							<format id="Default">
								<columns>
									<col width="60"/>
									<col width="80"/>
									<col width="80"/>
									<col width="108"/>
									<col width="120"/>
									<col width="80"/>
									<col width="110"/>
									<col width="110"/>
									<col width="110"/>
									<col width="80"/>
									<col width="108"/>
									<col width="112"/>
									<col width="107"/>
									<col width="97"/>
									<col width="85"/>
									<col width="111"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user18" col="0" color="user12" display="text" text="업소"/>
									<cell bkcolor="user18" col="1" color="user12" display="text" text="처리일자"/>
									<cell bkcolor="user18" col="2" color="user12" display="text" text="구분"/>
									<cell bkcolor="user18" col="3" color="user12" display="text" text="일련번호"/>
									<cell bkcolor="user18" col="4" color="user12" display="text" text="신청일자"/>
									<cell bkcolor="user18" col="5" color="user12" display="text" text="신청구분"/>
									<cell bkcolor="user18" col="6" color="user12" display="text" text="변경전납부자번호"/>
									<cell bkcolor="user18" col="7" color="user12" display="text" text="변경후납부자번호"/>
									<cell bkcolor="user18" col="8" color="user12" display="text" text="납부희망일"/>
									<cell bkcolor="user18" col="9" color="user12" display="text" text="요금종류"/>
									<cell bkcolor="user18" col="10" color="user12" display="text" text="납부은행코드"/>
									<cell bkcolor="user18" col="11" color="user12" display="text" text="출금계좌코드"/>
									<cell bkcolor="user18" col="12" color="user12" display="text" text="주민번호"/>
									<cell bkcolor="user18" col="13" color="user12" display="text" text="납부자전화번호"/>
									<cell bkcolor="user18" col="14" color="user12" display="text" text="접수점코드"/>
									<cell bkcolor="user18" col="15" color="user12" display="text" text="최초개시일"/>
									<cell bkcolor="user18" col="16" color="user12" display="text" text="오류구분"/>
								</head>
								<body>
									<cell align="center" bkcolor="user8" col="0" colid="UPSO_CD" display="text" text="1"/>
									<cell align="center" col="1" colid="PROC_DAY" display="date"/>
									<cell align="center" col="2" colid="GBN" display="text"/>
									<cell align="center" col="3" colid="SEQ_NUM" display="text" text="100"/>
									<cell align="center" col="4" colid="APPTN_DAY" display="date"/>
									<cell align="center" col="5" colid="APPTN_GBN" display="text"/>
									<cell align="center" col="6" colid="CHGBFR_PAYPRES_NUM" display="text"/>
									<cell align="center" col="7" colid="CHGATR_PAYPRES_NUM" display="text"/>
									<cell align="center" col="8" colid="PAY_REQDAY" display="text"/>
									<cell align="center" col="9" colid="PAY_KND" display="text"/>
									<cell align="center" col="10" colid="PAY_BANK_CD" display="text"/>
									<cell align="center" col="11" colid="PAY_ACCN_NUM" display="text"/>
									<cell align="center" col="12" colid="RESINUM" display="text"/>
									<cell align="center" col="13" colid="PAYER_PHONNUM" display="text"/>
									<cell align="center" col="14" colid="RECPT_BANK_CD" display="text"/>
									<cell align="center" col="15" colid="BEGNG_RELSDAY" display="text"/>
									<cell align="center" col="16" colid="ERR_GBN" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="603" Id="tabAutoErr" ImageID="C_tab" Left="2" TabOrder="34" Text="81오류내역" Top="27" Width="1018">
					<static Height="203" Id="static13" Left="550" TabOrder="29" Text="자동이체정보" Top="392" Type="groupbox" Width="446"></static>
					<Shape BKColor="white" Bottom="561" Height="26" Id="Shape12" Left="645" LineColor="user3" Right="996" TabOrder="49" Top="535" Type="Rectangle" Width="351"></Shape>
					<Edit BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="REMAK" Height="20" Id="edt_REMAK" Left="649" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="21" Top="538" Width="337"></Edit>
					<Shape BKColor="white" Bottom="438" Height="26" Id="Shape7" Left="645" LineColor="user3" Right="996" TabOrder="44" Top="412" Type="Rectangle" Width="351"></Shape>
					<Shape BKColor="white" Bottom="463" Height="26" Id="Shape8" Left="645" LineColor="user3" Right="996" TabOrder="45" Top="437" Type="Rectangle" Width="351"></Shape>
					<Shape BKColor="white" Bottom="487" Height="26" Id="Shape9" Left="645" LineColor="user3" Right="996" TabOrder="46" Top="461" Type="Rectangle" Width="351"></Shape>
					<Shape BKColor="white" Bottom="512" Height="26" Id="Shape10" Left="645" LineColor="user3" Right="996" TabOrder="47" Top="486" Type="Rectangle" Width="351"></Shape>
					<Shape BKColor="white" Bottom="536" Height="26" Id="Shape11" Left="645" LineColor="user3" Right="996" TabOrder="48" Top="510" Type="Rectangle" Width="351"></Shape>
					<static Height="201" Id="grb1" Left="8" TabOrder="2" Text="업소정보" Top="394" Type="groupbox" Width="536"></static>
					<Shape BKColor="white" Bottom="585" Height="26" Id="Shape6" Left="16" LineColor="user3" Right="544" TabOrder="43" Top="559" Type="Rectangle" Width="528"></Shape>
					<Shape BKColor="white" Bottom="561" Height="26" Id="Shape5" Left="16" LineColor="user3" Right="544" TabOrder="42" Top="535" Type="Rectangle" Width="528"></Shape>
					<Shape BKColor="white" Bottom="536" Height="26" Id="Shape4" Left="16" LineColor="user3" Right="544" TabOrder="41" Top="510" Type="Rectangle" Width="528"></Shape>
					<Shape BKColor="white" Bottom="511" Height="26" Id="Shape3" Left="16" LineColor="user3" Right="544" TabOrder="40" Top="485" Type="Rectangle" Width="528"></Shape>
					<Shape BKColor="white" Bottom="487" Height="26" Id="Shape2" Left="16" LineColor="user3" Right="544" TabOrder="39" Top="461" Type="Rectangle" Width="528"></Shape>
					<Shape BKColor="white" Bottom="463" Height="26" Id="Shape1" Left="16" LineColor="user3" Right="544" TabOrder="38" Top="437" Type="Rectangle" Width="528"></Shape>
					<Shape BKColor="white" Bottom="438" Height="26" Id="Shape0" Left="16" LineColor="user3" Right="544" TabOrder="37" Top="412" Type="Rectangle" Width="528"></Shape>
					<Grid AutoEnter="TRUE" BindDataset="ds_ReptAuto_err" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="user3" Bottom="383" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadHeight="23" Height="364" Id="grd_AutoErr" InputPanel="FALSE" Left="6" LineColor="default" Right="1006" RowHeight="20" SelColor="user0" Style="grid" TabOrder="1" TabStop="true" Top="19" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1000">
						<contents>
							<format id="Default">
								<columns>
									<col width="42"/>
									<col width="80"/>
									<col width="80"/>
									<col width="150"/>
									<col width="80"/>
									<col width="107"/>
									<col width="123"/>
									<col width="80"/>
									<col width="110"/>
									<col width="130"/>
									<col width="130"/>
									<col width="80"/>
									<col width="148"/>
									<col width="97"/>
								</columns>
								<head>
									<cell bkcolor="user18" col="0" color="user12" display="text" text="확인"/>
									<cell bkcolor="user18" col="1" color="user12" display="text" text="처리일자"/>
									<cell bkcolor="user18" col="2" color="user12" display="text" text="신청구분"/>
									<cell bkcolor="user18" col="3" color="user12" display="text" text="에러구분"/>
									<cell bkcolor="user18" col="4" color="user12" display="text" text="업소"/>
									<cell bkcolor="user18" col="5" color="user12" display="text" text="업소명"/>
									<cell bkcolor="user18" col="6" color="user12" display="text" text="변경후납부자번호"/>
									<cell bkcolor="user18" col="7" color="user12" display="text" text="납부은행코드"/>
									<cell bkcolor="user18" col="8" color="user12" display="text" text="주민번호"/>
									<cell bkcolor="user18" col="9" color="user12" display="text" text="납부자전화번호"/>
									<cell bkcolor="user18" col="10" color="user12" display="text" text="접수점코드"/>
									<cell bkcolor="user18" col="11" color="user12" display="text" text="신청결과"/>
									<cell bkcolor="user18" col="12" color="user12" display="text" text="납부자명"/>
									<cell bkcolor="user18" col="13" color="user12" display="text" text="경영주명"/>
								</head>
								<body>
									<cell align="center" bkcolor='expr:iif(length(PAY_BANK_CD)&#32;==&#32;0&#32;||&#32;length(PAY_ACCN_NUM)&#32;==&#32;0&#32;||&#32;length(PAYPRES_NM)&#32;==&#32;0&#32;||&#32;length(RESINUM)&#32;==&#32;0&#32;||&#32;length(APPTN_DAY)&#32;==&#32;0&#32;||&#32;length(UPSO_CD)&#32;==&#32;0&#32;||&#32;APPTN_GBN&#32;==&#32;&quot;03&quot;&#32;||&#32;(APPTN_GBN&#32;==&#32;&quot;01&quot;&#32;&amp;&amp;&#32;APPTN_RSLT&#32;==&#32;&quot;06&quot;)&#32;||&#32;(APPTN_GBN&#32;==&#32;&quot;01&quot;&#32;&amp;&amp;&#32;APPTN_RSLT&#32;==&#32;&quot;07&quot;),&quot;red&quot;,&quot;&quot;)' col="0" colid="CHK_YN" display="checkbox" edit='expr:iif(length(PAY_BANK_CD)&#32;==&#32;0&#32;||&#32;length(PAY_ACCN_NUM)&#32;==&#32;0&#32;||&#32;length(PAYPRES_NM)&#32;==&#32;0&#32;||&#32;length(RESINUM)&#32;==&#32;0&#32;||&#32;length(APPTN_DAY)&#32;==&#32;0&#32;||&#32;length(UPSO_CD)&#32;==&#32;0&#32;||&#32;APPTN_GBN&#32;==&#32;&quot;03&quot;&#32;||&#32;(APPTN_GBN&#32;==&#32;&quot;01&quot;&#32;&amp;&amp;&#32;APPTN_RSLT&#32;==&#32;&quot;06&quot;)&#32;||&#32;(APPTN_GBN&#32;==&#32;&quot;01&quot;&#32;&amp;&amp;&#32;APPTN_RSLT&#32;==&#32;&quot;07&quot;),&quot;none&quot;,&quot;checkbox&quot;)'/>
									<cell align="center" col="1" colid="PROC_DAY" display="date"/>
									<cell align="center" col="2" colid="APPTN_GBN" display="text"/>
									<cell align="left" col="3" colid="CODE_NM" display="text"/>
									<cell align="center" col="4" colid="UPSO_CD" display="text"/>
									<cell align="center" col="5" colid="UPSO_NM" display="text"/>
									<cell align="center" col="6" colid="CHGATR_PAYPRES_NUM" display="text"/>
									<cell align="center" col="7" colid="PAY_BANK_CD" display="text"/>
									<cell align="center" col="8" colid="RESINUM" display="text"/>
									<cell align="center" col="9" colid="PAYER_PHONNUM" display="text"/>
									<cell align="center" col="10" colid="RECPT_BANK_CD" display="text"/>
									<cell align="center" col="11" colid="APPTN_RSLT" display="text"/>
									<cell align="center" col="12" colid="PAYPRES_NM" display="text"/>
									<cell align="center" col="13" colid="MNGEMSTR_NM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static9" Left="16" Style="box_tx" TabOrder="5" Text="경영주명" Top="509" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="MNGEMSTR_NM" Height="20" Id="edt_MNGEMSTR_NM" Left="107" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="4" Top="513" Width="121"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static20" Left="16" Style="box_tx" TabOrder="7" Text="업&#32;&#32;&#32;&#32;&#32;종" Top="461" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="GRAD" Height="20" Id="edt_GRAD" Left="107" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="8" Top="464" Width="76"></Edit>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="GRADNM" Height="20" Id="edt_GRADNM" Left="185" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="6" Top="464" Width="152"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static21" Left="16" Style="box_tx" TabOrder="9" Text="월사용료" Top="486" VAlign="Middle" Width="88"></Static>
					<MaskEdit BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user3" Column="MONPRNCFEE" Height="20" Id="mae_MONPRNCFEE" Left="107" MaxLength="10" Readonly="TRUE" TabOrder="10" Top="488" Width="121"></MaskEdit>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static0" Left="16" Style="box_tx" TabOrder="2" Text="영업장주소" Top="559" VAlign="Middle" Width="88"></Static>
					<Edit BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="ADDR" Height="20" Id="Edit7" Left="107" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="3" Top="563" Width="418"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static1" Left="16" Style="box_tx" TabOrder="12" Text="업소" Top="437" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="UPSO_CD" Height="20" Id="edt_UPSO_CD" ImeMode="none" Left="107" MaxLength="5" Readonly="TRUE" Style="edit" TabOrder="13" Text="1234567A" Top="440" Width="76"></Edit>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="UPSO_NM" Height="20" Id="edt_UPSO_NM" ImeMode="none" Left="185" MaxLength="20" Readonly="TRUE" Style="edit" TabOrder="11" Top="440" Width="198"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static8" Left="16" Style="box_tx" TabOrder="15" Text="센터" Top="412" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="BRAN_CD" Height="20" Id="Edit8" ImeMode="none" Left="107" MaxLength="5" Readonly="TRUE" Style="edit" TabOrder="16" Top="415" Width="76"></Edit>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="DEPT_NM" Height="20" Id="Edit9" ImeMode="none" Left="185" MaxLength="20" Readonly="TRUE" Style="edit" TabOrder="14" Top="415" Width="198"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" BorderColor="user10" Color="black" Font="굴림,9,Bold" Height="26" Id="Static10" Left="16" TabOrder="18" Text="&#32;전화&#32;번호" Top="534" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="PAYER_PHONNUM" Height="20" Id="edt_MNGEMSTR_PHONNUM" Left="107" MaxLength="20" OnChar="Edit0_OnChar" OnKeyDown="Edit0_OnKeyDown" Readonly="TRUE" TabOrder="19" Top="538" Width="121"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" BorderColor="user10" Color="black" Font="굴림,9,Bold" Height="26" Id="Static11" Left="232" TabOrder="17" Text="주민등록번호" Top="510" VAlign="Middle" Width="114"></Static>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static27" Left="558" Style="box_tx" TabOrder="24" Text="은행코드" Top="412" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="PAY_BANK_CD" Height="20" Id="Edit31" Left="649" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="25" Top="415" Width="58"></Edit>
					<Edit BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="BANK_NM" Height="20" Id="Edit32" Left="709" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="26" Top="415" Width="276"></Edit>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static12" Left="558" Style="box_tx" TabOrder="20" Text="비&#32;&#32;&#32;&#32;&#32;고" Top="534" VAlign="Middle" Width="88"></Static>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static26" Left="558" Style="box_tx" TabOrder="23" Text="신청일자" Top="509" VAlign="Middle" Width="88"></Static>
					<Calendar BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user3" Column="APPTN_DAY" Dateformat="yyyy/MM/dd" DayStyle="edit" EditAlign="CENTER" Enable="FALSE" Height="20" Id="cal_RECV_DAY" Left="649" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="27" Top="513" Width="96"></Calendar>
					<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static16" Left="558" Style="box_tx" TabOrder="22" Text="계좌번호" Top="437" VAlign="Middle" Width="88"></Static>
					<Static Align="Center" BKColor="user18" Border="Flat" BorderColor="user10" Color="black" Font="굴림,9,Bold" Height="26" Id="Static17" Left="558" TabOrder="28" Text="주민등록번호" Top="486" VAlign="Middle" Width="88"></Static>
					<Button ButtonStyle="TRUE" Height="21" Id="btn_resinum" ImageID="C_btn_70" Left="449" LeftMargin="23" OnClick="tabResult_tabAutoErr_btn_resinum_OnClick" Style="edit" TabOrder="31" Text="변경" Top="513" TopMargin="1" Width="71"></Button>
					<Static Align="Center" BKColor="user18" Border="Flat" BorderColor="user10" Color="black" Font="굴림,9,Bold" Height="26" Id="Static2" Left="558" TabOrder="32" Text="납부자명" Top="461" VAlign="Middle" Width="88"></Static>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="SCROLLBAR" Column="PAYPRES_NM" Height="20" Id="edt_payer_nm" Left="649" Readonly="TRUE" TabOrder="33" Top="464" Width="152"></Edit>
					<Edit Align="CENTER" BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user3" Column="PAY_ACCN_NUM" Height="20" Id="edt_PAY_ACCN_NUM" Left="649" Readonly="TRUE" TabOrder="34" Top="440" Width="152"></Edit>
					<MaskEdit BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="RESINUM" DisplayComma="FALSE" Height="20" Id="mae_RESINUM" Left="649" LeftMargin="6" Mask="######-#######" Readonly="TRUE" TabOrder="35" Top="488" TrimType="Both" Type="STRING" Width="152"></MaskEdit>
					<MaskEdit BindDataset="ds_ReptAuto_err" Border="Flat" BorderColor="user10" Column="MNGEMSTR_RESINUM" Height="20" Id="mae_MNGEMSTR_RESINUM" Left="349" LeftMargin="6" Mask="######-#######" Readonly="TRUE" TabOrder="36" Top="513" TrimType="Both" Type="STRING" Width="100"></MaskEdit>
					<Button ButtonStyle="TRUE" Height="21" Id="btn_resinumcancle" ImageID="C_btn_90" Left="449" LeftMargin="23" OnClick="tabResult_tabAutoErr_btn_resinumcancle_OnClick" Style="edit" TabOrder="50" Text="&#32;변경취소" Top="513" TopMargin="1" Visible="FALSE" Width="94"></Button>
					<Static Height="16" Id="Static3" Left="717" TabOrder="51" Text="은&#32;자동이체&#32;신청정보를&#32;수동으로&#32;등록할수&#32;없습니다." Top="5" Width="296"></Static>
					<Edit BKColor="red" Border="Flat" BorderColor="red" Height="14" Id="Edit0" Left="699" TabOrder="52" Top="3" Width="15"></Edit>
				</TabPage>
				<TabPage BorderColor="black" Height="603" Id="tabAutoSend" ImageID="C_tab" Left="2" TabOrder="34" Text="82생성결과" Top="27" Width="1018">
					<Grid BindDataset="ds_SendAuto_Result" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="587" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="576" Id="grd_AutoSend" InputPanel="FALSE" Left="6" LineColor="silver" Right="1012" RowHeight="20" Style="grid" TabOrder="1" TabStop="true" Top="11" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1006">
						<contents>
							<format id="Default">
								<columns>
									<col width="60"/>
									<col width="80"/>
									<col width="80"/>
									<col width="65"/>
									<col width="120"/>
									<col width="80"/>
									<col width="110"/>
									<col width="110"/>
									<col width="110"/>
									<col width="80"/>
									<col width="108"/>
									<col width="112"/>
									<col width="107"/>
									<col width="97"/>
									<col width="85"/>
									<col width="111"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user18" col="0" color="user12" display="text" text="업소"/>
									<cell bkcolor="user18" col="1" color="user12" display="text" text="처리일자"/>
									<cell bkcolor="user18" col="2" color="user12" display="text" text="구분"/>
									<cell bkcolor="user18" col="3" color="user12" display="text" text="일련번호"/>
									<cell bkcolor="user18" col="4" color="user12" display="text" text="신청일자"/>
									<cell bkcolor="user18" col="5" color="user12" display="text" text="신청구분"/>
									<cell bkcolor="user18" col="6" color="user12" display="text" text="변경전납부자번호"/>
									<cell bkcolor="user18" col="7" color="user12" display="text" text="변경후납부자번호"/>
									<cell bkcolor="user18" col="8" color="user12" display="text" text="납부희망일"/>
									<cell bkcolor="user18" col="9" color="user12" display="text" text="요금종류"/>
									<cell bkcolor="user18" col="10" color="user12" display="text" text="납부은행코드"/>
									<cell bkcolor="user18" col="11" color="user12" display="text" text="출금계좌코드"/>
									<cell bkcolor="user18" col="12" color="user12" display="text" text="주민번호"/>
									<cell bkcolor="user18" col="13" color="user12" display="text" text="납부자전화번호"/>
									<cell bkcolor="user18" col="14" color="user12" display="text" text="접수점코드"/>
									<cell bkcolor="user18" col="15" color="user12" display="text" text="최초개시일"/>
									<cell bkcolor="user18" col="16" color="user12" display="text" text="오류구분"/>
								</head>
								<body>
									<cell align="center" bkcolor="user8" col="0" colid="UPSO_CD" display="text" text="1"/>
									<cell align="center" col="1" colid="PROC_DAY" display="date"/>
									<cell align="center" col="2" colid="GBN" display="text"/>
									<cell align="center" col="3" colid="SEQ_NUM" display="text" expr="currow+1" text="100"/>
									<cell align="center" col="4" colid="APPTN_DAY" display="date"/>
									<cell align="center" col="5" colid="APPTN_GBN" display="text"/>
									<cell align="center" col="6" colid="CHGBFR_PAYPRES_NUM" display="text"/>
									<cell align="center" col="7" colid="CHGATR_PAYPRES_NUM" display="text"/>
									<cell align="center" col="8" colid="PAY_REQDAY" display="text"/>
									<cell align="center" col="9" colid="PAY_KND" display="text"/>
									<cell align="center" col="10" colid="PAY_BANK_CD" display="text"/>
									<cell align="center" col="11" colid="PAY_ACCN_NUM" display="text"/>
									<cell align="center" col="12" colid="RESINUM" display="text"/>
									<cell align="center" col="13" colid="PAYER_PHONNUM" display="text"/>
									<cell align="center" col="14" colid="RECPT_BANK_CD" display="text"/>
									<cell align="center" col="15" colid="BEGNG_RELSDAY" display="text"/>
									<cell align="center" col="16" colid="ERR_GBN" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="603" Id="tab_File" ImageID="C_tab" Left="2" TabOrder="34" Text="파일&#32;보기" Top="27" Width="1018">
					<TextArea Border="Flat" BorderColor="ACTIVEBORDER" Font="굴림체,9" Height="536" Id="ta_DemdAutoFile" Left="6" TabOrder="1" Top="53" VScroll="TRUE" Width="992"></TextArea>
					<Button ButtonStyle="TRUE" Height="21" Id="btn_SaveFile" ImageID="C_btn_90" Left="526" LeftMargin="23" OnClick="tab_DemdAuto_tab_File_btn_SaveFile_OnClick" Style="edit" TabOrder="2" Text="&#32;파일저장" Top="5" TopMargin="1" Width="94"></Button>
					<Static Height="13" Id="Static0" Left="21" TabOrder="3" Text="파일명" Top="8" Width="41"></Static>
					<Static Border="Flat" BorderColor="ACTIVEBORDER" Height="19" Id="sta_FileName" Left="64" TabOrder="4" Top="4" Width="452"></Static>
					<Static Font="굴림체,9" Height="16" Id="Static1" Left="7" TabOrder="5" Text="1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" Top="37" Width="984"></Static>
					<Static BKColor="user4" Height="14" Id="Static2" Left="67" TabOrder="6" Text="1234567890" Top="36" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static3" Left="187" TabOrder="7" Text="1234567890" Top="37" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static4" Left="307" TabOrder="8" Text="1234567890" Top="37" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static5" Left="427" TabOrder="9" Text="1234567890" Top="37" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static6" Left="547" TabOrder="10" Text="1234567890" Top="37" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static7" Left="667" TabOrder="11" Text="1234567890" Top="37" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static8" Left="787" TabOrder="12" Text="1234567890" Top="37" Width="61"></Static>
					<Static BKColor="user4" Height="14" Id="Static9" Left="907" TabOrder="13" Text="1234567890" Top="37" Width="61"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="603" Id="tab80" ImageID="C_tab" Left="2" TabOrder="36" Text="80결과" Top="27" Width="1018">
					<Grid BindDataset="ds_80_Result" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="587" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="576" Id="grd_80" InputPanel="FALSE" Left="6" LineColor="silver" Right="1012" RowHeight="20" Style="grid" TabOrder="1" TabStop="true" Top="11" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1006">
						<contents>
							<format id="Default">
								<columns>
									<col width="60"/>
									<col width="68"/>
									<col width="42"/>
									<col width="73"/>
									<col width="71"/>
									<col width="68"/>
									<col width="113"/>
									<col width="110"/>
									<col width="232"/>
									<col width="91"/>
									<col width="112"/>
									<col width="107"/>
									<col width="97"/>
									<col width="85"/>
									<col width="79"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user18" col="0" color="user12" display="text" text="업소"/>
									<cell bkcolor="user18" col="1" color="user12" display="text" text="처리일자"/>
									<cell bkcolor="user18" col="2" color="user12" display="text" text="구분"/>
									<cell bkcolor="user18" col="3" color="user12" display="text" text="일련번호"/>
									<cell bkcolor="user18" col="4" color="user12" display="text" text="신청일자"/>
									<cell bkcolor="user18" col="5" color="user12" display="text" text="신청구분"/>
									<cell bkcolor="user18" col="6" color="user12" display="text" text="변경전납부자번호"/>
									<cell bkcolor="user18" col="7" color="user12" display="text" text="변경후납부자번호"/>
									<cell bkcolor="user18" col="8" color="user12" display="text" text="신청결과"/>
									<cell bkcolor="user18" col="9" color="user12" display="text" text="납부은행코드"/>
									<cell bkcolor="user18" col="10" color="user12" display="text" text="출금계좌코드"/>
									<cell bkcolor="user18" col="11" color="user12" display="text" text="주민번호"/>
									<cell bkcolor="user18" col="12" color="user12" display="text" text="납부자전화번호"/>
									<cell bkcolor="user18" col="13" color="user12" display="text" text="접수점코드"/>
									<cell bkcolor="user18" col="14" color="user12" display="text" text="최초개시일"/>
									<cell bkcolor="user18" col="15" color="user12" display="text" text="오류구분"/>
								</head>
								<body>
									<cell align="center" bkcolor="user8" col="0" colid="UPSO_CD" display="text" text="1"/>
									<cell align="center" col="1" colid="PROC_DAY" display="date"/>
									<cell align="center" col="2" colid="GBN" display="text"/>
									<cell align="center" col="3" colid="SEQ_NUM" display="text" text="100"/>
									<cell align="center" col="4" colid="APPTN_DAY" display="date"/>
									<cell align="center" col="5" colid="APPTN_GBN" display="text"/>
									<cell align="center" col="6" colid="CHGBFR_PAYPRES_NUM" display="text"/>
									<cell align="center" col="7" colid="CHGATR_PAYPRES_NUM" display="text"/>
									<cell align="left" col="8" colid="APPTN_RSLT" display="text"/>
									<cell align="center" col="9" colid="PAY_BANK_CD" display="text"/>
									<cell align="center" col="10" colid="PAY_ACCN_NUM" display="text"/>
									<cell align="center" col="11" colid="RESINUM" display="text"/>
									<cell align="center" col="12" colid="PAYER_PHONNUM" display="text"/>
									<cell align="center" col="13" colid="RECPT_BANK_CD" display="text"/>
									<cell align="center" col="14" colid="BEGNG_RELSDAY" display="text"/>
									<cell align="center" col="15" colid="ERR_GBN" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Image Height="41" Id="Image17" ImageID="C_search_left" Left="16" TabOrder="4" TabStop="FALSE" Top="19" Width="10"></Image>
		<Image Height="11" Id="Image1" ImageID="C_icon" Left="404" TabOrder="7" TabStop="FALSE" Top="34" Width="11"></Image>
		<Static Height="15" Id="Static15" Left="420" Style="tx_left_bold" TabOrder="13" Text="적용일" Top="33" VAlign="Middle" Width="56"></Static>
		<Button ButtonStyle="TRUE" Height="21" Id="btn_AutoProc" ImageID="C_btn_90" Left="600" LeftMargin="23" OnClick="btn_AutoProc_OnClick" Style="edit" TabOrder="8" TabStop="FALSE" Text="&#32;처리시작" Top="30" TopMargin="1" Width="94"></Button>
		<Image Height="41" Id="Image18" ImageID="C_search_right" Left="1030" TabOrder="5" TabStop="FALSE" Top="19" Width="10"></Image>
		<Edit BKColor="user13" Border="Flat" BorderColor="user10" Height="20" Id="edt_FileName" Left="101" MaxLength="10" Readonly="TRUE" Style="edit" TabOrder="1" ToolTipText="파일명" Top="30" Width="186"></Edit>
		<Button ButtonStyle="TRUE" Height="21" Id="btn_SearchFile" ImageID="C_btn_70" Left="304" LeftMargin="23" OnClick="btn_SearchFile_OnClick" Style="edit" TabOrder="9" TabStop="FALSE" Text="찾기" Top="30" TopMargin="1" Width="71"></Button>
		<MaskEdit Border="Flat" BorderColor="ACTIVEBORDER" Height="20" Id="mae_StartTime" Left="91" Mask="####-##-##&#32;##:##:##" NullValue="&#32;" Readonly="TRUE" TabOrder="10" TabStop="FALSE" Top="75" Type="STRING" Width="172"></MaskEdit>
		<MaskEdit Border="Flat" BorderColor="ACTIVEBORDER" Height="20" Id="mae_EndTime" Left="91" Mask="####-##-##&#32;##:##:##" NullValue="&#32;" Readonly="TRUE" TabOrder="11" TabStop="FALSE" Top="102" Type="STRING" Width="172"></MaskEdit>
		<MaskEdit Border="Flat" BorderColor="ACTIVEBORDER" Height="20" Id="mae_CntRead" Left="363" NullValue="&#32;" Readonly="TRUE" TabOrder="12" TabStop="FALSE" Top="102" Width="172"></MaskEdit>
		<MaskEdit Border="Flat" BorderColor="ACTIVEBORDER" Height="20" Id="mae_CntInst" Left="635" NullValue="&#32;" Readonly="TRUE" TabOrder="13" TabStop="FALSE" Top="75" Width="172"></MaskEdit>
		<MaskEdit Border="Flat" BorderColor="ACTIVEBORDER" Height="20" Id="mae_CntErr" Left="635" NullValue="&#32;" Readonly="TRUE" TabOrder="14" TabStop="FALSE" Top="102" Width="172"></MaskEdit>
		<MaskEdit Border="Flat" BorderColor="ACTIVEBORDER" Column="CNT_READ" Height="20" Id="mae_CntTotal" Left="363" NullValue="&#32;" Readonly="TRUE" TabOrder="15" TabStop="FALSE" Top="75" Width="172"></MaskEdit>
		<Image Height="11" Id="Image0" ImageID="C_icon" Left="36" TabOrder="16" TabStop="FALSE" Top="34" Width="11"></Image>
		<Static Height="16" Id="Static0" Left="52" Style="tx_left_bold" TabOrder="26" Text="파일명" Top="32" VAlign="Middle" Width="40"></Static>
		<Calendar BKColor="user13" Border="Flat" BorderColor="user10" Dateformat="yyyy/MM/dd" Height="20" Id="cal_PROC_DAY" Left="482" LeftMargin="6" MonthPickerFormat="yyyy년&#32;MM월" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="2" ToolTipText="납부년월" Top="30" Width="94"></Calendar>
		<ubiviewer Bottom="157" Height="24" Id="ubi0" Left="604" Right="670" Top="133" Visible="FALSE" Width="66">
			<_PersistData>&#13;&#10;/6x7LUyA/wAAAQDSBgAA93sCAPjy//7/Bf9UAFkAUABFAAEw/fELAvzyFQ8jBwEI+PC9Af7wAzEAMgkAAbxDAQsFAl4AblcEdLz6&#13;&#10;9AsFCzIANXgALBBJAHkJcw99BQETBO7xrwf4IgbFBEICB0QAZQB/ZgBhAHUAbGUDYPjypwH59aoI+PDwv/r1F1MAaNQAZWUBEAP5&#13;&#10;9X8DdK28ubTM5gjtZPvzDUldAEYAcrsAb10AdABP1gBU6tQAeGUAASISaABttNwAEAMU+vQCMAkHAWExQAGFEuAGIgkAAA==&#13;&#10;</_PersistData>
		</ubiviewer>
		<File Bottom="48" Height="24" Id="File1" Left="984" Right="1008" TabOrder="28" Top="24" Width="24"></File>
		<File Bottom="48" Height="24" Id="File2" Left="1008" Right="1032" TabOrder="28" Top="24" Width="24"></File>
		<File Bottom="48" Height="24" Id="File0" Left="912" Right="936" TabOrder="29" Top="24" Width="24"></File>
		<FileDialog Bottom="48" Height="24" Id="FileDialog0" Left="887" Right="911" TabOrder="29" Top="24" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[#include "script::common.js"  	// 공통 js
#include "script::global.js"  	// 공통 js
#include "script::commonGibu.js"  	// 센터 공통 js
#include "script::commDs.js"	// 데이터셋 컨트롤
#include "script::commGrid.js"	// 그리드 컨트롤

/**************************************************************************
신청구분코드와 접수처구분코드 관계
--------------------------------------------------------------------
           신규 01 -> 4:금융기관, 6:결제원
                02 -> 5:이용기관(협회)
            해지03 -> 4:금융기관, 6:결제원, 7:자동이체통합관리시스템
                08 -> 5:이용기관(협회)
       임의해지 04 -> 4:금융기관, 7:자동이체통합관리시스템
                09 -> 5:이용기관(협회)
납부자번호 변경 06 -> 5:이용기관(협회)
   계좌변경 신규11 -> 4:금융기관, 7:자동이체통합관리시스템
   계좌변경 해지13 -> 4:금융기관, 7:자동이체통합관리시스템
**************************************************************************/


var OCR_NO = "5078448";

function form_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	
	File0.MakeDir("C:\\KOMCA\\AUTO");
	File0.MakeDir("C:\\KOMCA\\TEMP");

	// 검색일자 설정
	this.cal_PROC_DAY.Value = today();
}

function fn_CallBack(srvId,ErrorCode,ErrorMsg)
{
	if(ErrorCode < 0) {
		//에러 공통 팝업
		gfn_SetErrorPop(ErrorCode,ErrorMsg);
		return;
	}
	
	if (srvId == "DemdAuto") {
		this.mae_EndTime.Text = getDate();
		ds_ReptAuto_err.SetColumn(0,"CHK_YN",0);
	}

}

/*
	공통버튼 컨트롤
*/
function fn_CommmonButtonClick(strCode){

    //신규
    if(strCode == "NEW"){
		fn_New();
    }
    //조회
    else if(strCode == "SEARCH"){
		this.ds_Proc_day.SetColumn(0,"PROC_DAY","20120620");
		gfn_syncCall("DemdAuto","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=auto_apptn_result","S=ds_Proc_day","ds_ReptAuto_Result=SEL1 ds_ReptAuto_Err=SEL2 ds_SendAuto_Result=SEL4","","fn_CallBack");
		fn_makeFileGW82_new();
    }
    //저장
    else if(strCode == "SAVE"){
		fn_Save();
    }
    //엑셀
    else if(strCode == "EXCEL"){
    }
    //삭제
    else if(strCode == "DELETE"){}
    //출력
    else if(strCode == "PRINT"){
		fn_Print();
    }
    //닫기
    else if(strCode == "CLOSE"){
        close();
    }
}

function fn_New() {}
function fn_Save() 
{
	// 입력 필수 항목 검사;
	//if (!gfn_CheckFormNull(this)) return;
	if(ds_ReptAuto_err.max("CHK_YN") == 0 || ds_ReptAuto_err.count == 0){
        gfn_Confirm("MB_OK", "저장할 정보가 없습니다", "경고", "0");
	    return;
	}
	if(!confirm("체크된 정보를 저장하시겠습니까?")){
	    return;	    
	}
	
	gfn_syncCall("DemdAuto","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=auto_err_handling","S=ds_ReptAuto_err:N","","","fn_CallBack",gv_TraceLog,GV_FORMID);
	gfn_SetStatusMsg("저장처리 했습니다.");
	
	btn_AutoProc_OnClick();
}

function fn_Print() {	if(ds_ReptAuto_err.rowcount > 0) {			//레포트 경로 설정			ubi0.setJrfFileDir(gv_ReportUrl+"fi/bra/");			// 레포트 파일명 정의			ubi0.setJrfFileName("bra03_s05_1_err.jrf");			// 레포트/마이플랫폼 데이타셋 정의			ubi0.SetDataset("sql_autoerr","ds_ReptAuto_err");			ubi0.Retrieve();			// 바로 출력할때			ubi0.directPrint();	} else {		gfn_Confirm("MB_OK", "출력 대상이 없습니다.", "경고", "0");		return;	}}

function fn_ProcAutoData()
{
	// 파일 일자, 적용년월 검사
	// file 명 : 파일구분(4) + 이용기관 분류코드 '90 ' (2) + 지로번호 (7) + mmdd (4) = 
	var fileDay = substr(today(), 0, 4) + right(this.File0.FileName, 4); 
	if (substr(fileDay, 0, 6) != substr(this.cal_PROC_DAY.Value, 0, 6)) 
	{
		if (confirm("적용년월 " + substr(this.cal_PROC_DAY.Text, 0, 7) + ' 이 정확합니까?') == false)
		{
			return;
		}
	}

	// file length check
	var fileSize = this.File0.GetLength();
	
	if ( fileSize < 0 || !this.File0.Open("r")) 
	{
        gfn_Confirm("MB_OK", "화일을 open 하지 못했습니다.!!", "경고", "0");
		return;
	}

	// DataSet 초기화
	this.ds_ReptAuto.ClearData();
	this.ds_ReptAuto_tail.ClearData();
    this.ds_ReptAuto_head.ClearData();
    
	var dsIdx = 0;
	var gbn = "";
	var nOffset = 160;
	var sCont = "";

	for (var i=0; i<fileSize/nOffset; i++)
	{
		sCont = this.File0.Read(nOffset);
		gbn = trim(Midb(sCont, 4,  2));

		if (trim(Midb(sCont, 0,  4) != "GW81")) {
			gfn_Confirm("MB_OK", "자동이체 신청업소파일이 아닙니다.", "경고", "0");
			return;
		}

		// header
		if (gbn == "11") {
			// no Action
			this.ds_ReptAuto_head.AddRow();
			this.ds_ReptAuto_head.SetColumn(0, "GBN"     , trim(Midb(sCont,  4,  2))); //구분
			this.ds_ReptAuto_head.SetColumn(0, "OCR_NO"  , trim(Midb(sCont, 16,  7))); //지로번호
			this.ds_ReptAuto_head.SetColumn(0, "ORG_NM"  , trim(Midb(sCont, 31, 34))); //이용기관명
			this.ds_ReptAuto_head.SetColumn(0, "PROC_DAY", trim(Midb(sCont, 65,  8))); //처리일자
		}
		// body
		else if (gbn == "22") {
			this.ds_ReptAuto.AddRow();
			this.ds_ReptAuto.SetColumn(dsIdx, "GBN"               , trim(Midb(sCont,   4,  2)));    // 구분
			this.ds_ReptAuto.SetColumn(dsIdx, "SEQ_NUM"           , trim(Midb(sCont,   6,  8)));    // 일련번호
			this.ds_ReptAuto.SetColumn(dsIdx, "APPTN_DAY"         , trim(Midb(sCont,  14,  8)));    // 신청일자
			this.ds_ReptAuto.SetColumn(dsIdx, "APPTN_GBN"         , trim(Midb(sCont,  22,  2)));    // 신청구분
			this.ds_ReptAuto.SetColumn(dsIdx, "CHGBFR_PAYPRES_NUM", trim(Midb(sCont,  24, 20)));    // 납주자번호(변경전)
			this.ds_ReptAuto.SetColumn(dsIdx, "CHGATR_PAYPRES_NUM", trim(Midb(sCont,  44, 20)));    // 납부자번호
			this.ds_ReptAuto.SetColumn(dsIdx, "PAY_REQDAY"        , trim(Midb(sCont,  64,  2)));    // 납부희망일
			this.ds_ReptAuto.SetColumn(dsIdx, "PAY_KND"           , trim(Midb(sCont,  66,  2)));    // 요금종류
			this.ds_ReptAuto.SetColumn(dsIdx, "PAY_BANK_CD"       , trim(Midb(sCont,  68,  7)));    // 납부자계좌개설점코드
			this.ds_ReptAuto.SetColumn(dsIdx, "PAY_ACCN_NUM"      , trim(Midb(sCont,  75, 15)));    // 출금계좌번호
			this.ds_ReptAuto.SetColumn(dsIdx, "RESINUM"           , trim(Midb(sCont,  90, 13)));    // 주민(사업자)등록번호
			this.ds_ReptAuto.SetColumn(dsIdx, "PAYER_PHONNUM"     , trim(Midb(sCont, 103, 11)));    // 납부자전화번호
			this.ds_ReptAuto.SetColumn(dsIdx, "RECPT_BANK_CD"     , trim(Midb(sCont, 114,  7)));    // 신청시접수점코드
			this.ds_ReptAuto.SetColumn(dsIdx, "APPTN_RSLT"        , trim(Midb(sCont, 121,  2)));    // 신청결과코드
			this.ds_ReptAuto.SetColumn(dsIdx, "BEGNG_RELSDAY"     , trim(Midb(sCont, 123,  8)));    // 최초개시일
			this.ds_ReptAuto.SetColumn(dsIdx, "RECPT_GBN_CD"      , trim(Midb(sCont, 131,  1)));    // 접수처구분코드
			this.ds_ReptAuto.SetColumn(dsIdx, "RECPTNUM"          , trim(Midb(sCont, 132,  9)));    // 결제원접수번호
			//this.ds_ReptAuto.SetColumn(dsIdx, "PAYPRES_NM"        , trim(Full2Half(substr(sCont, 141, 16))));  			// 예금주명
			this.ds_ReptAuto.SetColumn(dsIdx, "PAYPRES_NM"        , trim(substr(sCont, 141, 16)));  			// 예금주명
			this.ds_ReptAuto.SetColumn(dsIdx, "PROC_DAY"          , this.ds_ReptAuto_head.GetColumn(0, "PROC_DAY")); 	// 처리일자
			this.ds_ReptAuto.SetColumn(dsIdx, "INSPRES_ID"        , GV_USER_ID);                    // 로그인사용자
			dsIdx = dsIdx + 1;
		}
		// trailer
		else if (gbn == "33") {
			this.ds_ReptAuto_tail.AddRow();
			this.ds_ReptAuto_tail.SetColumn(0, "GBN"        , trim(Midb(sCont,  4,  2)));    // data gubun code
			this.ds_ReptAuto_tail.SetColumn(0, "DATA_CNT"   , trim(Midb(sCont, 23,  8)));    // 총 data record 수
			this.ds_ReptAuto_tail.SetColumn(0, "R_NEW_CNT"  , trim(Midb(sCont, 31,  8)));    // 신규(은행접수, 결제원접수)
			this.ds_ReptAuto_tail.SetColumn(0, "R_TERM_CNT" , trim(Midb(sCont, 39,  8)));    // 해지(은행접수, 결제원접수)
			this.ds_ReptAuto_tail.SetColumn(0, "R_CHG_CNT"  , trim(Midb(sCont, 47,  8)));    // 변경(은행접수, 결제원접수)
			this.ds_ReptAuto_tail.SetColumn(0, "A_TERM_CNT" , trim(Midb(sCont, 55,  8)));    // 해지(은행임의)
			this.ds_ReptAuto_tail.SetColumn(0, "A_CHG_CNT"  , trim(Midb(sCont, 63,  8)));    // 변경(은행임의)
			this.ds_ReptAuto_tail.SetColumn(0, "O_NEW_CNT"  , trim(Midb(sCont, 71,  8)));    // 신규(이용기관접숙)
			this.ds_ReptAuto_tail.SetColumn(0, "OR_TERM_CNT", trim(Midb(sCont, 79,  8)));    // 해지(이용기관접수)
			this.ds_ReptAuto_tail.SetColumn(0, "OA_TERM_CNT", trim(Midb(sCont, 87,  8)));    // 해지(이용기관임의)
			this.ds_ReptAuto_tail.SetColumn(0, "O_CHG_CNT"  , trim(Midb(sCont, 95,  8)));    // 변경(이용기관임의)
		}
	}

//	this.File0.Close();	//저장 후 다시 처리시작을 위해 파일 닫지 않음(160825 - 장태진)
	
	//trace(this.ds_ReptAuto.SaveXML());
	//trace(this.ds_Proc_Day.SaveXML());
	
	mae_CntTotal.Text = ds_ReptAuto.rowcount;   //전체  --> 파일 건수
	//trace(ds_ReptAuto.SaveXML());
//	trace(ds_Proc_Day.SaveXML());
	gfn_syncCall("DemdAuto","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=auto_apptn_upload3","S=ds_ReptAuto:U S1=ds_Proc_Day","","","fn_CallBack",gv_TraceLog,GV_FORMID);
	gfn_syncCall("DemdAuto","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=auto_apptn_result","S=ds_Proc_day","ds_ReptAuto_Result=SEL1 ds_ReptAuto_Err=SEL2 ds_SendAuto_Result=SEL4","","fn_CallBack");
	
	mae_CntRead.Text = ds_ReptAuto.rowcount - (ds_ReptAuto.rowcount  - ds_ReptAuto_Result.rowcount);  //  : 처리  --> 결과 - 오류
    mae_CntInst.Text = ds_ReptAuto_Result.rowcount - ds_ReptAuto_Err.rowcount;                        // : 생성  --> 결과 
    mae_CntErr.Text  = ds_ReptAuto_Err.rowcount;  //

	gfn_SetStatusMsg("UPLOAD가 완료되었습니다");
//	edt_FileName.text = "";	//저장 후 다시 처리시작을 위해 파일 닫지 않음(160825 - 장태진)
	fn_makeFileGW82_new();
}

function fn_makeFileGW82_new()
{
	var fileDay = this.ds_ReptAuto_head.GetColumn(0, "PROC_DAY");
	
	var cnt82_all = 0;	//전체건수
	var cnt82_01 = 0;	//신규(은행접수, 결제원접수)
	var cnt82_03 = 0;	//해지(은행접수, 결제원접수)
	                    //변경(은행접수, 결제원접수)
	var cnt82_04 = 0;	//해지(은행임의)
	                    //변경(은행임의)
	var cnt82_02 = 0;	//신규(이용기관접수)
	var cnt82_08 = 0;	//해지(이용기관접수)
	var cnt82_09 = 0;	//해지(이용기관임의)
	                    //변경(이용기관임의)
	var cnt82_11 = 0;
	var cnt82_13 = 0;


	//this.fil_Auto.FileName = this.fdg_Auto.FilePath + "\\" + "GW8290" + OCR_NO + substr(this.fil_Auto.FileName, indexOf(this.fil_Auto.FileName, "GW81") + 13, 4);
	this.fil_Auto.FileName = "C:\\KOMCA\\AUTO\\" + "GW8290" + OCR_NO + right(this.File0.FileName, 4);
	this.tabResult.tab_File.sta_FileName.Text = this.fil_Auto.FileName;

	if (!this.fil_Auto.Open("w")) 
	{
        gfn_Confirm("MB_OK", "화일을 open 하지 못했습니다.!!", "경고", "0");
		return;
	}

	var sFileCont = "";
	var sFileCont_body = "";
	
	var body = "";
	var bodyList = "";
	for(var i=0; i<this.ds_SendAuto_Result.rowcount; i++) {
		if (this.ds_SendAuto_Result.GetColumn(i, "APPTN_GBN") != "03") {	//신청구분코드가 03(금융기관, 결재원, 통합관리시스템 해제요청의 결과응답)인것은 2015년 10월부로 응답gw82파일에 포함시키지 않는다.
			body = "GW82"
				 + "22"
				 + gfn_LenStrMake( 8, i+1, "L", "0")				// 일련번호
				 + gfn_LenStrMake( 8, this.ds_SendAuto_Result.GetColumn(i, "APPTN_DAY"))			// 신청일자
				 + gfn_LenStrMake( 2, this.ds_SendAuto_Result.GetColumn(i, "APPTN_GBN"))    		// 신청구분코드
				 + gfn_LenStrMake(20, this.ds_SendAuto_Result.GetColumn(i, "CHGBFR_PAYPRES_NUM"))   // 납부자변호변경전
				 + gfn_LenStrMake(20, this.ds_SendAuto_Result.GetColumn(i, "CHGATR_PAYPRES_NUM"))   // 납부자번호변경후
				 + gfn_LenStrMake( 2, this.ds_SendAuto_Result.GetColumn(i, "PAY_REQDAY"))   		// 납부희망일
				 + gfn_LenStrMake( 2, this.ds_SendAuto_Result.GetColumn(i, "PAY_KND")) 				// 요금종류
				 + gfn_LenStrMake( 7, this.ds_SendAuto_Result.GetColumn(i, "PAY_BANK_CD"))   		// 납부자계좌개설점코드
				 + gfn_LenStrMake(15, this.ds_SendAuto_Result.GetColumn(i, "PAY_ACCN_NUM"))  		// 출금계좌번호
				 + gfn_LenStrMake(13, this.ds_SendAuto_Result.GetColumn(i, "RESINUM"))  			// 주민사업자등록번호
				 + gfn_LenStrMake(11, this.ds_SendAuto_Result.GetColumn(i, "PAYER_PHONNUM"))  		// 납부자전화번호
				 + gfn_LenStrMake(7 , this.ds_SendAuto_Result.GetColumn(i, "RECPT_BANK_CD"))  		// 신청시접수코드
				 + gfn_LenStrMake(2 , this.ds_SendAuto_Result.GetColumn(i, "APPTN_RSLT"))  			// 신청결과코드
				 + gfn_LenStrMake(8 , this.ds_SendAuto_Result.GetColumn(i, "BEGNG_RELSDAY"))  		// 최초개시일
				 + gfn_LenStrMake(1 , this.ds_SendAuto_Result.GetColumn(i, "RECPT_GBN_CD"))  		// 접수처구분코드
				 + gfn_LenStrMake(9 , this.ds_SendAuto_Result.GetColumn(i, "RECPTNUM"))  			// 결제원접수번호  **
				 + gfn_LenStrMake(16, substr(this.ds_SendAuto_Result.GetColumn(i, "PAYPRES_NM"), 0, 5))	  		// 예금주명
				 + gfn_LenStrMake(3 , "");  														// FILLER
			
			//82파일의 일련번호를 저장하기위해
			ds_SendAuto_Result.SetColumn(i, "SEQ_NUM", i+1);
			
			bodyList = bodyList + body;
			sFileCont_body = sFileCont_body + body + chr(13) + chr(10);
			
			eval("cnt82_" + this.ds_SendAuto_Result.GetColumn(i, "APPTN_GBN") + "++");
			cnt82_all++;
		}
	}
	
	//GE12 파일에 GW82파일의 일련번호를 담기 위해 생성된 82파일의 내용을 temp table에 임시 저장 후 GE12파일에서 불러와서 사용
	gfn_syncCall("DemdAuto","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=auto_apptn_save_temp","S=ds_SendAuto_Result","ds_SendAuto_Data=SEL1","","fn_CallBack");
	//alert("cnt82_01 : " + cnt82_01 + "\ncnt82_03 : " + cnt82_03 + "\ncnt82_04 : " + cnt82_04 + "\ncnt82_02 : " + cnt82_02 + "\ncnt82_08 : " + cnt82_08 + "\ncnt82_09 : " + cnt82_09);	
	
	var header = "GW82"														// 업무구분
			   + "11"														// 데이타 구분
			   + "00000000"													// 일련번호
			   + "90"														// 이용기관 분류코드
			   + OCR_NO														// 지로번호
			   + gfn_LenStrMake( 8, cnt82_all, "L", "0")					// 총 data record 수
			   + gfn_LenStrMake(34, ds_ReptAuto_head.GetColumn(0, "ORG_NM"))// 이용기관
			   + gfn_LenStrMake( 8, fileDay)								// 처리일자
			   + gfn_LenStrMake(87, "");									// FILLER

	this.fil_Auto.Write(header, length(header));
	sFileCont = header + chr(13) + chr(10);
	sFileCont = sFileCont + sFileCont_body;
	fil_Auto.Write (bodyList, length(bodyList)); 

	var trailer = "GW82"
				+ "33" 													// data 구분 코드
				+ "99999999"											// 일련번호 = 99999999
				+ "90"													// 이용기관 분류코드
				+ OCR_NO												// 지로번호
			    + gfn_LenStrMake(8, cnt82_all, "L", "0")  				// 총 data record 수                   
			    + gfn_LenStrMake(8, (cnt82_01+cnt82_11) , "L", "0")  	// 신규(은행접수, 결제원접수) 
			    + gfn_LenStrMake(8, (cnt82_03+cnt82_13) , "L", "0")  	// 해지(은행접수, 결제원접수) 
			    + gfn_LenStrMake(8, 0        , "L", "0")  				// 변경(은행접수, 결제원접수)-폐지
			    + gfn_LenStrMake(8, cnt82_04 , "L", "0")  				// 해지(은행임의) 
			    + gfn_LenStrMake(8, 0        , "L", "0")  				// 변경(은행임의) -폐지
			    + gfn_LenStrMake(8, cnt82_02 , "L", "0")  				// 신규(이용기관접수) 
			    + gfn_LenStrMake(8, cnt82_08 , "L", "0")  				// 해지(이용기관접수) 
			    + gfn_LenStrMake(8, cnt82_09 , "L", "0")  				// 해지(이용기관임의) 
			    + gfn_LenStrMake(8, 0        , "L", "0")  				// 변경(이용기관임의)
			    + gfn_LenStrMake(57 , "");                				// FILLER
	       		
	fil_Auto.Write (trailer, length(trailer)); 
	sFileCont = sFileCont + trailer;
	this.fil_Auto.Close();

	this.tabResult.tab_File.ta_DemdAutoFile.Text = sFileCont;
	
	fn_makeFileGE12();
}

function fn_makeFileGE12()
{
	/*if(!confirm("GW82파일 생성완료.\nGE12(자동이체 동의자료)파일을 생성하시겠습니까?")){
	    return;
	}*/
	
	if(ds_SendAuto_Data.rowcount < 1)
	{
		alert("협회 신규 신청분 중 동의자료 파일이 있는 데이터가 없습니다.");
		return;
	}
	
	var fileDay = this.ds_ReptAuto_head.GetColumn(0, "PROC_DAY");
	
	var ge12_cnt = 0;
	var ge12_block_cnt = 0;

	this.fil_Auto.FileName = "C:\\KOMCA\\AUTO\\" + "GE12" + OCR_NO + substr(fileDay, 4, 4);

	if (!this.fil_Auto.Open("wb")) 
	{
        gfn_Confirm("MB_OK", "화일을 open 하지 못했습니다.!!", "경고", "0");
		return;
	}
	
	var body = "";
	var bodyList = "";
	
	var tempI = 0;
	
	//헤더 쓰기
	var header = "AE1111"													// 업무구분
			   + "11"														// 데이타 구분
			   + "0000000"													// 일련번호
			   + gfn_LenStrMake(8, fileDay)									// 처리일자
			   + gfn_LenStrMake(20, OCR_NO)       							// 지로번호
			   + gfn_LenStrMake(7, ds_SendAuto_Data.rowcount, "L", "0")		// 총 Data Record 개수
			   + gfn_LenStrMake(974, "");									// FILLER
	
	this.fil_Auto.WriteBinary(header);
	
	//동의자료 Data Record 쓰기
	for(var i=0; i<this.ds_SendAuto_Data.rowcount; i++)
	{
		//파일을 binary로 쓰기 위해서는 로컬에서 rb로 file 객체를 사용해야만 쓸 수 있음.
		//따라서 was에 파일을 떨어뜨리고 gfn함수를 이용해서 해당 파일을 다시 불러와서 로컬 임시 폴더에 저장 후
		//해당 파일을 file 객체를 사용해서 로컬에서 rb로 불러온 뒤 가공해서 write
		///여기서부터 gfn
		GDS_DOWNLOAD.SetColumn(0, "PATH", ds_SendAuto_Data.GetColumn(i, "FILE_ROUT"));
		GDS_DOWNLOAD.SetColumn(0, "DOWNFILE", ds_SendAuto_Data.GetColumn(i, "FILE_NM"));
		gfn_CreateDataSet("ds_fileDownLoad","PATH,256,STRING DOWNFILE,256,STRING CONTENT,256,STRING");	// 임시 dataset 생성
		
		gfn_SyncCall("find","DOWNLOAD?SYSID=PATHFINDER&MENUID=1007016002001&EVENTID=search","S=GDS_DOWNLOAD","ds_fileDownLoad=S","","CallBack");
		
		var fileName = ds_fileDownLoad.getColumn(0,"DOWNFILE");
		var blobbuffer = ds_fileDownLoad.getColumn(0, "CONTENT");
		
		if(blobbuffer == "NULL") {
			alert("File Content = NULL");
			return result;
		}
		///여기까지 gfn
		
		//로컬 임시폴더로 파일 저장
		File1.FileName = "C:\\KOMCA\\TEMP\\" + ds_SendAuto_Data.GetColumn(i, "FILE_NM");
		File1.Open("w");
		File1.WriteBinary(blobbuffer);
		File1.Close();
		
		//로컬에서 파일 읽기
		File2.FileName = "C:\\KOMCA\\TEMP\\" + ds_SendAuto_Data.GetColumn(i, "FILE_NM");
		if (!File2.Open("rb"))
		{
			alert("fail to file open");
			return;
		}
		
		// 정보부 쓰기
		body = "AE1111"																			// 업무구분코드
			 + "22"																				// 데이터구분
			 + gfn_LenStrMake(7, i+1, "L", "0")													// 일련번호
			 + gfn_LenStrMake(10, this.ds_SendAuto_Data.GetColumn(i, "SEQ_NUM"))				// 신청파일의 일련번호
			 + gfn_LenStrMake(20, OCR_NO)    													// 지로번호
			 + gfn_LenStrMake(30, this.ds_SendAuto_Data.GetColumn(i, "CHGATR_PAYPRES_NUM"))		// 납부자번호
			 + gfn_LenStrMake(3, this.ds_SendAuto_Data.GetColumn(i, "BANK_CD"))   				// 금융회사코드
			 + gfn_LenStrMake(20, this.ds_SendAuto_Data.GetColumn(i, "PAY_ACCN_NUM"))   		// 계좌번호
			 + gfn_LenStrMake(8, this.ds_SendAuto_Data.GetColumn(i, "APPTN_DAY")) 				// 신청일
			 + "1"																		   		// 동의자료 구분
			 + gfn_LenStrMake(5, this.ds_SendAuto_Data.GetColumn(i, "FILE_EXTENTION"))  		// 동의자료 확장자
			 + gfn_LenStrMake(7, File1.GetLength(), "L", "0");									// 동의자료 길이
		
		this.fil_Auto.WriteBinary(body);
		
		//동의자료파일 쓰기
		//this.fil_Auto.WriteBinary(File2.ReadBinary(905));										// 동의자료 DATA
		this.fil_Auto.WriteBinary(File2.ReadBinary());
		
		// Data를 1024단위로 구분하기 위한 갯수 구하기
		var len = 0;
		if((parseInt(File1.GetLength()) + 119) % 1024 == 0)
		{
			len = floor((parseInt(File1.GetLength()) + 119) / 1024);
		}
		else
		{
			len = floor((parseInt(File1.GetLength()) + 119) / 1024) + 1;
		}
		
		// Data의 마지막 라인이 1024가 안되는 경우 빈칸으로 채우기
		var wLen = parseInt(len) * 1024 - parseInt(File1.GetLength()) - 119;
		this.fil_Auto.WriteBinary(gfn_LenStrMake(wLen , ""));
		
		
		ge12_cnt++;
		ge12_block_cnt += len;
	}
	
	// 트레일러 쓰기
	var trailer = "AE1111"													// 업무구분
				+ "33" 														// data 구분 코드
				+ "9999999"													// 일련번호 = 99999999
				+ gfn_LenStrMake(20, OCR_NO)								// 지로번호
			    + gfn_LenStrMake(7, ge12_cnt, "L", "0")  					// 총 data record 수
			    + gfn_LenStrMake(10, ge12_block_cnt, "L", "0")  			// 총 data block 수
			    + gfn_LenStrMake(972 , "");                					// FILLER
	
	this.fil_Auto.WriteBinary(trailer); 
	
	this.fil_Auto.Close();
}

function fn_makeFileGW82()
{
	var fileDay = this.ds_ReptAuto_head.GetColumn(0, "PROC_DAY");

	//this.fil_Auto.FileName = this.fdg_Auto.FilePath + "\\" + "GW8290" + OCR_NO + substr(this.fil_Auto.FileName, indexOf(this.fil_Auto.FileName, "GW81") + 13, 4);
	this.fil_Auto.FileName = "C:\\KOMCA\\AUTO\\" + "GW8290" + OCR_NO + right(this.fil_Auto.FileName, 4);
	this.tabResult.tab_File.sta_FileName.Text = this.fil_Auto.FileName;

	if (!this.fil_Auto.Open("w")) 
	{
        gfn_Confirm("MB_OK", "화일을 open 하지 못했습니다.!!", "경고", "0");
		return;
	}

	var sFileCont = "";
	var header = "GW82"														// 업무구분
			   + "11"														// 데이타 구분
			   + "00000000"													// 일련번호
			   + "90"														// 이용기관 분류코드
			   + OCR_NO														// 지로번호
			   + gfn_LenStrMake( 8, ds_ReptAuto_Result.rowcount, "L", "0")	// 총 data record 수
			   + gfn_LenStrMake(34, ds_ReptAuto_head.GetColumn(0, "ORG_NM"))// 이용기관
			   + gfn_LenStrMake( 8, fileDay)								// 처리일자
			   + gfn_LenStrMake(87, "");									// FILLER

	this.fil_Auto.Write(header, length(header));
	sFileCont = header + chr(13) + chr(10);
	//trace(this.ds_ReptAuto_Result.SaveXML());
	var body = "";
	var bodyList = "";
	for(var i=0; i<this.ds_ReptAuto_Result.rowcount; i++) {
		body = "GW82"
			 + "22"
			 + gfn_LenStrMake( 8, this.ds_ReptAuto_Result.GetColumn(i, "SEQ_NUM"))				// 일련번호
			 + gfn_LenStrMake( 8, this.ds_ReptAuto_Result.GetColumn(i, "APPTN_DAY"))			// 신청일자
			 + gfn_LenStrMake( 2, this.ds_ReptAuto_Result.GetColumn(i, "APPTN_GBN"))    		// 신청구분코드
			 + gfn_LenStrMake(20, this.ds_ReptAuto_Result.GetColumn(i, "CHGBFR_PAYPRES_NUM"))   // 납부자변호변경전
			 + gfn_LenStrMake(20, this.ds_ReptAuto_Result.GetColumn(i, "CHGATR_PAYPRES_NUM"))   // 납부자번호변경후
			 + gfn_LenStrMake( 2, this.ds_ReptAuto_Result.GetColumn(i, "PAY_REQDAY"))   		// 납부희망일
			 + gfn_LenStrMake( 2, this.ds_ReptAuto_Result.GetColumn(i, "PAY_KND")) 				// 요금종류
			 + gfn_LenStrMake( 7, this.ds_ReptAuto_Result.GetColumn(i, "PAY_BANK_CD"))   		// 납부자계좌개설점코드
			 + gfn_LenStrMake(15, this.ds_ReptAuto_Result.GetColumn(i, "PAY_ACCN_NUM"))  		// 출금계좌번호
			 + gfn_LenStrMake(13, this.ds_ReptAuto_Result.GetColumn(i, "RESINUM"))  			// 주민사업자등록번호
			 + gfn_LenStrMake(11, this.ds_ReptAuto_Result.GetColumn(i, "PAYER_PHONNUM"))  		// 납부자전화번호
			 + gfn_LenStrMake(7 , this.ds_ReptAuto_Result.GetColumn(i, "RECPT_BANK_CD"))  		// 신청시접수코드
			 + gfn_LenStrMake(2 , this.ds_ReptAuto_Result.GetColumn(i, "APPTN_RSLT"))  			// 신청결과코드
			 + gfn_LenStrMake(8 , this.ds_ReptAuto_Result.GetColumn(i, "BEGNG_RELSDAY"))  		// 최초개시일
			 + gfn_LenStrMake(1 , this.ds_ReptAuto_Result.GetColumn(i, "RECPT_GBN_CD"))  		// 접수처구분코드
			 + gfn_LenStrMake(9 , this.ds_ReptAuto_Result.GetColumn(i, "RECPTNUM"))  			// 결제원접수번호  **
			 + gfn_LenStrMake(16, this.ds_ReptAuto_Result.GetColumn(i, "PAYPRES_NM"))	  		// 예금주명
			 + gfn_LenStrMake(3 , "");  														// FILLER
			 
		bodyList = bodyList + body;
		sFileCont = sFileCont + body + chr(13) + chr(10);
	}
	fil_Auto.Write (bodyList, length(bodyList)); 

	var trailer = "GW82"
				+ "33" 												// data 구분 코드
				+ "99999999"										// 일련번호 = 99999999
				+ "90"												// 이용기관 분류코드
				+ OCR_NO											// 지로번호
			    + gfn_LenStrMake(8, this.ds_ReptAuto_Result.rowcount                 , "L", "0")  // 총 data record 수                   
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "R_NEW_CNT")  , "L", "0")  // 신규(은행접수, 결제원접수)          
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "R_TERM_CNT") , "L", "0")  // 해지(은행접수, 결제원접수)          
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "R_CHG_CNT")  , "L", "0")  // 변경(은행접수, 결제원접수)          
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "A_TERM_CNT") , "L", "0")  // 해지(은행임의)                      
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "A_CHG_CNT")  , "L", "0")  // 변경(은행임의)                      
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "O_NEW_CNT")  , "L", "0")  // 신규(이용기관접숙)                  
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "OR_TERM_CNT"), "L", "0")  // 해지(이용기관접수)                  
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "OA_TERM_CNT"), "L", "0")  // 해지(이용기관임의)                  
			    + gfn_LenStrMake(8, this.ds_ReptAuto_tail.GetColumn(0, "O_CHG_CNT")  , "L", "0")  // 변경(이용기관임의)                  
			    + gfn_LenStrMake(57 , "");                                                        // FILLER
	       		
	fil_Auto.Write (trailer, length(trailer)); 
	sFileCont = sFileCont + trailer;
	this.fil_Auto.Close();

	this.tabResult.tab_File.ta_DemdAutoFile.Text = sFileCont;
}

function btn_AutoProc_OnClick(obj)
{
	//처리 진행 중 대상이 추가되지 않도록 자동이체신청내역확인에서 저장 불가상태로 만들기 위한 FLAG 변경(1:진행중, 0:미진행)
	ds_flag.SetColumn(0, "PROC_STAT", "1");
	gfn_syncCall("chgFlag", "KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=change_flag", "S=ds_flag", "", "", "fn_CallBack");
	
	/*
	if(!gfn_checkformNull(this)) 
	{ 
        gfn_Confirm("MB_OK", "이체정보를 UPLOAD할 파일을 선택하십시오", "경고", "0");
		return;
	}
	*/
	ds_ReptAuto_err.ClearData();
    mae_StartTime.Value = "";
	mae_EndTime.Value = "";
	mae_CntTotal.Value = "";
	mae_CntRead.Value = "";
	mae_CntInst.Value = "";
	mae_CntErr.Value = "";
	
	
	if (!gfn_CheckFormNull(this)) return;
	mae_StartTime.value = getdate();
	file_type = left(this.FileDialog0.FileName, 4);
	
	var sMsg = this.cal_PROC_DAY.Text + " 일자의 " + file_type+ "에 대한 UPLOAD 진행하시겠습니까? ";
	if (confirm (sMsg) == true)
	{
		this.ds_Proc_day.SetColumn(0,"PROC_DAY",this.cal_PROC_DAY.Value);
		if (file_type == "GW81") {
			this.tabResult.TabIndex = 1;
			fn_ProcAutoData();
		} else if (file_type == "GW80") {
			this.tabResult.TabIndex = 4;
			fn_GW80_exec();
		}
	}
	else
	{
		//return;
	}
	
	//처리완료, 자동이체신청내역확인에서 저장 가능상태로 만들기 위한 FLAG 변경(1:진행중, 0:미진행)
	ds_flag.SetColumn(0, "PROC_STAT", "0");
	gfn_syncCall("chgFlag", "KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=change_flag", "S=ds_flag", "", "", "fn_CallBack");
}

function btn_SearchFile_OnClick(obj)
{
    this.FileDialog0.filter = "자동이체신청명세(GW81파일)|GW81*|자동이체신청결과오류(GW80파일)|GW80*|";	
	this.FileDialog0.Open();
	
	this.File0.FileName = this.FileDialog0.FilePath + "\\" + this.FileDialog0.FileName;
	this.edt_FileName.Text = this.File0.FileName;
	
	var fileDay = right(this.File0.FileName, 4);

	this.cal_PROC_DAY.Text = substr(today(), 0, 4) + fileDay;
}


function ds_ReptAuto_err_OnRowPosChanged(obj,nOldRow,nRow)
{
	var l_apptn_gbn = trim(ds_ReptAuto_err.GetColumn(nRow,"APPTN_GBN"));
	
	if ( l_apptn_gbn == "01" || l_apptn_gbn == "03" || l_apptn_gbn == "04" ) {	// 은행접수분
		
		if((trim(Full2Half(this.tabResult.tabAutoErr.edt_payer_nm.Text)) == trim(this.tabResult.tabAutoErr.edt_MNGEMSTR_NM.text))
		 && (trim(ds_ReptAuto_err.GetOrgColumn(nRow,"MNGEMSTR_RESINUM")) != trim(this.tabResult.tabAutoErr.mae_RESINUM.value))
		)
		{
			if(trim(ds_ReptAuto_err.GetColumn(nRow,"MNGEMSTR_RESINUM")) == trim(this.tabResult.tabAutoErr.mae_RESINUM.value)){
				this.tabResult.tabAutoErr.btn_resinum.Visible   = false;
				this.tabResult.tabAutoErr.btn_resinumcancle.Visible = true;
			}else{
				this.tabResult.tabAutoErr.btn_resinum.Visible   = true;
				this.tabResult.tabAutoErr.btn_resinumcancle.Visible = false;
			}		
		}else{
			this.tabResult.tabAutoErr.btn_resinum.Visible   = false;
			this.tabResult.tabAutoErr.btn_resinumcancle.Visible = false;
		}
		
		this.tabResult.tabAutoErr.Edit31.Readonly = true;
		this.tabResult.tabAutoErr.edt_PAY_ACCN_NUM.Readonly = true;
		this.tabResult.tabAutoErr.edt_payer_nm.Readonly = true;
		this.tabResult.tabAutoErr.mae_RESINUM.Readonly = true;		
		
	} else if ( l_apptn_gbn == "02" || l_apptn_gbn == "08" || l_apptn_gbn == "09" ) {	//협회접수분
		this.tabResult.tabAutoErr.btn_resinum.Visible   = false;
		this.tabResult.tabAutoErr.btn_resinumcancle.Visible = false;
		
		this.tabResult.tabAutoErr.Edit31.Readonly = false;
		this.tabResult.tabAutoErr.edt_PAY_ACCN_NUM.Readonly = false;
		this.tabResult.tabAutoErr.edt_payer_nm.Readonly = false;
		this.tabResult.tabAutoErr.mae_RESINUM.Readonly = false;		
	}
}

function tabResult_tabAutoErr_btn_resinum_OnClick(obj)
{
	this.ds_ReptAuto_err.SetColumn(this.ds_ReptAuto_err.currow,"MNGEMSTR_RESINUM", this.tabResult.tabAutoErr.mae_RESINUM.Value );
	this.ds_ReptAuto_err.SetColumn(this.ds_ReptAuto_err.currow,"GUBUN", "U" );
	tabResult.tabAutoErr.btn_resinum.Visible = false;
	tabResult.tabAutoErr.btn_resinumcancle.Visible = true;
}

function tabResult_tabAutoErr_btn_resinumcancle_OnClick(obj)
{
    this.ds_ReptAuto_err.SetColumn(this.ds_ReptAuto_err.currow,"MNGEMSTR_RESINUM",ds_ReptAuto_err.GetOrgColumn(ds_ReptAuto_err.currow,"MNGEMSTR_RESINUM"));
    this.ds_ReptAuto_err.SetColumn(this.ds_ReptAuto_err.currow,"GUBUN", "" );
	tabResult.tabAutoErr.btn_resinum.Visible = true;
	tabResult.tabAutoErr.btn_resinumcancle.Visible = false;
}


function Edit0_OnChar(obj,strPreText,nChar,strPostText,LLParam,HLParam)
{
	var strtext = right(strPostText,1);
	var chkstr = "[<!#$%*&_:=|`~'"+Quote("")+";@^+\\>]"; 
	
	if(pos(chkstr, strtext) >= 0)   // 특수문자 사용 제한
	{
        //gfn_Confirm("MB_OK", "이름 " + strtext +"(은)는 사용할수 없습니다.", "경고", "0");
		return false;
	}
	
	if((asc(right(strPostText,1)) >= 65) && (asc(right(strPostText,1)) <= 122))
	{
        gfn_Confirm("MB_OK", "영문은 입력할 수 없습니다.", "경고", "0");
	    return false;
	}
}


function Edit0_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(bCtrl == 1)
	{
        gfn_Confirm("MB_OK", "Ctrl 키는 사용할 수 없습니다.", "경고", "0");
	}
}


function tab_DemdAuto_tab_File_btn_SaveFile_OnClick(obj)
{
	var sFileCont = Replace(this.tabResult.tab_File.ta_DemdAutoFile.Text, chr(13) + chr(10), "");
	this.fil_Auto.FileName = this.tabResult.tab_File.sta_FileName.Text;
	
	if (!this.fil_Auto.Open("w")) 
	{
        gfn_Confirm("MB_OK", "화일을 open 하지 못했습니다.!!", "경고", "0");
		return;
	}

	this.fil_Auto.Write(sFileCont, length(sFileCont));
	this.fil_Auto.Close();	
}

function fn_GW80_exec()
{
	// 파일 일자, 적용년월 검사
	// file 명 : 파일구분(4) + 이용기관 분류코드 '90 ' (2) + 지로번호 (7) + mmdd (4) = 
	var fileDay = substr(today(), 0, 4) + right(this.File0.FileName, 4); 
	if (substr(fileDay, 0, 6) != substr(this.cal_PROC_DAY.Value, 0, 6)) 
	{
		if (confirm("적용년월 " + substr(this.cal_PROC_DAY.Text, 0, 7) + ' 이 정확합니까?') == false)
		{
			return;
		}
	}

	// file length check
	var fileSize = this.fil_Auto.GetLength();
	
	if ( fileSize < 0 || !this.File0.Open("r")) 
	{
        gfn_Confirm("MB_OK", "화일을 open 하지 못했습니다.!!", "경고", "0");
		return;
	}

	// DataSet 초기화
	this.ds_80_file.ClearData();
    
	var dsIdx = 0;
	var gbn = "";
	var nOffset = 160;
	var sCont = "";
	var proc_day_80;

	for (var i=0; i<fileSize/nOffset; i++)
	{
		sCont = this.File0.Read(nOffset);
		gbn = trim(Midb(sCont, 4,  2));

		if (trim(Midb(sCont, 0,  4) != "GW80")) {
			gfn_Confirm("MB_OK", "자동이체 신청업소파일이 아닙니다.", "경고", "0");
			return;
		}

		// header
		if (gbn == "11") {
			proc_day_80 = trim(Midb(sCont, 65,  8)); //처리일자
		}
		// body
		else if (gbn == "22") {
			this.ds_80_file.AddRow();
			this.ds_80_file.SetColumn(dsIdx, "GBN"               , trim(Midb(sCont,   4,  2)));    // 구분
			this.ds_80_file.SetColumn(dsIdx, "SEQ_NUM"           , "9"+trim(Midb(sCont,   7,  7)));    // 일련번호 81과 중복이 나기 때문에 첫자리를 9로 지정
			this.ds_80_file.SetColumn(dsIdx, "APPTN_DAY"         , trim(Midb(sCont,  14,  8)));    // 신청일자
			this.ds_80_file.SetColumn(dsIdx, "APPTN_GBN"         , trim(Midb(sCont,  22,  2)));    // 신청구분
			this.ds_80_file.SetColumn(dsIdx, "CHGBFR_PAYPRES_NUM", trim(Midb(sCont,  24, 20)));    // 납주자번호(변경전)
			this.ds_80_file.SetColumn(dsIdx, "CHGATR_PAYPRES_NUM", trim(Midb(sCont,  44, 20)));    // 납부자번호
			this.ds_80_file.SetColumn(dsIdx, "PAY_REQDAY"        , trim(Midb(sCont,  64,  2)));    // 납부희망일
			this.ds_80_file.SetColumn(dsIdx, "PAY_KND"           , trim(Midb(sCont,  66,  2)));    // 요금종류
			this.ds_80_file.SetColumn(dsIdx, "PAY_BANK_CD"       , trim(Midb(sCont,  68,  7)));    // 납부자계좌개설점코드
			this.ds_80_file.SetColumn(dsIdx, "PAY_ACCN_NUM"      , trim(Midb(sCont,  75, 15)));    // 출금계좌번호
			this.ds_80_file.SetColumn(dsIdx, "RESINUM"           , trim(Midb(sCont,  90, 13)));    // 주민(사업자)등록번호
			this.ds_80_file.SetColumn(dsIdx, "PAYER_PHONNUM"     , trim(Midb(sCont, 103, 11)));    // 납부자전화번호
			this.ds_80_file.SetColumn(dsIdx, "RECPT_BANK_CD"     , trim(Midb(sCont, 114,  7)));    // 신청시접수점코드
			this.ds_80_file.SetColumn(dsIdx, "APPTN_RSLT"        , trim(Midb(sCont, 121,  2)));    // 신청결과코드
			this.ds_80_file.SetColumn(dsIdx, "BEGNG_RELSDAY"     , trim(Midb(sCont, 123,  8)));    // 최초개시일
			this.ds_80_file.SetColumn(dsIdx, "RECPT_GBN_CD"      , trim(Midb(sCont, 131,  1)));    // 접수처구분코드
			this.ds_80_file.SetColumn(dsIdx, "RECPTNUM"          , trim(Midb(sCont, 132,  9)));    // 결제원접수번호
			this.ds_80_file.SetColumn(dsIdx, "PAYPRES_NM"        , trim(substr(sCont, 141, 16)));  			// 예금주명
			this.ds_80_file.SetColumn(dsIdx, "PROC_DAY"          , proc_day_80); 	// 처리일자
			this.ds_80_file.SetColumn(dsIdx, "INSPRES_ID"        , GV_USER_ID);                    // 로그인사용자
			dsIdx = dsIdx + 1;
		}
		// trailer
		else if (gbn == "33") {

		}
	}
//	this.File0.Close();	//저장 후 자동 처리시작을 위해 파일 닫지 않음(160825 - 장태진)
	
	//trace(this.ds_80_file.SaveXML());
	gfn_syncCall("DemdAuto","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005001&EVENTID=auto_apptn_upload80","S=ds_80_file:U S1=ds_Proc_Day","ds_80_result=SEL24","","fn_CallBack",gv_TraceLog,GV_FORMID);
	trace(this.ds_80_result.SaveXML());
	gfn_SetStatusMsg("GW80의 UPLOAD가 완료되었습니다");
}
]]></Script>
</Window>