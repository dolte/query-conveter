<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="800" Id="bra03_s10" Left="8" OnLoadCompleted="bra03_s10_OnLoadCompleted" OnSize="bra03_s10_OnSize" PidAttrib="7" Title="개별지로,&#32;MICR출력관리" Top="8" Ver="1.0" Width="1048" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="gbn">
				<Contents>
					<colinfo id="code" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<code>O</code>
						<value>개별지로</value>
					</record>
					<record>
						<code>M</code>
						<value>MICR</value>
					</record>
					<record>
						<code>N</code>
						<value>업종별</value>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_In">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRET_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTYP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STAFF_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_grd_search" UseClientLayout="1">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ZIP" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="NONPY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEMD_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CCHECK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ubi" UseClientLayout="1">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ZIP" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="NONPY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_ADDT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEMD_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="POST_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CCHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINTED" size="256" summ="default" type="STRING"/>
					<colinfo id="MAIL_RCPT" size="256" summ="default" type="STRING"/>
					<colinfo id="CLIENT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="STAFF_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ubi_p">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_ZIP" size="256" summ="default" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="NONPY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEMD_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="POST_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_PHON" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="GRADNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_ADDT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRET_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD1" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_OWNER1" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_OWNER2" size="256" summ="default" type="STRING"/>
					<colinfo id="CLIENT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM3" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_search_accn">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_TYPE" size="256" summ="default" type="STRING"/>
					<record>
						<BRAN_CD></BRAN_CD>
						<USE_TYPE></USE_TYPE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_banklist" UseClientLayout="1">
				<Contents>
					<colinfo id="ACCN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Virtual_temp">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPTPRES" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Virtual_In">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<record>
						<UPSO_CD></UPSO_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SawonInfo">
				<Contents>
					<colinfo id="STAFF_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STAFF_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCOM_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BRAN_CD">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<record>
						<BRAN_CD></BRAN_CD>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image FillType="STRETCH" Height="41" Id="Image15" ImageID="C_search_bg" Left="17" TabOrder="17" TabStop="FALSE" Top="7" Width="1015"></Image>
		<Grid AutoFit="TRUE" AutoScrollBar="AlwaysVert" BindDataset="ds_ubi" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="776" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="696" Id="grd_List" InputPanel="FALSE" Left="8" LineColor="silver" MinWidth="100" OnHeadClick="grd_UPSO_REPT_OnHeadClick" OnHeadDBLClick="grd_List_OnHeadDblClick" Right="1039" RowHeight="20" Style="grid" TabOrder="2" TabStop="true" Top="80" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1031">
			<contents>
				<format id="Default">
					<columns>
						<col width="64"/>
						<col width="135"/>
						<col width="70"/>
						<col width="285"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="40"/>
						<col width="60"/>
						<col width="37"/>
					</columns>
					<head>
						<cell col="0" color="user12" display="text" text="업소코드"/>
						<cell col="1" color="user12" display="text" text="업소명"/>
						<cell col="2" color="user12" display="text" text="입금자"/>
						<cell col="3" color="user12" display="text" text="주소"/>
						<cell col="4" color="user12" display="text" text="당월금"/>
						<cell col="5" color="user12" display="text" text="전월미납"/>
						<cell col="6" color="user12" display="text" text="연체료"/>
						<cell col="7" color="user12" display="text" text="총금액"/>
						<cell col="8" color="user12" display="text" text="담당자"/>
						<cell col="9" color="user12" display="text" text="출력"/>
						<cell col="10" color="user12" display="text" text="출력유무"/>
						<cell col="11" color="user12" display="text" text="구분"/>
					</head>
					<body>
						<cell align="center" col="0" colid="UPSO_CD" display="text"/>
						<cell col="1" colid="UPSO_NM" display="text"/>
						<cell align="center" col="2" colid="payPRES_NM" display="text"/>
						<cell align="left" col="3" colid="UPSO_ADDR" display="text"/>
						<cell align="right" col="4" colid="MONPRNCFEE" display="number"/>
						<cell align="right" col="5" colid="NONPY_AMT" display="number"/>
						<cell align="right" col="6" colid="TOT_ADDT_AMT" display="number"/>
						<cell align="right" col="7" colid="TOT_DEMD_AMT" display="number"/>
						<cell align="center" col="8" colid="STAFF_NM" display="text"/>
						<cell col="9" colid="CCHECK" display="checkbox" edit="checkbox"/>
						<cell col="10" colid="PRINTED" display="checkbox"/>
						<cell align="center" col="11" colid="AUTO_YN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<ubiviewer Bottom="744" Height="520" Id="ubiviewer0" Left="8" Right="1035" Top="224" Visible="FALSE" Width="1027">
			<_PersistData>&#13;&#10;/6zK2tii/wAAAQAlagAA9741APjy//7/Bf9UAFkAUABFAAEw/fELAvzyFQ8jBwEI+PC9Af7wAzEAMgkAAbxDAQsFAl4AblcEdLz6&#13;&#10;9AsFCzIANXgALBBJAHkJcw99BQETBO7xrwf4IgbFBEICB0QAZQB/ZgBhAHUAbGUDYPjypwH59aoI+PDwv/r1F1MAaNQAZWUBEAP5&#13;&#10;9X8DdK28ubTM5gjtZPvzDUldAEYAcrsAb10AdABP1gBU6tQAeGUAASISaABttNwAEAMU+vQCMAkHAWExQAGFEuAGIgkAAA==&#13;&#10;</_PersistData>
		</ubiviewer>
		<Calendar AutoIncrement="1" BKColor="user13" Border="Flat" BorderColor="user10" Dateformat="yyyy/MM/dd" DayStyle="edit" Height="20" Id="cal_Sday" Left="632" MonthPickerFormat="yyyy년&#32;MM월" OnKillFocus="cal_Sday_OnKillFocus" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="3" ToolTipText="기간_S" Top="18" Width="86"></Calendar>
		<Calendar BKColor="user13" Border="Flat" BorderColor="user10" Dateformat="yyyy/MM/dd" DayStyle="edit" Height="20" Id="cal_Eday" Left="731" MonthPickerFormat="yyyy년&#32;MM월" OnKillFocus="cal_Eday_OnKillFocus" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="4" ToolTipText="기간_E" Top="18" Width="86"></Calendar>
		<Button ButtonStyle="TRUE" Enable="FALSE" Height="21" Id="report_close" ImageID="C_btn_110" Left="929" LeftMargin="28" OnClick="report_close_OnClick" Style="edit" TabOrder="5" Text="리포트&#32;닫기" Top="51" TopMargin="1" Width="111"></Button>
		<Static Height="16" Id="stt_bank_nm" Left="528" Style="tx_left_bold" TabOrder="6" Top="56" VAlign="Middle" Visible="FALSE" Width="70"></Static>
		<Static Height="16" Id="stt_accn_num" Left="712" Style="tx_left_bold" TabOrder="7" Top="56" VAlign="Middle" Visible="FALSE" Width="200"></Static>
		<Combo BindDataset="ds_In" Border="Flat" BorderColor="user3" Column="BSTYP_CD" Height="20" Id="cob_BSTYP_CD" Left="232" Style="edit" TabOrder="8" Top="56" Visible="FALSE" Width="110"></Combo>
		<Static Height="18" Id="stt_count" Left="9" TabOrder="9" Text="총&#32;:&#32;건" Top="782" Width="166"></Static>
		<Image Height="41" Id="Image1" ImageID="C_search_left" Left="8" TabOrder="18" TabStop="FALSE" Top="7" Width="10"></Image>
		<Image Height="41" Id="Image18" ImageID="C_search_right" Left="1029" TabOrder="15" TabStop="FALSE" Top="7" Width="10"></Image>
		<Calendar Border="Flat" BorderColor="user3" Dateformat="yyyy/MM/dd" DayStyle="edit" Height="20" Id="cal_OPBI_DAY" Left="926" MonthPickerFormat="yyyy년&#32;MM월" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="12" ToolTipText="개업일자" Top="18" Value="TODAY" Width="86"></Calendar>
		<Static Height="13" Id="Static0" Left="862" Style="tx_left_bold" TabOrder="21" Text="납부일자" Top="22" Width="56"></Static>
		<Image Height="11" Id="Image3" ImageID="C_icon" Left="845" TabOrder="19" TabStop="FALSE" Top="22" Width="11"></Image>
		<Static Height="15" Id="Static4" Left="200" Style="tx_left_bold" TabOrder="24" Text="업종" Top="56" Visible="FALSE" Width="73"></Static>
		<Static Height="14" Id="Static3" Left="720" TabOrder="23" Text="~" Top="23" Width="16"></Static>
		<Image Height="11" Id="Image6" ImageID="C_icon" Left="184" TabOrder="25" TabStop="FALSE" Top="56" Visible="FALSE" Width="11"></Image>
		<Static Height="19" Id="Static1" Left="564" Style="tx_left_bold" TabOrder="16" Text="등록기간" Top="22" Width="64"></Static>
		<Image Height="11" Id="Image2" ImageID="C_icon" Left="548" TabOrder="20" TabStop="FALSE" Top="22" Width="11"></Image>
		<Combo BindDataset="ds_In" Border="Flat" BorderColor="user10" CodeColumn="STAFF_CD" Column="STAFF_CD" DataColumn="STAFF_NM" Height="20" Id="cob_Staff_Nm" ImeMode="none" INDEX="1" InnerDataset="ds_SawonInfo" Left="450" TabOrder="26" ToolTipText="담당직원" Top="16" Width="79"></Combo>
		<Static Color="user12" Height="11" Id="Static6" Left="402" Style="tx_left_bold" TabOrder="28" Text="사원명" Top="22" Width="79"></Static>
		<Image Height="11" Id="Image5" ImageID="C_icon" Left="385" TabOrder="27" TabStop="FALSE" Top="22" Width="11"></Image>
		<Combo BKColor="user13" Border="Flat" BorderColor="user10" Height="20" Id="cob_BRAN_CD" ImeMode="none" INDEX="0" Left="256" OnChanged="cob_BRAN_CD_OnChanged" TabOrder="11" ToolTipText="센터명" Top="16" Width="114"></Combo>
		<Static Height="16" Id="Static5" Left="206" Style="tx_left_bold" TabOrder="14" Text="센터명" Top="22" Width="48"></Static>
		<Image Height="11" Id="Image0" ImageID="C_icon" Left="190" TabOrder="13" TabStop="FALSE" Top="22" Width="11"></Image>
		<Combo BKColor="user13" Border="Flat" BorderColor="user10" CodeColumn="code" DataColumn="value" Height="20" Id="cob_gbn" ImeMode="none" INDEX="0" InnerDataset="gbn" Left="80" OnChanged="Div0_cob_gbn_OnChanged" TabOrder="10" ToolTipText="구분" Top="16" Width="88"></Combo>
		<Static Height="16" Id="Static2" Left="44" Style="tx_left_bold" TabOrder="22" Text="구분" Top="22" Width="48"></Static>
		<Image Height="11" Id="Image4" ImageID="C_icon" Left="28" TabOrder="20" TabStop="FALSE" Top="22" Width="11"></Image>
		<Shape BKColor="user7" Bottom="80" Height="3" Id="Shape0" Left="8" LineColor="user7" Right="1039" TabOrder="30" Top="77" Type="Rectangle" Width="1031"></Shape>
		<FileDialog Bottom="40" Height="24" Id="FileDialog1" Left="1016" Right="1040" TabOrder="30" Top="16" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[#include "script::common.js"  	// 공통 js
#include "script::global.js"  	// 공통 js
#include "script::commonGibu.js"  	// 센터 공통 js

var mod = 0; //0 단체발급 일때 1 아닐때
var btn_print;	//프린트 속성을 기억
var checked = false;

function bra03_s10_OnLoadCompleted(obj)
{
    this.ds_in.AddRow();
	gfn_LoadForm(obj);
	gfn_GetDataGIBU_CD(this.cob_BRAN_CD, 1);
	//cal_Yrmn.Value = today();
	// 초기설정
	var curYMD = today();
	//cal_SDay.Value = substr(curYMD, 0, 6) + "01" ;  // 현재월의 첫날 부터
	cal_SDay.Value = curYMD;  
	cal_EDay.Value = curYMD;	// 현재일자 까지
	cal_OPBI_DAY.Value = today();	// 납부일자-_-
	
	// 업종 정보 가져오기
	gfn_GetDataBSTYP(cob_BSTYP_CD, 0);
	
	if(cob_BRAN_CD.Index < 0)
	{
		cob_BRAN_CD.Index = 0;
	}

	cob_BRAN_CD_OnChanged(this, cob_BRAN_CD.Value, "", "", "");
	
	gbn.DeleteRow(gbn.FindRow("code", "N"));
	
	btn_print = 0;
	this.cob_gbn.Value = 'M';
	//gfn_SetPermission(this.cob_BRAN_CD.Value);
	bra03_s10_OnSize();
}


//	공통버튼 컨트롤
function fn_CommmonButtonClick(strCode)
{
    //신규
    if(strCode == "NEW"){
		fn_New();
    }
    //조회
    else if(strCode == "SEARCH"){
		fn_Search();
    }
    //저장
    else if(strCode == "SAVE"){
		fn_Save();
    }    
    //삭제
    else if(strCode == "DELETE"){
		fn_Delete();
    }
    //Excel
    else if(strCode == "EXCEL"){
		fn_Excel();
    }
    //출력
    else if(strCode == "PRINT"){
		fn_Print();
    }
    //닫기
    else if(strCode == "CLOSE"){
        close();
    }

	return;
}

function fn_CallBack(srvId,ErrorCode,ErrorMsg)
{
	if(ErrorCode < 0) {
		//에러 공통 팝업
		gfn_SetErrorPop(ErrorCode,ErrorMsg);
		return;
	}
	
	if (srvId == "sys_bra03_s10_S")
	{
		gfn_SetStatusMsg(ds_ubi.count + " 건이 조회되었습니다.");
		stt_count.Text = "총 : " + ds_ubi.count + " 건이 조회되었습니다.";
	}
	else if (srvId == "sys_bra03_s10_P")
	{
		gfn_SetStatusMsg(ds_ubi_p.count + " 건이 조회되었습니다.");
	}
	else if (srvId == "svcStaff")
	{
		ds_SawonInfo.InsertRow(0);
		ds_SawonInfo.SetColumn(0,"STAFF_CD","");
		ds_SawonInfo.SetColumn(0,"STAFF_NM","--ALL--");
		
		cob_Staff_Nm.Index = 0;
	}
}

//조회
function fn_Search()
{
	if((substr(cal_Sday.Value, 4, 2) != substr(cal_Eday.Value, 4, 2)) && cob_gbn.Value != "N")
	{
		alert("조회기간은 같은 월로 설정해야 합니다.");
		cal_Sday.SetFocus();
		return;
	}
	
	if(cob_BSTYP_CD.Index == 0 && cob_gbn.Value == "N")
	{
		alert("업종은 전체로 조회할 수 없습니다.");
		cob_BSTYP_CD.SetFocus();
		return;
	}
	
	// 입력 필수 항목 검사;
	if (!gfn_CheckFormNull(this)) return;
	this.ds_In.SetColumn(0, "CRET_GBN", this.cob_gbn.Value);
	this.ds_In.SetColumn(0, "BRAN_CD", this.cob_BRAN_CD.Value);
	//this.ds_In.SetColumn(0, "DEMD_YRMN", substr(this.cal_Yrmn.Value,0,6) );
	this.ds_In.SetColumn(0, "DEMD_FROM", this.cal_SDay.Value);
	this.ds_In.SetColumn(0, "DEMD_TO", this.cal_EDay.Value);
	ds_In.SetColumn(0, "BSTYP_CD", cob_BSTYP_CD.Value);
	
	//trace(this.ds_in.SaveXML());
	gfn_syncCall("sys_bra03_s10_S","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005009&EVENTID=indtnpaper_list","S=ds_in","ds_ubi=MRG5","","fn_CallBack");
	ds_grd_search.Copy("ds_ubi");
	//trace(this.ds_ubi.SaveXML());
}

//저장
function fn_Save()
{
	if(ds_ubi.rowcount > 0)
	{
		FileDialog1.TYPE="DIR";
	
		if (!FileDialog1.Open())		{			return false;   		}
	
		var dirPath = FileDialog1.FilePath;
		var check = 0;
		var n = 0;
		
		for(var i = 0; i < ds_ubi.rowcount; i++)
		{
			if(ds_ubi.GetColumn(i, "CCHECK") == "1")
			{
				ds_ubi_p.ClearData();
				
				n = this.ds_ubi_p.AddRow();
				if (this.ds_ubi.GetColumn(i,"MAIL_RCPT") == "U" ) {
					this.ds_ubi_p.SetColumn(n, "UPSO_CD1", this.ds_ubi.GetColumn(i,"UPSO_CD"));
					this.ds_ubi_p.SetColumn(n, "UPSO_NM1", this.ds_ubi.GetColumn(i,"UPSO_NM"));
				}	ELSE {
					this.ds_ubi_p.SetColumn(n, "UPSO_CD1", "");
					this.ds_ubi_p.SetColumn(n, "UPSO_NM1", "");
				}
				this.ds_ubi_p.SetColumn(n, "UPSO_CD", this.ds_ubi.GetColumn(i,"UPSO_CD"));
				this.ds_ubi_p.SetColumn(n, "UPSO_NM", this.ds_ubi.GetColumn(i,"UPSO_NM"));
				this.ds_ubi_p.SetColumn(n, "PAYPRES_NM", this.ds_ubi.GetColumn(i,"PAYPRES_NM"));
				this.ds_ubi_p.SetColumn(n, "UPSO_ADDR", this.ds_ubi.GetColumn(i,"UPSO_ADDR"));
				this.ds_ubi_p.SetColumn(n, "UPSO_ZIP", this.ds_ubi.GetColumn(i,"UPSO_ZIP"));
				this.ds_ubi_p.SetColumn(n, "MONPRNCFEE", this.ds_ubi.GetColumn(i,"MONPRNCFEE"));
				this.ds_ubi_p.SetColumn(n, "NONPY_AMT", this.ds_ubi.GetColumn(i,"NONPY_AMT"));
				this.ds_ubi_p.SetColumn(n, "TOT_DEMD_AMT", this.ds_ubi.GetColumn(i,"TOT_DEMD_AMT"));
				this.ds_ubi_p.SetColumn(n, "TOT_ADDT_AMT", this.ds_ubi.GetColumn(i,"TOT_ADDT_AMT"));
				this.ds_ubi_p.SetColumn(n, "START_YRMN", this.ds_ubi.GetColumn(i,"START_YRMN"));
				this.ds_ubi_p.SetColumn(n, "END_YRMN", this.ds_ubi.GetColumn(i,"END_YRMN"));
				this.ds_ubi_p.SetColumn(n, "BRAN_NM", this.ds_ubi.GetColumn(i,"BRAN_NM"));
				this.ds_ubi_p.SetColumn(n, "BRAN_ADDR", this.ds_ubi.GetColumn(i,"BRAN_ADDR"));
				this.ds_ubi_p.SetColumn(n, "POST_NUM", this.ds_ubi.GetColumn(i,"POST_NUM"));
				this.ds_ubi_p.SetColumn(n, "BRAN_PHON", this.ds_ubi.GetColumn(i,"BRAN_PHON"));
				this.ds_ubi_p.SetColumn(n, "BRAN_FAX", this.ds_ubi.GetColumn(i,"BRAN_FAX"));
				this.ds_ubi_p.SetColumn(n, "GRADNM", this.ds_ubi.GetColumn(i,"GRADNM"));
				this.ds_ubi_p.SetColumn(n, "DEMD_DAY", this.ds_ubi.GetColumn(i,"DEMD_DAY"));
				this.ds_ubi_p.SetColumn(n, "DEMD_NUM", this.ds_ubi.GetColumn(i,"DEMD_NUM"));
				this.ds_ubi_p.SetColumn(n, "CRET_GBN", this.cob_gbn.Value);
				
				this.ds_ubi_p.SetColumn(n, "CLIENT_NUM", this.ds_ubi.GetColumn(i,"CLIENT_NUM"));
	
				ds_Virtual_In.ClearData();
				ds_Virtual_In.AddRow();
				ds_Virtual_In.SetColumn(0, "UPSO_CD", ds_ubi.GetColumn(i, "UPSO_CD"));
				ds_Virtual_temp.ClearData();
				
				gfn_syncCall("svcSearchInfo","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005024&EVENTID=sel_virtual_temp","S=ds_Virtual_In","ds_Virtual_temp=SEL1","","fn_CallBack");
				
				ds_ubi_p.SetColumn(n, "BANK_NM1", ds_Virtual_temp.GetColumn(0, "BANK_NM"));
				ds_ubi_p.SetColumn(n, "ACCN_NUM1", ds_Virtual_temp.GetColumn(0, "ACCN_NUM"));
				
				if(ds_Virtual_temp.rowcount > 1 && ds_Virtual_temp.GetColumn(1, "USE_YN") == "Y")
				{
					ds_ubi_p.SetColumn(n, "BANK_NM2", ds_Virtual_temp.GetColumn(1, "BANK_NM"));
					ds_ubi_p.SetColumn(n, "ACCN_NUM2", ds_Virtual_temp.GetColumn(1, "ACCN_NUM"));
				}
				if(ds_Virtual_temp.rowcount > 2 && ds_Virtual_temp.GetColumn(2, "USE_YN") == "Y")
				{
					ds_ubi_p.SetColumn(n, "BANK_NM3", ds_Virtual_temp.GetColumn(2, "BANK_NM"));
					ds_ubi_p.SetColumn(n, "ACCN_NUM3", ds_Virtual_temp.GetColumn(2, "ACCN_NUM"));
				}
				
				this.ds_ubi_p.SetColumn(n, "ACCN_OWNER1", ds_Virtual_temp.GetColumn(0, "REPTPRES"));
				
				check = 1;
			}
			
			if(check == 1)
			{
				gfn_syncCall("sys_bra03_s10_P","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005009&EVENTID=indtnpaper_prnt_mng","S=ds_ubi_p:U","ds_grd_search=SEL1 ","","fn_CallBack" ,gv_TraceLog, GV_FORMID);        
	
				ubiviewer0.SetDataset("ds_ubi", "ds_ubi_p");
				ubiviewer0.SetArgument("BRAN_NM", cob_BRAN_CD.Text);
				ubiviewer0.SetArgument("DATE", cal_OPBI_DAY.Value);
				ubiviewer0.setJrfFileDir(gv_ReportUrl+"fi/bra/");
				ubiviewer0.setJrfFileName("bra03_s10_bg.jrf");
				ubiviewer0.SetVariable("exportAsOrgImage", "true");
				ubiviewer0.Retrieve();
				ubiviewer0.exportFileName = dirPath + "\\" + ds_ubi_p.GetColumn(n, "UPSO_CD") + "_" + ds_ubi_p.GetColumn(n, "UPSO_NM") + ".pdf";
				ubiviewer0.ExportFile("PDF");
				
				check = 0;
			}
		}
	}
}

//엑셀출력
function fn_Excel(){
}

//출력function fn_Print()
{
	if (!gfn_CheckFormNull(this)) return;	// 입력 필수 항목 검사;
	this.ds_ubi_p.ClearData();
	
	var check;
	for(var i=0; i<this.ds_ubi.RowCount(); i++)
	{   
		if(this.ds_ubi.GetColumn(i,"CCHECK")==1)
		{  		
			var n = this.ds_ubi_p.AddRow();
			if (this.ds_ubi.GetColumn(i,"MAIL_RCPT") == "U" ) {
				this.ds_ubi_p.SetColumn(n, "UPSO_CD1", this.ds_ubi.GetColumn(i,"UPSO_CD"));
				this.ds_ubi_p.SetColumn(n, "UPSO_NM1", this.ds_ubi.GetColumn(i,"UPSO_NM"));
			}	ELSE {
				this.ds_ubi_p.SetColumn(n, "UPSO_CD1", "");
				this.ds_ubi_p.SetColumn(n, "UPSO_NM1", "");
			}
			this.ds_ubi_p.SetColumn(n, "UPSO_CD", this.ds_ubi.GetColumn(i,"UPSO_CD"));
			this.ds_ubi_p.SetColumn(n, "UPSO_NM", this.ds_ubi.GetColumn(i,"UPSO_NM"));
			this.ds_ubi_p.SetColumn(n, "PAYPRES_NM", this.ds_ubi.GetColumn(i,"PAYPRES_NM"));
			this.ds_ubi_p.SetColumn(n, "UPSO_ADDR", this.ds_ubi.GetColumn(i,"UPSO_ADDR"));
			this.ds_ubi_p.SetColumn(n, "UPSO_ZIP", this.ds_ubi.GetColumn(i,"UPSO_ZIP"));
			this.ds_ubi_p.SetColumn(n, "MONPRNCFEE", this.ds_ubi.GetColumn(i,"MONPRNCFEE"));
			this.ds_ubi_p.SetColumn(n, "NONPY_AMT", this.ds_ubi.GetColumn(i,"NONPY_AMT"));
			this.ds_ubi_p.SetColumn(n, "TOT_DEMD_AMT", this.ds_ubi.GetColumn(i,"TOT_DEMD_AMT"));
			this.ds_ubi_p.SetColumn(n, "TOT_ADDT_AMT", this.ds_ubi.GetColumn(i,"TOT_ADDT_AMT"));
			this.ds_ubi_p.SetColumn(n, "START_YRMN", this.ds_ubi.GetColumn(i,"START_YRMN"));
			this.ds_ubi_p.SetColumn(n, "END_YRMN", this.ds_ubi.GetColumn(i,"END_YRMN"));
			this.ds_ubi_p.SetColumn(n, "BRAN_NM", this.ds_ubi.GetColumn(i,"BRAN_NM"));
			this.ds_ubi_p.SetColumn(n, "BRAN_ADDR", this.ds_ubi.GetColumn(i,"BRAN_ADDR"));
			this.ds_ubi_p.SetColumn(n, "POST_NUM", this.ds_ubi.GetColumn(i,"POST_NUM"));
			this.ds_ubi_p.SetColumn(n, "BRAN_PHON", this.ds_ubi.GetColumn(i,"BRAN_PHON"));
			this.ds_ubi_p.SetColumn(n, "BRAN_FAX", this.ds_ubi.GetColumn(i,"BRAN_FAX"));
			this.ds_ubi_p.SetColumn(n, "GRADNM", this.ds_ubi.GetColumn(i,"GRADNM"));
			this.ds_ubi_p.SetColumn(n, "DEMD_DAY", this.ds_ubi.GetColumn(i,"DEMD_DAY"));
			this.ds_ubi_p.SetColumn(n, "DEMD_NUM", this.ds_ubi.GetColumn(i,"DEMD_NUM"));
			this.ds_ubi_p.SetColumn(n, "CRET_GBN", this.cob_gbn.Value);
			
			this.ds_ubi_p.SetColumn(n, "CLIENT_NUM", this.ds_ubi.GetColumn(i,"CLIENT_NUM"));

			ds_Virtual_In.ClearData();
			ds_Virtual_In.AddRow();
			ds_Virtual_In.SetColumn(0, "UPSO_CD", ds_ubi.GetColumn(i, "UPSO_CD"));
			ds_Virtual_temp.ClearData();
			
			gfn_syncCall("svcSearchInfo","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005024&EVENTID=sel_virtual_temp","S=ds_Virtual_In","ds_Virtual_temp=SEL1","","fn_CallBack");
			
			ds_ubi_p.SetColumn(n, "BANK_NM1", ds_Virtual_temp.GetColumn(0, "BANK_NM"));
			ds_ubi_p.SetColumn(n, "ACCN_NUM1", ds_Virtual_temp.GetColumn(0, "ACCN_NUM"));
			
			if(ds_Virtual_temp.rowcount > 1 && ds_Virtual_temp.GetColumn(1, "USE_YN") == "Y")
			{
				ds_ubi_p.SetColumn(n, "BANK_NM2", ds_Virtual_temp.GetColumn(1, "BANK_NM"));
				ds_ubi_p.SetColumn(n, "ACCN_NUM2", ds_Virtual_temp.GetColumn(1, "ACCN_NUM"));
			}
			if(ds_Virtual_temp.rowcount > 2 && ds_Virtual_temp.GetColumn(2, "USE_YN") == "Y")
			{
				ds_ubi_p.SetColumn(n, "BANK_NM3", ds_Virtual_temp.GetColumn(2, "BANK_NM"));
				ds_ubi_p.SetColumn(n, "ACCN_NUM3", ds_Virtual_temp.GetColumn(2, "ACCN_NUM"));
			}
			
			this.ds_ubi_p.SetColumn(n, "ACCN_OWNER1", ds_Virtual_temp.GetColumn(0, "REPTPRES"));
			
			check = 1;
		}
	}

	if(check == 1)
	{
		//trace(this.ds_ubi_p.SaveXML());
		
		gfn_syncCall("sys_bra03_s10_P","KOMCA?SYSID=PATHFINDER&MENUID=1000001006005009&EVENTID=indtnpaper_prnt_mng","S=ds_ubi_p:U","ds_grd_search=SEL1 ","","fn_CallBack" ,gv_TraceLog, GV_FORMID);        
	
		ubiviewer0.SetDataset("ds_ubi", "ds_ubi_p");
		ubiviewer0.SetArgument("BRAN_NM", cob_BRAN_CD.Text);
		ubiviewer0.SetArgument("DATE", cal_OPBI_DAY.Value);
		ubiviewer0.setJrfFileDir(gv_ReportUrl+"fi/bra/");
		ubiviewer0.setJrfFileName("bra03_s10.jrf");
		ubiviewer0.Retrieve();
		ubiviewer0.Visible = true;
		report_close.Enable = true;
	}
}

function cob_BRAN_CD_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	gfn_SetPermission(strCode);
	
	if (this.cob_BRAN_CD.Value != null)
	{
		this.ds_search_accn.ClearData();
		this.ds_search_accn.AddRow();
		this.ds_search_accn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
		this.ds_search_accn.SetColumn(0, "USE_TYPE", gfn_GetAccountUsage("03"));	
		gfn_syncCall("find_account","KOMCA?SYSID=PATHFINDER&MENUID=1000001006007&EVENTID=accn_num_select2","S=ds_search_accn","ds_banklist=SEL1","","fn_CallBack");
		
		this.ds_BRAN_CD.SetColumn(0,"BRAN_CD", this.cob_BRAN_CD.value);
		gfn_syncCall("svcStaff","KOMCA?SYSID=PATHFINDER&MENUID=1000001006007&EVENTID=p_staff_select","S=ds_BRAN_CD","ds_SawonInfo=SEL1","","fn_CallBack");
	}
}

function grd_UPSO_REPT_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if (nCell == 8) {
		var i=0;
		for(i=0; i<ds_ubi.RowCount(); i++){
			if(btn_print==1){
				this.ds_ubi.SetColumn(i,"CCHECK",0);
			}
			else this.ds_ubi.SetColumn(i,"CCHECK",1);
		}
		if(btn_print ==0) btn_print =1;
		else btn_print = 0;
	} else {
		gfnGridSort(obj, ds_ubi, nCell);
	}
}

function cal_Sday_OnKillFocus(obj)
{
	if(substr(this.cal_Sday.Value,0,4)=="0000"){
		this.cal_Sday.SetFocus();
	}
}

function cal_Eday_OnKillFocus(obj)
{
	if(substr(this.cal_Eday.Value,0,4)=="0000"){
		this.cal_Eday.SetFocus();
	}
}

function report_close_OnClick(obj)
{
	report_close.Enable = false;
	ubiviewer0.Visible = false;
	
}

function Div0_cob_gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "N")
	{
		cal_Eday.Visible = false;
		Static3.Visible = false;
		Image6.Visible = true;
		Static4.Visible = true;
		cob_BSTYP_CD.Visible = true;
		cal_Sday.DateFormat = "yyyy/MM";
		cal_Sday.SpinStyle = true;
		cal_Sday.Width = 80;
		cal_Sday.FocusIndex = 1;
	}
	else
	{
		cal_Eday.Visible = true;
		Static3.Visible = true;
		Image6.Visible = false;
		Static4.Visible = false;
		cob_BSTYP_CD.Visible = false;
		cal_Sday.DateFormat = "yyyy/MM/dd";
		cal_Sday.SpinStyle = false;
		cal_Sday.Width = 101;
		cal_Sday.FocusIndex = 0;
	}
}

function bra03_s10_OnSize(obj,nCx,nCy,nState)
{
	gfn_ObjreSize(Shape0, bra03_s10, 1, 0);
	gfn_ObjreSize(grd_List, bra03_s10, 1, 0);
}

function grd_List_OnHeadDblClick(obj,nCell,nX,nY,nPivotIndex)
{
	var yn;
	
	if (nCell == grd_List.GetBindCellIndex("body", "CCHECK"))
	{
		checked = !checked;
		
		if (checked = true)
		{
			yn = '1';
		}
		else
		{
			yn = '0';
		}

		for (var i = 0; i < ds_ubi.rowcount; i++)
		{
			if(ds_ubi.GetColumn(i,"CCHECK") != yn)
			{
				ds_ubi.SetColumn(i, "CCHECK", yn);
			}
		}
	}
}
]]></Script>
</Window>