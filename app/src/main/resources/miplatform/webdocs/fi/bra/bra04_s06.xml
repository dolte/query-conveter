<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="844" Id="bra04_s06" Left="8" OnLoadCompleted="form_OnLoadCompleted" PidAttrib="7" Title="무통장&#32;입금&#32;등록" Top="8" Ver="1.0" Width="1048" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_s06_ReptIn" UseClientLayout="1">
				<Contents>
					<colinfo id="B_UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPT_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="B_MM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="B_CODE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_USE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="B_RECV_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="B_MAPPING_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="MM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="MAPPING_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_ReptTrans">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYPRES_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="INFO_REPT_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_upso" UseClientLayout="1">
				<Contents>
					<colinfo id="UPSO_CD" size="256" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" type="STRING"/>
					<colinfo id="MONPRNCFEE" size="256" type="STRING"/>
					<colinfo id="MONPRNCFEE2" size="256" type="STRING"/>
					<colinfo id="BSTYP_CD" size="256" type="STRING"/>
					<colinfo id="UPSO_GRAD" size="256" type="STRING"/>
					<colinfo id="GRAD" size="256" type="STRING"/>
					<colinfo id="GRADNM" size="256" type="STRING"/>
					<colinfo id="MNGEMSTR_NM" size="256" type="STRING"/>
					<colinfo id="STAFF_CD" size="256" type="STRING"/>
					<colinfo id="STAFF_NM" size="256" type="STRING"/>
					<colinfo id="END_DATE" size="256" type="STRING"/>
					<colinfo id="LAST_YRMN" size="256" type="STRING"/>
					<colinfo id="BIOWN_NUM" size="256" type="STRING"/>
					<colinfo id="UPSO_ADDR1" size="256" type="STRING"/>
					<colinfo id="UPSO_ADDR2" size="256" type="STRING"/>
					<colinfo id="OPBI_DAY" size="256" type="STRING"/>
					<colinfo id="NEW_DAY" size="256" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" type="STRING"/>
					<colinfo id="BALANCE" size="256" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" type="STRING"/>
					<colinfo id="CLSBS_YRMN" size="256" type="STRING"/>
					<colinfo id="CLAIM_YN" size="256" type="STRING"/>
					<colinfo id="CLAIM_APPTN_YRMN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_upso_search">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<record>
						<ACCN_NUM></ACCN_NUM>
						<BRAN_CD></BRAN_CD>
						<END_DAY></END_DAY>
						<RECV_DAY></RECV_DAY>
						<REPT_AMT></REPT_AMT>
						<REPT_DAY></REPT_DAY>
						<REPT_NUM></REPT_NUM>
						<START_DAY></START_DAY>
						<UPSO_CD></UPSO_CD>
						<YEAR></YEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_bankbook" OnColumnChanged="ds_s06_bankbook_OnColumnChanged" OnRowPosChanged="ds_s06_bankbook_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPTPRES" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPT_BANK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="COMIS" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_MMCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="MAPPING_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="NESS_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTO_UPSO" size="256" summ="default" type="STRING"/>
					<colinfo id="STAFF_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_rept_trans01" OnRowPosChanged="ds_s06_rept_trans01_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPTPRES" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_rept_trans02" OnRowPosChanged="ds_s06_rept_trans02_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPTPRES" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPT_BANK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPRES_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="S_BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="NESS_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_rept_trans03" OnColumnChanged="ds_s06_rept_trans03_OnColumnChanged" OnRowPosChanged="ds_s06_rept_trans03_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_MMCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="COMIS" size="256" summ="default" type="STRING"/>
					<colinfo id="BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAPPING_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="NESS_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_reptupso01" OnRowPosChanged="ds_s06_reptupso01_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPTPRES" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPT_BANK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPRES_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INS_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_reptupso02" OnColumnChanged="ds_s06_reptupso02_OnColumnChanged" OnRowPosChanged="ds_s06_reptupso02_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_MMCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="COMIS" size="256" summ="default" type="STRING"/>
					<colinfo id="BALANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="REMAK" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAPPING_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="NESS_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_upso_search02">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
					<record>
						<BRAN_CD></BRAN_CD>
						<RECV_DAY></RECV_DAY>
						<REPT_DAY></REPT_DAY>
						<REPT_NUM></REPT_NUM>
						<UPSO_CD></UPSO_CD>
						<YEAR></YEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_error"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_AccuInfo" UseClientLayout="1">
				<Contents>
					<colinfo id="SOL_START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="SOL_END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="SOL_ORG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOL_ADDT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCU_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCU_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCU_BRAN" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCU_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JUDG_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_MMCNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_DemdInfo">
				<Contents>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_MMCNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_closingYn">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_closingIn">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<record>
						<BRAN_CD></BRAN_CD>
						<REPT_DAY></REPT_DAY>
						<UPSO_CD></UPSO_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_AccnNumIn">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_TYPE" size="256" summ="default" type="STRING"/>
					<record>
						<BRAN_CD></BRAN_CD>
						<USE_TYPE></USE_TYPE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_bankList" UseClientLayout="1">
				<Contents>
					<colinfo id="ACCN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCN_NUM" size="256" summ="default" type="STRING"/>
					<record>
						<ACCN_NUM></ACCN_NUM>
						<ACCN_SEQ></ACCN_SEQ>
						<BANK_NM></BANK_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_ReptIn2">
				<Contents>
					<colinfo id="BRAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="START_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMD_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_NextAmt">
				<Contents>
					<colinfo id="TOT_USE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_ADDT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_EADDT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DSCT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEMD_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_chk_yrmn">
				<Contents>
					<colinfo id="UPSO_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s06_chk_yrmn_result">
				<Contents>
					<colinfo id="END_YRMN" size="256" summ="default" type="STRING"/>
					<colinfo id="REPT_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auto_match_in">
				<Contents>
					<colinfo id="BRAN_CD" size="256" type="STRING"/>
					<colinfo id="REPTPRES" size="256" type="STRING"/>
					<colinfo id="REPT_AMT" size="256" type="STRING"/>
					<colinfo id="REPT_DAY" size="256" type="STRING"/>
					<colinfo id="REPT_NUM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auto_match_out">
				<Contents>
					<colinfo id="UPSO_CD" size="256" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auto_match_err">
				<Contents>
					<colinfo id="UPSO_CD" size="256" type="STRING"/>
					<colinfo id="UPSO_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="whitesmoke" Bottom="384" Height="330" Id="Shape1" Left="695" LineColor="user3" Right="1103" TabOrder="15" Top="54" Type="Rectangle" Width="408"></Shape>
		<Image Height="41" Id="Image18" ImageID="C_search_right" Left="1094" TabOrder="19" TabStop="FALSE" Top="9" Width="10"></Image>
		<Image FillType="STRETCH" Height="41" Id="Image15" ImageID="C_search_bg" Left="16" TabOrder="21" TabStop="FALSE" Top="9" Width="1080"></Image>
		<Image Height="41" Id="Image17" ImageID="C_search_left" Left="8" TabOrder="20" TabStop="FALSE" Top="9" Width="10"></Image>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="49" Id="Static6" Left="702" Style="box_tx" TabOrder="5" Text="영업장주소" Top="332" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static4" Left="702" Style="box_tx" TabOrder="0" Text="업&#32;소&#32;명" Top="82" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static7" Left="702" Style="box_tx" TabOrder="4" Text="기계대수" Top="157" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static8" Left="702" Style="box_tx" TabOrder="6" Text="업소코드" Top="57" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static9" Left="702" Style="box_tx" TabOrder="10" Text="업&#32;주&#32;명" Top="107" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static12" Left="702" Style="box_tx" TabOrder="12" Text="담당사원" Top="132" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static13" Left="702" Style="box_tx" TabOrder="13" Text="월사용료" Top="232" VAlign="Middle" Width="90"></Static>
		<Image Height="11" Id="Image0" ImageID="C_icon" Left="32" TabOrder="7" TabStop="FALSE" Top="25" Width="11"></Image>
		<Static Height="16" Id="Static5" Left="48" Style="tx_left_bold" TabOrder="16" Text="센터명" Top="25" Width="40"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static20" Left="702" Style="box_tx" TabOrder="20" Text="업&#32;&#32;&#32;&#32;&#32;종" Top="182" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static21" Left="702" Style="box_tx" TabOrder="22" Text="기준월정료" Top="207" VAlign="Middle" Width="90"></Static>
		<Combo BindDataset="ds_s06_upso_search" BKColor="user13" Border="Flat" BorderColor="user10" Column="BRAN_CD" Height="20" Id="cob_BRAN_CD" ImeMode="none" Left="108" OnChanged="cob_BRAN_CD_OnChanged" TabOrder="1" ToolTipText="센터명" Top="20" Width="114"></Combo>
		<Grid BindDataset="ds_s06_ReptIn" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="384" ColSelect="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="25" Height="330" Id="grd_UPSO_REPT" InputPanel="FALSE" Left="8" LineColor="silver" Right="696" RowHeight="23" Style="grid" TabOrder="14" TabStop="FALSE" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="688">
			<contents>
				<format id="Default">
					<columns>
						<col width="43"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell col="0" color="user12" display="text" rowspan="2" text="월"/>
						<cell col="1" color="user12" colspan="4" display="text" text="2008"/>
						<cell col="5" color="user12" colspan="4" display="text" text="2009"/>
						<cell autosizing="none" col="9" display="text" rowspan="2" text="BB입금년월"/>
						<cell autosizing="none" col="10" display="text" rowspan="2" text="B입급년월"/>
						<cell autosizing="none" col="11" display="text" rowspan="2" text="입금년월"/>
						<cell col="1" color="user12" display="text" font="굴림,9,Bold" row="1" text="구분"/>
						<cell col="2" color="user12" display="text" font="굴림,9,Bold" row="1" text="금&#32;액"/>
						<cell col="3" color="user12" display="text" font="굴림,9,Bold" row="1" text="입금일자"/>
						<cell col="4" color="user12" display="text" font="굴림,9,Bold" row="1" text="영수일자"/>
						<cell col="5" color="user12" display="text" font="굴림,9,Bold" row="1" text="구분"/>
						<cell col="6" color="user12" display="text" font="굴림,9,Bold" row="1" text="금&#32;액"/>
						<cell col="7" color="user12" display="text" font="굴림,9,Bold" row="1" text="입금일자"/>
						<cell col="8" color="user12" display="text" font="굴림,9,Bold" row="1" text="영수일자"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user2" celltype="head" col="0" colid="MM" color="user12" display="text" font="굴림,9,Bold"/>
						<cell align="center" bkcolor2="user2" col="1" colid="B_CODE_NM" display="text"/>
						<cell bkcolor2="user2" col="2" colid="B_USE_AMT" display="number"/>
						<cell align="center" bkcolor2="user2" col="3" colid="B_MAPPING_DAY" display="text" Mask="9999/99/99"/>
						<cell align="center" bkcolor2="user2" col="4" colid="B_RECV_DAY" display="text" Mask="9999/99/99"/>
						<cell align="center" bkcolor2="user2" col="5" colid="CODE_NM" display="combo"/>
						<cell bkcolor2="user2" col="6" colid="USE_AMT" display="number"/>
						<cell align="center" bkcolor2="user2" col="7" colid="MAPPING_DAY" display="text" Mask="9999/99/99"/>
						<cell align="center" bkcolor2="user2" col="8" colid="RECV_DAY" display="text" Mask="9999/99/99"/>
						<cell col="9" colid="BB_REPT_YRMN" display="text"/>
						<cell col="10" colid="B_REPT_YRMN" display="text"/>
						<cell col="11" colid="REPT_YRMN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="19" Id="Static1" Left="272" Style="tx_left_bold" TabOrder="28" Text="기간" Top="25" Width="40"></Static>
		<Image Height="11" Id="Image2" ImageID="C_icon" Left="256" TabOrder="16" TabStop="FALSE" Top="25" Width="11"></Image>
		<Shape BKColor="user7" Bottom="760" Height="3" Id="Shape2" Left="17" LineColor="user7" Right="1025" TabOrder="29" Top="757" Type="Rectangle" Visible="FALSE" Width="1008"></Shape>
		<Div Height="76" Id="div_Indtn" Left="16" TabOrder="18" TabStop="FALSE" Text="Div0" Top="760" Visible="FALSE" Width="1008">
			<Contents>
				<Shape BKColor="whitesmoke" Bottom="70" Height="62" Id="Shape2" Left="-7" LineColor="user3" Right="1002" TabOrder="5" Top="8" Type="Rectangle" Visible="FALSE" Width="1009"></Shape>
				<Shape BKColor="white" Bottom="65" Height="26" Id="Shape1" Left="138" LineColor="user3" Right="918" TabOrder="16" Top="39" Type="Rectangle" Visible="FALSE" Width="780"></Shape>
				<Shape BKColor="white" Bottom="38" Height="26" Id="Shape0" Left="138" LineColor="user3" Right="918" TabOrder="15" Top="12" Type="Rectangle" Visible="FALSE" Width="780"></Shape>
				<MaskEdit BindDataset="ds_s06_IndtnDetail" Border="Flat" BorderColor="user3" Column="USE_AMT" Enable="FALSE" Height="22" Id="mae_USE_AMT" Left="229" MaxLength="10" TabOrder="1" Top="14" Visible="FALSE" Width="124"></MaskEdit>
				<Shape BKColor="user7" Bottom="-76" Height="3" Id="Shape4" Left="0" LineColor="user7" Right="1009" TabOrder="2" Top="-79" Type="Rectangle" Width="1009"></Shape>
				<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static18" Left="96" Style="box_tx" TabOrder="3" Text="월&#32;계" Top="12" VAlign="Middle" Visible="FALSE" Width="130"></Static>
				<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static14" Left="96" Style="box_tx" TabOrder="4" Text="누&#32;계" Top="39" VAlign="Middle" Visible="FALSE" Width="130"></Static>
				<MaskEdit BindDataset="ds_s06_IndtnDetail" Border="Flat" BorderColor="user3" Column="ADDT_AMT" Enable="FALSE" Height="22" Id="mae_ADDT_AMT" Left="229" MaxLength="10" TabOrder="6" Top="41" Visible="FALSE" Width="124"></MaskEdit>
				<MaskEdit BindDataset="ds_s06_IndtnDetail" Border="Flat" BorderColor="user3" Column="USE_AMT" Enable="FALSE" Height="22" Id="MaskEdit0" Left="504" MaxLength="10" TabOrder="7" Top="14" Visible="FALSE" Width="124"></MaskEdit>
				<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static0" Left="371" Style="box_tx" TabOrder="8" Text="월&#32;가수금" Top="12" VAlign="Middle" Visible="FALSE" Width="130"></Static>
				<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static1" Left="371" Style="box_tx" TabOrder="9" Text="누계&#32;가수금" Top="39" VAlign="Middle" Visible="FALSE" Width="130"></Static>
				<MaskEdit BindDataset="ds_s06_IndtnDetail" Border="Flat" BorderColor="user3" Column="ADDT_AMT" Enable="FALSE" Height="22" Id="MaskEdit1" Left="504" MaxLength="10" TabOrder="10" Top="41" Visible="FALSE" Width="124"></MaskEdit>
				<MaskEdit BindDataset="ds_s06_IndtnDetail" Border="Flat" BorderColor="user3" Column="USE_AMT" Enable="FALSE" Height="22" Id="MaskEdit2" Left="776" MaxLength="10" TabOrder="11" Top="14" Visible="FALSE" Width="124"></MaskEdit>
				<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static2" Left="643" Style="box_tx" TabOrder="12" Text="월&#32;전산입금액" Top="11" VAlign="Middle" Visible="FALSE" Width="130"></Static>
				<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static3" Left="643" Style="box_tx" TabOrder="13" Text="누계&#32;전산입금액" Top="39" VAlign="Middle" Visible="FALSE" Width="130"></Static>
				<MaskEdit BindDataset="ds_s06_IndtnDetail" Border="Flat" BorderColor="user3" Column="ADDT_AMT" Enable="FALSE" Height="22" Id="MaskEdit3" Left="776" MaxLength="10" TabOrder="14" Top="41" Visible="FALSE" Width="124"></MaskEdit>
			</Contents>
		</Div>
		<Shape BKColor="white" Bottom="83" Height="26" Id="Shape3" Left="791" LineColor="user3" Right="1097" TabOrder="30" Top="57" Type="Rectangle" Width="306"></Shape>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static10" Left="702" Style="box_tx" TabOrder="31" Text="개업일자" Top="257" VAlign="Middle" Width="90"></Static>
		<Tab Height="355" Id="tab_REPT" Left="8" OnChanged="tab_REPT_OnChanged" TabOrder="28" TabStop="FALSE" Top="400" Width="1104">
			<Contents>
				<TabPage BorderColor="black" Height="326" Id="TRANS" ImageID="C_tab2" Left="2" TabOrder="69" Text="무통장&#32;입금&#32;등록" Top="27" Width="1100">
					<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="ds_s06_bankbook" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" BorderColor="user7" Bottom="323" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="299" Id="grd_ReptTrans" InputPanel="FALSE" Left="6" LineColor="silver" OnCellClick="tab_REPT_TRANS_grd_ReptTrans_OnCellClick" OnCellDBLClick="grd_bank_OnCellDblClick" OnExpandEdit="tab_REPT_TRANS_grd_ReptTrans_OnExpandEdit" Right="1094" RowHeight="20" Style="grid" TabOrder="1" TabStop="FALSE" Top="24" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1088">
						<contents>
							<format id="Default">
								<columns>
									<col width="67"/>
									<col width="98"/>
									<col width="98"/>
									<col width="70"/>
									<col width="70"/>
									<col width="70"/>
									<col width="80"/>
									<col width="61"/>
									<col width="135"/>
									<col width="60"/>
									<col width="60"/>
									<col width="40"/>
									<col width="103"/>
									<col width="56"/>
								</columns>
								<head>
									<cell bkcolor="user8" col="0" color="user12" display="text" rowspan="2" text="영수일"/>
									<cell bkcolor="user8" col="1" color="user12" display="text" rowspan="2" text="취급점"/>
									<cell bkcolor="user8" col="2" color="user12" display="text" rowspan="2" text="적요"/>
									<cell bkcolor="user8" col="3" color="user12" display="text" rowspan="2" text="입금자"/>
									<cell bkcolor="user8" col="4" color="user12" display="text" rowspan="2" text="입금금액"/>
									<cell bkcolor="user8" col="5" color="user12" display="text" rowspan="2" text="출금금액"/>
									<cell bkcolor="user8" col="6" color="user12" display="text" rowspan="2" text="잔액"/>
									<cell bkcolor="user8" col="7" color="user12" display="text" rowspan="2" text="업소코드"/>
									<cell bkcolor="user8" col="8" color="user12" display="text" rowspan="2" text="업소명"/>
									<cell bkcolor="user8" col="9" color="user12" colspan="2" display="text" text="납부기간"/>
									<cell bkcolor="user8" col="9" color="user12" display="text" row="1" text="시작년월"/>
									<cell bkcolor="user8" col="10" color="user12" display="text" row="1" text="종료년월"/>
									<cell bkcolor="user8" col="11" color="user12" display="text" rowspan="2" text="삭제"/>
									<cell bkcolor="user8" col="12" color="user12" display="text" rowspan="2" text="자동매칭결과"/>
									<cell bkcolor="user8" col="13" color="user12" display="text" rowspan="2" text="담당직원"/>
								</head>
								<body>
									<cell align="center" col="0" colid="RECV_DAY" display="text" Mask="####-##-##"/>
									<cell align="left" col="1" colid="RECEPT_BANK" display="text"/>
									<cell align="left" col="2" colid="REMAK" display="text"/>
									<cell align="center" col="3" colid="REPTPRES" display="text"/>
									<cell col="4" colid="REPT_AMT" display="number"/>
									<cell col="5" colid="OUT_AMT" display="number"/>
									<cell align="right" col="6" colid="REPT_BALANCE" display="number"/>
									<cell align="center" col="7" colid="UPSO_CD" display="text" edit='expr:iif(getRowtype(currow)==&quot;normal&quot;&#32;&amp;&amp;&#32;length(UPSO_CD)&#32;&gt;&#32;0,&quot;none&quot;,&quot;normal&quot;)'/>
									<cell align="left" col="8" colid="UPSO_NM" display="text"/>
									<cell align="center" col="9" colid="START_YRMN" display="text" Mask="####-##"/>
									<cell align="center" col="10" colid="END_YRMN" display="text" Mask="####-##"/>
									<cell align="center" button3d="false" col="11" colid="UPSO_CD" display="image" expandimage="s_02" expr='iif(length(UPSO_NM)==0,&quot;&quot;,&quot;s_02&quot;)'/>
									<cell align="left" col="12" colid="AUTO_UPSO" display="text"/>
									<cell align="center" col="13" colid="STAFF_NM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Height="21" Id="btn_auto_matching" ImageID="C_btn_120" Left="972" LeftMargin="28" OnClick="tab_REPT_TRANS_btn_auto_matching_OnClick" Style="edit" TabOrder="2" TabStop="FALSE" Text="자동매칭&#32;실행" Top="1" TopMargin="1" Width="121"></Button>
					<Edit Border="Flat" BorderColor="user10" Height="20" Id="edt_auto_err" Left="150" LeftMargin="4" Readonly="TRUE" RightMargin="2" Style="edit" TabOrder="4" TabStop="FALSE" Top="2" Visible="FALSE" Width="816"></Edit>
					<Static Height="16" Id="stt_auto_err" Left="29" Style="tx_left_bold" TabOrder="3" Text="자동매칭&#32;제외&#32;업소" Top="7" Visible="FALSE" Width="120"></Static>
					<Image Height="21" Id="img_auto_err" ImageID="C_icon2" Left="7" TabOrder="5" Top="4" Visible="FALSE" Width="18"></Image>
				</TabPage>
				<TabPage BorderColor="black" Height="326" Id="BRAN_DISTR" ImageID="C_tab2" Left="2" TabOrder="69" Text="센터간&#32;분배" Top="27" Width="1100">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoScrollBar="AlwaysVert" BindDataset="ds_s06_rept_trans01" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="147" ColSizing="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="104" Id="grd_ReptDistr" InputPanel="FALSE" Left="14" LineColor="silver" MinWidth="100" Right="454" RowHeight="20" Style="grid" TabOrder="1" TabStop="FALSE" Top="43" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="440">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="154"/>
									<col width="98"/>
									<col width="80"/>
									<col width="1"/>
								</columns>
								<head>
									<cell bkcolor="user8" col="0" color="user12" display="text" text="영수일"/>
									<cell bkcolor="user8" col="1" color="user12" display="text" text="적&#32;요"/>
									<cell bkcolor="user8" col="2" color="user12" display="text" text="입금자"/>
									<cell bkcolor="user8" col="3" color="user12" display="text" text="입금금액"/>
									<cell col="4" display="text"/>
								</head>
								<body>
									<cell align="center" col="0" colid="RECV_DAY" display="text" Mask="####-##-##"/>
									<cell col="1" colid="REMAK" display="text"/>
									<cell col="2" colid="REPTPRES" display="text"/>
									<cell align="right" col="3" colid="REPT_AMT" display="number"/>
									<cell col="4" colid="BRAN_CD" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoScrollBar="AlwaysVert" BindDataset="ds_s06_rept_trans03" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="301" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="256" Id="grd_ReptTrans" InputPanel="FALSE" Left="494" LineColor="default" MinWidth="100" OnExpandEdit="tab_REPT_BRAN_DISTR_grd_ReptTrans_OnExpandEdit" Right="982" RowHeight="20" Style="grid" TabOrder="2" TabStop="FALSE" Top="45" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="488">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user8" col="0" color="user12" display="text" text="업소코드"/>
									<cell bkcolor="user8" col="1" color="user12" display="text" text="업&#32;소&#32;명"/>
									<cell bkcolor="user8" col="2" color="user12" display="text" text="분배금액"/>
									<cell bkcolor="user8" col="3" color="user12" display="text" text="시작년월"/>
									<cell bkcolor="user8" col="4" color="user12" display="text" text="종료년월"/>
									<cell bkcolor="user8" col="5" color="user12" display="text" text="비고"/>
								</head>
								<body>
									<cell bkcolor="user13" col="0" colid="UPSO_CD" display="text" edit='expr:iif(getRowtype(currow)==&quot;normal&quot;&#32;&amp;&amp;&#32;length(UPSO_CD)&#32;&gt;&#32;0,&quot;none&quot;,&quot;normal&quot;)' expandimage="rbt_search01" expandshow="true" expandsize="18"/>
									<cell bkcolor="user13" col="1" colid="UPSO_NM" display="text"/>
									<cell align="right" bkcolor="user13" col="2" colid="DISTR_AMT" display="number" edit='expr:iif(getRowType(currow)&#32;==&#32;&quot;insert&quot;,&quot;number&quot;,&quot;none&quot;)'/>
									<cell align="center" col="3" colid="START_YRMN" display="date" limit="6" Mask="yyyy/MM"/>
									<cell align="center" col="4" colid="END_YRMN" display="date" limit="6" Mask="yyyy/MM"/>
									<cell col="5" colid="REMAK" display="text" edit='expr:iif(getRowType(currow)&#32;==&#32;&quot;insert&quot;,&quot;normal&quot;,&quot;none&quot;)'/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_AddBran" ImageID="C_btn_90" Left="366" LeftMargin="23" OnClick="tab_REPT_BRAN_DISTR_btn_AddBran_OnClick" Style="edit" TabOrder="3" Text="&#32;&#32;&#32;추&#32;가" Top="155" TopMargin="1" Width="90"></Button>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="26" Id="btn_DelBran" ImageID="C_btn_90" Left="366" LeftMargin="23" OnClick="tab_REPT_BRAN_DISTR_btn_DelBran_OnClick" Style="edit" TabOrder="4" Text="&#32;&#32;&#32;삭&#32;제" Top="179" TopMargin="1" Width="90"></Button>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_AddUpso" ImageID="C_btn_70" Left="762" LeftMargin="23" OnClick="tab_REPT_BRAN_DISTR_btn_AddUpso_OnClick" Style="edit" TabOrder="5" Text="&#32;추&#32;가" Top="11" TopMargin="1" Width="74"></Button>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_DeleteUpso" ImageID="C_btn_70" Left="836" LeftMargin="23" OnClick="tab_REPT_BRAN_DISTR_btn_DeleteUpso_OnClick" Style="edit" TabOrder="6" Text="&#32;삭&#32;제" Top="11" TopMargin="1" Width="74"></Button>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoScrollBar="AlwaysVert" BindDataset="ds_s06_rept_trans02" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="307" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadHeight="23" Height="152" Id="grd_rept_trans" InputPanel="FALSE" Left="14" LineColor="default" MinWidth="100" OnCellClick="tab_REPT_BRAN_DISTR_grd_rept_trans_OnCellClick" Right="350" RowHeight="20" Style="grid" TabOrder="7" TabStop="FALSE" Top="155" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="336">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="80"/>
									<col width="150"/>
								</columns>
								<head>
									<cell bkcolor="user8" col="0" color="user12" display="text" text="센터"/>
									<cell bkcolor="user8" col="1" color="user12" display="text" text="분배금액"/>
									<cell bkcolor="user8" col="2" color="user12" display="text" text="비고"/>
								</head>
								<body>
									<cell bkcolor="user13" col="0" colid="RECV_BRAN_CD" combocol="GIBU" combodataset="ds_GIBU_CD" combotext="DEPT_NM" display="combo" edit="combo"/>
									<cell align="right" bkcolor="user13" col="1" colid="DISTR_AMT" display="number" edit="number"/>
									<cell align="left" col="2" colid="REMAK" display="text" edit="normal"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_saveBran" ImageID="C_btn_90" Left="366" LeftMargin="23" OnClick="tab_REPT_BRAN_DISTR_btn_saveBran_OnClick" Style="edit" TabOrder="8" Text="&#32;&#32;&#32;저&#32;장" Top="203" TopMargin="1" Width="90"></Button>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_SaveUpso" ImageID="C_btn_70" Left="910" LeftMargin="23" OnClick="tab_REPT_BRAN_DISTR_btn_SaveUpso_OnClick" Style="edit" TabOrder="9" Text="&#32;저&#32;장" Top="11" TopMargin="1" Width="74"></Button>
					<Static Color="user1" Height="15" Id="Static1" Left="37" Style="tx_bold" TabOrder="10" Text="센터간&#32;분배&#32;정보" Top="19" Width="105"></Static>
					<Image Height="21" Id="Image0" ImageID="C_icon2" Left="13" TabOrder="11" Top="16" Width="18"></Image>
					<Static Color="user1" Height="15" Id="Static2" Left="517" Style="tx_bold" TabOrder="12" Text="업소&#32;매핑&#32;정보" Top="19" Width="97"></Static>
					<Image Height="21" Id="Image1" ImageID="C_icon2" Left="493" TabOrder="13" Top="16" Width="18"></Image>
				</TabPage>
				<TabPage BorderColor="black" Height="326" Id="UPSO_DISTR" ImageID="C_tab2" Left="2" TabOrder="69" Text="업소간&#32;분배" Top="27" Width="1100">
					<Shape BKColor="user7" Bottom="760" Height="3" Id="Shape2" Left="17" LineColor="user7" Right="1025" TabOrder="5" Top="757" Type="Rectangle" Width="1008"></Shape>
					<Shape BKColor="user7" Bottom="-76" Height="3" Id="Shape4" Left="0" LineColor="user7" Right="1009" TabOrder="2" Top="-79" Type="Rectangle" Width="1009"></Shape>
					<Grid AutoEnter="TRUE" BindDataset="ds_s06_reptupso01" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="293" ColSizing="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="250" Id="grd_ReptDistr" InputPanel="FALSE" Left="14" LineColor="silver" Right="454" RowHeight="20" Style="grid" TabOrder="1" TabStop="FALSE" Top="43" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="440">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="158"/>
									<col width="90"/>
									<col width="90"/>
								</columns>
								<head>
									<cell bkcolor="user8" col="0" color="user12" display="text" text="영수일"/>
									<cell bkcolor="user8" col="1" color="user12" display="text" text="적&#32;요"/>
									<cell bkcolor="user8" col="2" color="user12" display="text" text="입금자"/>
									<cell bkcolor="user8" col="3" color="user12" display="text" text="입금금액"/>
								</head>
								<body>
									<cell align="center" col="0" colid="RECV_DAY" display="text" Mask="####-##-##"/>
									<cell col="1" colid="REMAK" display="text"/>
									<cell col="2" colid="REPTPRES" display="text"/>
									<cell align="right" col="3" colid="REPT_AMT" display="number"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" BindDataset="ds_s06_reptupso02" BkColor2="user11" BkSelColor="user9" BoldHead="true" Border="Flat" Bottom="293" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="user8" HeadHeight="23" Height="250" Id="grd_ReptTrans" InputPanel="FALSE" Left="494" LineColor="silver" OnExpandEdit="tab_REPT_UPSO_DISTR_grd_ReptTrans_OnExpandEdit" Right="982" RowHeight="20" Style="grid" TabOrder="2" TabStop="FALSE" Top="43" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="488">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user8" col="0" color="user12" display="text" text="업소코드"/>
									<cell bkcolor="user8" col="1" color="user12" display="text" text="업&#32;소&#32;명"/>
									<cell bkcolor="user8" col="2" color="user12" display="text" text="분배금액"/>
									<cell bkcolor="user8" col="3" color="user12" display="text" text="시작년월"/>
									<cell bkcolor="user8" col="4" color="user12" display="text" text="종료년월"/>
									<cell bkcolor="user8" col="5" color="user12" display="text" text="비고"/>
								</head>
								<body>
									<cell bkcolor="user13" col="0" colid="UPSO_CD" display="text" edit='expr:iif(getRowtype(currow)==&quot;normal&quot;&#32;&amp;&amp;&#32;length(UPSO_CD)&#32;&gt;&#32;0,&quot;none&quot;,&quot;normal&quot;)' expandimage="rbt_search01" expandshow="true" expandsize="18"/>
									<cell bkcolor="user13" col="1" colid="UPSO_NM" display="text"/>
									<cell align="right" bkcolor="user13" col="2" colid="DISTR_AMT" display="number" edit='expr:iif(getRowType(currow)&#32;==&#32;&quot;insert&quot;,&quot;number&quot;,&quot;none&quot;)'/>
									<cell align="center" col="3" colid="START_YRMN" display="text" limit="6" Mask="####-##"/>
									<cell align="center" col="4" colid="END_YRMN" display="text" limit="6" Mask="####-##"/>
									<cell col="5" colid="REMAK" display="text" edit='expr:iif(getRowType(currow)&#32;==&#32;&quot;insert&quot;,&quot;normal&quot;,&quot;none&quot;)'/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_DeleteUpso" ImageID="C_btn_70" Left="836" LeftMargin="23" OnClick="tab_REPT_UPSO_DISTR_btn_DeleteUpso_OnClick" Style="edit" TabOrder="3" Text="&#32;삭&#32;제" Top="11" TopMargin="1" Width="74"></Button>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_SaveUpso" ImageID="C_btn_70" Left="910" LeftMargin="23" OnClick="tab_REPT_UPSO_DISTR_btn_SaveUpso_OnClick" Style="edit" TabOrder="4" Text="&#32;저&#32;장" Top="11" TopMargin="1" Width="74"></Button>
					<Button ButtonStyle="TRUE" Enable="FALSE" Height="22" Id="btn_AddUpso" ImageID="C_btn_70" Left="762" LeftMargin="23" OnClick="tab_REPT_UPSO_DISTR_btn_AddUpso_OnClick" Style="edit" TabOrder="7" Text="&#32;추&#32;가" Top="11" TopMargin="1" Width="74"></Button>
					<Image Height="21" Id="Image3" ImageID="C_icon2" Left="13" TabOrder="9" Top="16" Width="18"></Image>
					<Static Color="user1" Height="15" Id="Static6" Left="37" Style="tx_bold" TabOrder="8" Text="업소간&#32;분배&#32;정보" Top="19" Width="113"></Static>
					<Image Height="21" Id="Image0" ImageID="C_icon2" Left="493" TabOrder="11" Top="16" Width="18"></Image>
					<Static Color="user1" Height="15" Id="Static1" Left="517" Style="tx_bold" TabOrder="10" Text="업소&#32;매핑&#32;정보" Top="19" Width="97"></Static>
				</TabPage>
			</Contents>
		</Tab>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static2" Left="702" Style="box_tx" TabOrder="38" Text="신규일자" Top="282" VAlign="Middle" Width="90"></Static>
		<Static Height="10" Id="Static3" Left="410" TabOrder="41" Text="~" Top="25" Width="15"></Static>
		<Static Height="19" Id="Static14" Left="896" Style="tx_left_bold" TabOrder="43" Text="등록일" Top="25" Visible="FALSE" Width="40"></Static>
		<Image Height="11" Id="Image1" ImageID="C_icon" Left="880" TabOrder="24" TabStop="FALSE" Top="25" Visible="FALSE" Width="11"></Image>
		<Calendar BindDataset="ds_s06_upso_search" BKColor="user13" Border="Flat" BorderColor="user10" Column="START_DAY" Dateformat="yyyy/MM/dd" FocusIndex="0" Height="20" Id="cal_START_DAY" Left="307" LeftMargin="6" MonthPickerFormat="yyyy년&#32;MM월" OnChanged="cal_OnChanged" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="2" ToolTipText="기간(from)" Top="20" Width="100"></Calendar>
		<Calendar BindDataset="ds_s06_upso_search" BKColor="user13" Border="Flat" BorderColor="user10" Column="END_DAY" Dateformat="yyyy/MM/dd" FocusIndex="0" Height="20" Id="cal_END_DAY" Left="423" LeftMargin="6" MonthPickerFormat="yyyy년&#32;MM월" OnChanged="cal_OnChanged" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="3" ToolTipText="기간(to)" Top="20" Width="100"></Calendar>
		<Calendar BindDataset="ds_s06_upso_search" Border="Flat" BorderColor="user10" Column="REPT_DAY" Dateformat="yyyy/MM/dd" FocusIndex="0" Height="20" Id="cal_REPT_DAY" Left="948" LeftMargin="6" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="27" TabStop="FALSE" ToolTipText="등록일" Top="20" Visible="FALSE" Width="100"></Calendar>
		<Image Height="11" Id="Image3" ImageID="C_icon" Left="552" TabOrder="48" TabStop="FALSE" Top="25" Width="11"></Image>
		<Static Height="19" Id="Static0" Left="568" Style="tx_left_bold" TabOrder="49" Text="계좌번호" Top="25" Width="52"></Static>
		<Combo Border="Flat" BorderColor="user3" CodeColumn="ACCN_NUM" DataColumn="BANK_NM" Height="20" Id="cob_ACCN_NUM" InnerDataset="ds_s06_banklist" Left="624" TabOrder="47" Top="20" Width="216"></Combo>
		<Static Color="red" Font="굴림,9,Bold" Height="31" Id="Static11" Left="354" TabOrder="50" Text="고소입금은&#32;&apos;업소입금등록&apos;에서&#32;하시기&#32;바랍니다.&#13;&#10;업소삭제&#32;후&#32;꼭&#32;저장한후&#32;다른&#32;입금&#32;작업을&#32;하세요." Top="398" Width="328"></Static>
		<Static Align="Center" BKColor="user18" Border="Flat" Font="굴림,9,Bold" Height="26" Id="Static15" Left="702" Style="box_tx" TabOrder="52" Text="더넣은금액" Top="307" VAlign="Middle" Width="90"></Static>
		<Shape BKColor="white" Bottom="108" Height="26" Id="Shape0" Left="791" LineColor="user3" Right="1097" TabOrder="54" Top="82" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="133" Height="26" Id="Shape4" Left="791" LineColor="user3" Right="1097" TabOrder="55" Top="107" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="158" Height="26" Id="Shape5" Left="791" LineColor="user3" Right="1097" TabOrder="56" Top="132" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="183" Height="26" Id="Shape6" Left="791" LineColor="user3" Right="1097" TabOrder="57" Top="157" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="208" Height="26" Id="Shape7" Left="791" LineColor="user3" Right="1097" TabOrder="58" Top="182" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="233" Height="26" Id="Shape8" Left="791" LineColor="user3" Right="1097" TabOrder="59" Top="207" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="258" Height="26" Id="Shape9" Left="791" LineColor="user3" Right="1097" TabOrder="60" Top="232" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="283" Height="26" Id="Shape10" Left="791" LineColor="user3" Right="1097" TabOrder="61" Top="257" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="308" Height="26" Id="Shape11" Left="791" LineColor="user3" Right="1097" TabOrder="62" Top="282" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="333" Height="26" Id="Shape12" Left="791" LineColor="user3" Right="1097" TabOrder="63" Top="307" Type="Rectangle" Width="306"></Shape>
		<Shape BKColor="white" Bottom="381" Height="49" Id="Shape13" Left="791" LineColor="user3" Right="1097" TabOrder="64" Top="332" Type="Rectangle" Width="306"></Shape>
		<Calendar BindDataset="ds_s06_upso" Border="Flat" BorderColor="user3" Column="NEW_DAY" Dateformat="yyyy/MM/dd" DayStyle="edit" EditAlign="CENTER" Enable="FALSE" Height="22" Id="cal_NEW_DAY" Left="796" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="15" TabStop="FALSE" Top="284" Width="122"></Calendar>
		<Calendar BindDataset="ds_s06_upso" Border="Flat" BorderColor="user3" Column="OPBI_DAY" Dateformat="yyyy/MM/dd" DayStyle="edit" EditAlign="CENTER" Enable="FALSE" Height="22" Id="cal_OPBI_DAY" Left="796" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="13" TabStop="FALSE" Top="259" Width="122"></Calendar>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="MNGEMSTR_NM" Enable="FALSE" Height="22" Id="edt_MNGEMSTR_NM" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="5" TabStop="FALSE" Top="109" Width="183"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="STAFF_NM" Enable="FALSE" Height="22" Id="edt_STAFF_NM" Left="864" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="6" TabStop="FALSE" Top="134" Width="115"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="ACMCN_DAESU" Enable="FALSE" Height="22" Id="edt_ACMCN_DAESU" Left="796" LeftMargin="4" MaxLength="10" Number="TRUE" RightMargin="2" Style="edit" TabOrder="8" TabStop="FALSE" Top="159" Width="183"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="STAFF_CD" Enable="FALSE" Height="22" Id="edt_STAFF_CD" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="9" TabStop="FALSE" Top="134" Width="67"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="GRADNM" Enable="FALSE" Height="22" Id="edt_GRADNM" Left="864" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="10" TabStop="FALSE" Top="184" Width="115"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="GRAD" Enable="FALSE" Height="22" Id="edt_GRAD" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="11" TabStop="FALSE" Top="184" Width="67"></Edit>
		<MaskEdit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user3" Column="MONPRNCFEE" Enable="FALSE" Height="22" Id="mae_MONPRNCFEE" Left="796" MaxLength="10" TabOrder="12" TabStop="FALSE" Top="234" Width="183"></MaskEdit>
		<Button BKColor="tomato" Color="white" Font="굴림,11,Bold" Height="21" Id="btn_claim" Left="867" OnClick="btn_claim_OnClick" TabOrder="23" TabStop="FALSE" Text="채권의뢰" Top="58" Visible="FALSE" Width="78"></Button>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="UPSO_NM" Enable="FALSE" Height="22" Id="edt_UPSO_NM" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="25" TabStop="FALSE" Top="84" Width="212"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="UPSO_CD" Enable="FALSE" Height="22" Id="edt_UPSO_CD" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="26" TabStop="FALSE" Top="59" Width="67"></Edit>
		<Button BKColor="tomato" Color="white" Font="굴림,11,Bold" Height="21" Id="btn_accu" Left="947" OnClick="btn_accu_OnClick" TabOrder="51" TabStop="FALSE" Text="고소중" Top="58" Visible="FALSE" Width="60"></Button>
		<MaskEdit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user3" Column="MONPRNCFEE2" Enable="FALSE" Height="22" Id="mae_MONPRNCFEE2" Left="796" MaxLength="10" TabOrder="53" TabStop="FALSE" Top="209" Width="183"></MaskEdit>
		<MaskEdit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user3" Column="BALANCE" Enable="FALSE" Height="22" Id="MaskEdit0" Left="796" MaxLength="10" TabOrder="22" TabStop="FALSE" Top="309" Width="183"></MaskEdit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="UPSO_ADDR1" Enable="FALSE" Height="22" Id="Edit4" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="4" TabStop="FALSE" Top="334" Width="296"></Edit>
		<Edit BindDataset="ds_s06_upso" Border="Flat" BorderColor="user10" Column="UPSO_ADDR2" Enable="FALSE" Height="22" Id="Edit0" Left="796" LeftMargin="4" RightMargin="2" Style="edit" TabOrder="17" TabStop="FALSE" Top="357" Width="296"></Edit>
	</Form>
	<Script><![CDATA[#include "script::common.js"  		// 공통 js
#include "script::commonGibu.js"  	// 센터 공통 js

var bran_distr_MAPPING_DAY;
var upso_distr_MAPPING_DAY;

var NESS_AMT = 0;	// 필요금액 
var NEXT_AMT = 0;	// 다음달 금액

function form_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);

	// 센터코드 가져오기
	gfn_GetDataGIBU_CD(this.cob_BRAN_CD, 1);

	var yyyy = substr(getDate(), 0, 4);
	this.grd_UPSO_REPT.SetCellProp("head", 2, "text", yyyy);
	this.grd_UPSO_REPT.SetCellProp("head", 1, "text", parseInt(yyyy) - 1);
	this.cal_START_DAY.Text = today();
	this.cal_END_DAY.Text = today();
	this.cal_REPT_DAY.Text = today();

	gfn_SetPermission(this.cob_BRAN_CD.Value);

	this.ds_s06_AccnNumIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
	this.ds_s06_AccnNumIn.SetColumn(0, "USE_TYPE", gfn_GetAccountUsage("03"));	
	gfn_syncCall("find_account","KOMCA?SYSID=PATHFINDER&MENUID=1000001006007&EVENTID=accn_num_select","S=ds_s06_AccnNumIn","ds_s06_bankList=SEL1","","fn_CallBack");
	this.cob_ACCN_NUM.Index = 0;

/*
	gfn_SetInnerPermission("tab_REPT.BRAN_DISTR.btn_AddBran,tab_REPT.BRAN_DISTR.btn_DelBran,tab_REPT.BRAN_DISTR.btn_saveBran");
	gfn_SetInnerPermission("tab_REPT.BRAN_DISTR.btn_AddUpso,tab_REPT.BRAN_DISTR.btn_DeleteUpso,tab_REPT.BRAN_DISTR.btn_SaveUpso");
	gfn_SetInnerPermission("tab_REPT.UPSO_DISTR.btn_AddUpso,tab_REPT.UPSO_DISTR.btn_DeleteUpso,tab_REPT.UPSO_DISTR.btn_SaveUpso");
*/
}

/*
	공통버튼 컨트롤
*/
function fn_CommmonButtonClick(strCode){

    //신규
    if(strCode == "NEW"){
		fn_New();
    }
    //조회
    else if(strCode == "SEARCH"){
		fn_Search();
    }
    //저장
    else if(strCode == "SAVE"){
		fn_Save();
    }
    //삭제
    else if(strCode == "DELETE"){
		fn_Delete();
    }
    //Excel
    else if(strCode == "EXCEL"){
		fn_Excel();
    }
    //출력
    else if(strCode == "PRINT"){
		fn_Print();
    }
    //닫기
    else if(strCode == "CLOSE"){
        close();
    }
	return;
}

function fn_New() {
	tab_REPT.TRANS.grd_ReptTrans.SetCellProp("head",1,"dddd");
}
//조회
function fn_Search() 
{
	NESS_AMT = 0;	// 필요금액 
	NEXT_AMT = 0;	// 다음달 금액
	
	// 입력 필수 항목 검사;
	if (!gfn_CheckFormNull(this)) return;

	// 센터분배의 경우 계좌번호는 조회조건이 아님
	if (this.tab_REPT.TabIndex == 1) {
		this.ds_s06_upso_search.SetColumn(0, "ACCN_NUM", "");
	}
	// 계좌번호 조회조건 추가
	else {
		this.ds_s06_upso_search.SetColumn(0, "ACCN_NUM", this.cob_ACCN_NUM.Value);
	}
	
	// 무통장 입금내역 조회
    gfn_syncCall("rept_bankbook_select","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_bankbook_select","S=ds_s06_upso_search","ds_s06_bankbook=SEL1","","fn_CallBack");
    //센터간 분배 조회
    gfn_syncCall("rept_distr_select","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_select","S=ds_s06_upso_search","ds_s06_rept_trans01=SEL1","","fn_CallBack");
    //무통장 입금 업소 분배조회
    gfn_syncCall("rept_bran_distr_select","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_bran_distr_select","S=ds_s06_upso_search","ds_s06_reptupso01=SEL1","","fn_CallBack");

    ds_s06_bankbook_OnRowPosChanged();
}
//저장
function fn_Save() 
{
	var isViewMsg = false;
	var isErr = false;

	//  입금 마감 확인
	this.ds_s06_closingIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
	this.ds_s06_closingIn.SetColumn(0, "REPT_DAY", today());
	gfn_syncCall("rept_closing","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_closing","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
	
	if(ds_s06_closingYn.GetColumn(0, "CNT") != "0"){
		gfn_Confirm("MB_OK", "해당기간중 마감내역이 존재합니다. 마감내역을 확인하세요.", "경고", "0");
		return;
	}
	
	if(tab_REPT.TabIndex == 0) {
		for (var i=0; i<this.ds_s06_bankbook.count; i++) {
			if ((this.ds_s06_bankbook.GetRowType(i) == "update" || this.ds_s06_bankbook.GetRowType(i) == "insert") &&
				length(this.ds_s06_bankbook.GetColumn(i, "UPSO_CD")) > 0) {
				if (length(this.ds_s06_bankbook.GetColumn(i, "END_YRMN")) == 0) {
					
					if (!isViewMsg) {
						// 사용자 경고 메시지 처리
						gfn_Confirm("MB_OK", "입금액이 월정료보다 작은 경우 더 넣은금액으로 처리됩니다.", "경고", "0");
						isViewMsg = true;
					}
				}

				if (this.ds_s06_bankbook.GetColumn(i, "DEMD_MMCNT") == "-1") {
					// 사용자 경고 메시지 처리
					gfn_Confirm("MB_OK", "잘못된 매핑내역입니다.\n업소코드 : " + this.ds_s06_bankbook.GetColumn(i, "UPSO_CD"), "경고", "0");
					isErr = true;
					break;
				}

				if (length(this.ds_s06_bankbook.GetColumn(i, "UPSO_NM")) == 0) {
					// 사용자 경고 메시지 처리
					gfn_Confirm("MB_OK", "잘못된 매핑내역입니다.\n업소코드 : " + this.ds_s06_bankbook.GetColumn(i, "UPSO_CD"), "경고", "0");
					isErr = true;
					break;
				}
			}
		}
		
		if (!isErr) { 
			//trace(ds_s06_bankbook.SaveXML("ds_s06_bankbook", "U") );		
			//trace("일반 업소 매칭 풀어");
			gfn_syncCall("rept_bankbook_insert","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_bankbook_insert_imsi","S=ds_s06_bankbook:U","ds_s06_error=SEL10","","fn_CallBack",gv_TraceLog,GV_FORMID);
			
			if(ds_s06_error.count > 0){
				gfn_Confirm("MB_OK", ds_s06_error.GetColumn(ds_s06_error.count-1,"ERR_CTENT"), "오류", "0");
				return;
			}
		}
	}
}

function fn_Excel() {
	 if(ds_s06_bankbook.count== 0){
        gfn_Confirm("MB_OK", "Excel로 출력할 데이터가 없습니다.", "경고", "0");
        return;
    }
	this.tab_REPT.TRANS.grd_ReptTrans.ExportExcelEX("무동장입금등록");
}

function fn_Delete() {}
function fn_Print() {}

function fn_CallBack(srvId,ErrorCode,ErrorMsg)
{
	
	if(ErrorCode < 0) {
		//에러 공통 팝업
		gfn_SetErrorPop(ErrorCode,ErrorMsg);
	}
	if(srvId == "rept_distr_insert"){
	    if(length(ErrorMsg) > 0){
            gfn_Confirm("MB_OK", ErrorMsg, "오류", "0");
			
			var nRow = ds_s06_rept_trans01.currow;
			ds_s06_upso_search02.SetColumn(0,"REPT_DAY" , ds_s06_rept_trans01.GetColumn(nRow,"REPT_DAY"));
			ds_s06_upso_search02.SetColumn(0,"REPT_NUM" , ds_s06_rept_trans01.GetColumn(nRow,"REPT_NUM"));    
			ds_s06_upso_search02.SetColumn(0,"BRAN_CD"  , ds_s06_rept_trans01.GetColumn(nRow,"BRAN_CD"));    
			ds_s06_upso_search02.SetColumn(0,"START_DAY", this.cal_START_DAY.Value);    
			ds_s06_upso_search02.SetColumn(0,"END_DAY"  , this.cal_END_DAY.Value);
		
			gfn_syncCall("rept_distr_select02","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_select","S=ds_s06_upso_search02","ds_s06_rept_trans02=MRG2","","fn_CallBack");
	    }
	}
	else if(srvId == "rept_bran_distr_select"){
	    ds_s06_reptupso01_OnRowPosChanged();

	    if(ds_s06_reptupso01.count == 0){
	        tab_REPT.UPSO_DISTR.btn_AddUpso.Enable = false;
	        tab_REPT.UPSO_DISTR.btn_DeleteUpso.Enable = false;
            tab_REPT.UPSO_DISTR.btn_SaveUpso.Enable = false;
	    }
	    else{
	        tab_REPT.UPSO_DISTR.btn_AddUpso.Enable = true;
	        tab_REPT.UPSO_DISTR.btn_DeleteUpso.Enable = true;
            tab_REPT.UPSO_DISTR.btn_SaveUpso.Enable = true;
	    }	
	}
	else if(srvId == "rept_distr_select"){
	    ds_s06_rept_trans01_OnRowPosChanged();
	}
	else if(srvId == "rept_distr_select02"){
	    ds_s06_rept_trans02_OnRowPosChanged();
	}
	else if (srvId == "rept_bran_distr_select02") {
		
	}
	else if (srvId == "rept_upso_distr_insert") {
	     if(length(ErrorMsg) > 0){
            gfn_Confirm("MB_OK", ErrorMsg, "오류", "0");
	    }
	    
	    fn_Search();
	}
	else if(srvId == "rept_bankbook_insert"){
	     if(length(ErrorMsg) > 0){
            gfn_Confirm("MB_OK", ErrorMsg, "오류", "0");
	    }
	    
	    fn_Search();
	}
}

function fn_GetReptInfo(UPSO_CD, UPSO_NM)
{
	var dsTmp = null;
	var CHK_RECV_DAY = "";
	
	if      (this.tab_REPT.TabIndex == 0) {
		dsTmp = this.ds_s06_bankbook;
		CHK_RECV_DAY = ds_s06_bankbook.GetColumn(ds_s06_bankbook.currow, "RECV_DAY");
	}
	else if (this.tab_REPT.TabIndex == 1) {
		dsTmp = this.ds_s06_rept_trans03;
		CHK_RECV_DAY = ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "RECV_DAY");
	}
	else if (this.tab_REPT.TabIndex == 2) {
		dsTmp = this.ds_s06_reptupso02;
		CHK_RECV_DAY = ds_s06_reptupso01.GetColumn(ds_s06_reptupso01.currow, "RECV_DAY");
	}
	else	return;

	this.ds_s06_upso_search.SetColumn(0, "UPSO_CD"   , UPSO_CD);
	this.ds_s06_upso_search.SetColumn(0, "BRAN_CD"   , cob_BRAN_CD.Value);
	this.ds_s06_upso_search.SetColumn(0, "YEAR"      , substr(getDate(), 0, 4));
	
	if (this.tab_REPT.TabIndex == 0) {
		this.ds_s06_upso_search.SetColumn(0, "REPT_AMT", dsTmp.GetColumn(dsTmp.currow, "REPT_AMT"));
	}
	else {
		var DISTR_AMT = dsTmp.GetColumn(dsTmp.currow, "DISTR_AMT");
		if (length(DISTR_AMT) == 0)  DISTR_AMT = "0";
		this.ds_s06_upso_search.SetColumn(0, "REPT_AMT", DISTR_AMT);
	}
	
	this.ds_s06_upso_search.SetColumn(0, "RECV_DAY", CHK_RECV_DAY);
	
	// findUpso popup 창에서 호출하는 경우의 처리
	if (length(UPSO_NM) > 0) {//TRACE(ds_s06_upso_search.SAVEXML());
		gfn_syncCall("UPSO_REPT","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_detail","S=ds_s06_upso_search","ds_s06_ReptIn=SEL1 ds_s06_upso=SEL2 ds_s06_DemdInfo=SEL3 ds_s06_AccuInfo=SEL4","","fn_CallBack");
		
		if 	(this.ds_s06_AccuInfo.rowcount > 0) {	btn_accu.Visible = true;	}
		else {	btn_accu.Visible = false;	}
	
		if 	(this.ds_s06_upso.GetColumn(0, "CLAIM_YN") == "Y") {	btn_claim.Visible = true;	}
		else {	btn_claim.Visible = false;	}//TRACE(ds_s06_DemdInfo.SAVEXML());
		// 기간 설정
		if (this.ds_s06_upso.rowcount > 0) {
			// 고소업소인 경우에는 무통장입금에서 입금할수 없다. 2010.05.28
			if(this.ds_s06_AccuInfo.rowcount>0){
				gfn_Confirm("MB_OK", "고소된 업소입니다. 업소입금등록 에서 입금처리하시기 바랍니다.", "경고", "0");
				
				dsTmp.SetColumn(dsTmp.currow, "NOTE_YRMN" , dsTmp.GetColumn(dsTmp.currow, "END_YRMN"));
				dsTmp.SetColumn(dsTmp.currow, "UPSO_CD"   , "");
				dsTmp.SetColumn(dsTmp.currow, "UPSO_NM"   , "");
				dsTmp.SetColumn(dsTmp.currow, "START_YRMN", "");
				dsTmp.SetColumn(dsTmp.currow, "END_YRMN"  , "");
				dsTmp.SetColumn(dsTmp.currow, "DEMD_MMCNT", null);
				dsTmp.SetColumn(dsTmp.currow, "BALANCE"   , null);
				if (this.tab_REPT.TabIndex == 0) {dsTmp.SetColumn(dsTmp.currow, "STAFF_NM", "");}
				
				return;
			}
		
			
			dsTmp.SetColumn(dsTmp.currow, "UPSO_CD"   , UPSO_CD);
			dsTmp.SetColumn(dsTmp.currow, "UPSO_NM"   , UPSO_NM);
			dsTmp.SetColumn(dsTmp.currow, "START_YRMN", this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"));
			dsTmp.SetColumn(dsTmp.currow, "END_YRMN"  , this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
			dsTmp.SetColumn(dsTmp.currow, "DEMD_MMCNT", this.ds_s06_DemdInfo.GetColumn(0, "DEMD_MMCNT"));
			dsTmp.SetColumn(dsTmp.currow, "NOTE_YRMN" , substr(this.ds_s06_upso.GetColumn(0, "LAST_YRMN"), 0, 6));
			if (this.tab_REPT.TabIndex == 0) {dsTmp.SetColumn(dsTmp.currow, "STAFF_NM", this.ds_s06_upso.GetColumn(0, "STAFF_NM"));}

			var reptAmt  = toInteger(dsTmp.GetColumn(dsTmp.currow, "REPT_AMT"));
			var demdAmt  = toInteger(this.ds_s06_DemdInfo.GetColumn(0, "DEMD_AMT"));
			var cbalance = toInteger(this.ds_s06_upso.GetColumn(0, "BALANCE"));
			
			var C_BALANCE;
			
			if(this.ds_s06_AccuInfo.rowcount>0){
				C_BALANCE = 0;
				dsTmp.SetColumn(dsTmp.currow, "BALANCE", 0);
			}else{
				// 원장 처리 가능한 경우
				if (length(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN")) > 0) {
					C_BALANCE = reptAmt - demdAmt;
					dsTmp.SetColumn(dsTmp.currow, "BALANCE", (reptAmt - demdAmt));
				}
				// 입금액이 작아서 원장 처리 불가능한 경우
				else {
						C_BALANCE = reptAmt + cbalance;
						
						dsTmp.SetColumn(dsTmp.currow, "BALANCE", reptAmt + cbalance);
				}
			}

			if(C_BALANCE > 0){
				if (length(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN")) > 0) {
					fn_GetNextUseAmt(UPSO_CD, this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), addMonth(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"),1), CHK_RECV_DAY);
				}else{
					fn_GetNextUseAmt(UPSO_CD, this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), CHK_RECV_DAY);
				}
				
				//var NEXT_AMT = toInteger(this.ds_s06_NextAmt.GetColumn(0, "TOT_DEMD_AMT"));

				//그 다음달이 폐업인 경우에는 NEXT_AMT 가 현재 입금 기간과 청구금액이 같기 때문에 NEXX_AMT 정보가 0이다.
				if(NEXT_AMT == 0){
					NESS_AMT = 0;
				}else{
					NESS_AMT = NEXT_AMT - reptAmt;
				}
				dsTmp.SetColumn(dsTmp.currow, "NESS_AMT", NESS_AMT);
			}else{
				dsTmp.SetColumn(dsTmp.currow, "NESS_AMT", 0);
			}
			//TRACE("일반 입금 NESS_AMT :"+NESS_AMT);
		}
	}
	// bra04_s06 내에서 호출하는 경우
	else {
		if (length(UPSO_CD) == 0) {
			this.ds_s06_ReptIn.ClearData();
			this.ds_s06_upso.ClearData();
			this.ds_s06_AccuInfo.ClearData();
		}
		else {
			// 업소코드란에 직접 입력해서 엔터쳤을 경우 호출된다. 
			//trace(ds_s06_upso_search.SaveXML());
			gfn_syncCall("rept_detail","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_detail","S=ds_s06_upso_search","ds_s06_ReptIn=SEL1 ds_s06_upso=SEL2 ds_s06_AccuInfo=SEL4", "", "fn_CallBack");
			trace(ds_s06_upso.SaveXML() );
		}
	}

	if 	(this.ds_s06_AccuInfo.rowcount > 0) {	btn_accu.Visible = true;	}
		else {	btn_accu.Visible = false;	}
	
		if 	(this.ds_s06_upso.GetColumn(0, "CLAIM_YN") == "Y") {	btn_claim.Visible = true;	}
		else {	btn_claim.Visible = false;	}
//trace(this.ds_s06_upso.SaveXML() );	
}

// 입금하고자 하는 기간의 다음달까지의 청구금액을 계산한다.
function fn_GetNextUseAmt(UPSO_CD, startYRMN, endYRMN, CHK_RECV_DAY)
{
	//trace("UPSO_CD:"+UPSO_CD+",startYRMN:"+startYRMN+",endYRMN:"+endYRMN+",CHK_RECV_DAY:"+CHK_RECV_DAY);
	// ----------NEXT_AMT를 구하기 전에 END_YRMN (<===입금하고자하는 end_yrmn +1) 된 값 이 휴업 또는 폐업인지 체크한다. 2010.05.14
	this.ds_s06_chk_yrmn.ClearData();
	this.ds_s06_chk_yrmn.AddRow();
	
	this.ds_s06_chk_yrmn.SetColumn(0, "END_YRMN"  , endYRMN);
	this.ds_s06_chk_yrmn.SetColumn(0, "UPSO_CD"  , this.edt_UPSO_CD.Text);
	//TRACE(ds_s06_chk_yrmn.SaveXML());
	gfn_syncCall("chk_closed_yrmn","KOMCA?SYSID=PATHFINDER&MENUID=1000001006007&EVENTID=chk_closed_yrmn","S=ds_s06_chk_yrmn","ds_s06_chk_yrmn_result=MRG5","","fn_CallBack");
	//TRACE(ds_s06_chk_yrmn_result.SaveXML());
	var CHK_CLOSED_YRMN = this.ds_s06_chk_yrmn_result.GetColumn(0, "END_YRMN");
	
	// 입금하고자 하는 기간에 폐업이라면 
	if(this.ds_s06_chk_yrmn_result.GetColumn(0, "REPT_GBN") == "14"){
		NEXT_AMT = 0;
	}else{
		endYRMN = this.ds_s06_chk_yrmn_result.GetColumn(0, "END_YRMN");
		//trace("새로구한 END_YRMN : "+endYRMN);
		//-------------------------------------------------------------------------------------------

		this.ds_s06_ReptIn2.ClearData();
		this.ds_s06_ReptIn2.AddRow();
		this.ds_s06_ReptIn2.SetColumn(0, "BRAN_CD"   , this.cob_BRAN_CD.Value);
		this.ds_s06_ReptIn2.SetColumn(0, "UPSO_CD"   , UPSO_CD);
		this.ds_s06_ReptIn2.SetColumn(0, "START_YRMN", startYRMN);
		this.ds_s06_ReptIn2.SetColumn(0, "END_YRMN"  , endYRMN);
		this.ds_s06_ReptIn2.SetColumn(0, "DEMD_GBN"  , "O");
		
		// 추가 2010.05.13
		this.ds_s06_ReptIn2.SetColumn(0, "RECV_DAY"  , CHK_RECV_DAY);
		//trace("CHK_RECV_DAY:"+CHK_RECV_DAY);
			
		this.ds_s06_NextAmt.ClearData();
	
		//trace(ds_s06_ReptIn2.SaveXML() );
		gfn_syncCall("GET_USEAMT","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001010&EVENTID=rept_demd_amt","S=ds_s06_ReptIn2","ds_s06_NextAmt=SEL3","","fn_CallBack");
		//trace(ds_s06_NextAmt.SaveXML() );
		//NEXT_AMT = toInteger(this.ds_s06_NextAmt.GetColumn(0, "TOT_DEMD_AMT "));
		
		NEXT_AMT = toInteger(this.ds_s06_NextAmt.GetColumn(0, "TOT_USE_AMT")) + toInteger(this.ds_s06_NextAmt.GetColumn(0, "TOT_ADDT_AMT"));
	}
	//trace("최종 NEXT_AMT : "+NEXT_AMT);
}

function fn_GetUpsoInfo()
{
	var BRAN_CD = this.cob_BRAN_CD.Value;	
	var gv_BRAN_CD = gds_sessioninfo.GetColumn(0, "BRAN_CD"); 
	
	//김은정, 조정환, 류선희 허용
	if (gv_BRAN_CD != "AL" && BRAN_CD != gv_BRAN_CD && gv_USER_ID != "K150009" && gv_USER_ID != "K095005" && gv_USER_ID != "K095060") {
		return;
	}
	    
	var dsTmp = null;
	
	if      (this.tab_REPT.TabIndex == 0) dsTmp = this.ds_s06_bankbook;
	else if (this.tab_REPT.TabIndex == 1) dsTmp = this.ds_s06_rept_trans03;
	else if (this.tab_REPT.TabIndex == 2) dsTmp = this.ds_s06_reptupso02;
	else	return;
	// 수정 불가 : 수정을 하려면 삭제 후 재 입력
	if (dsTmp.GetRowType(dsTmp.currow) == "normal" && length(dsTmp.GetColumn(dsTmp.currow, "UPSO_CD")) > 0) {
		return;
	}
    var inParam = "SGBN=bra04_s06" + " BRAN_CD=" + quote(BRAN_CD) + " UPSO_CD='' UPSO_NM=''";
	var result = Dialog("fi_bra::find_ReptUpso.xml",inParam);

	if (length(result) > 0) {
	
		var start_yrmn = substr(dsTmp.getColumn(dsTmp.currow, "START_YRMN"), 0, 6);
		var end_yrmn   = substr(dsTmp.getColumn(dsTmp.currow, "END_YRMN"  ), 0, 6);
/*
		// 폐업업소 확인
		if (length(this.ds_s06_upso.GetColumn(0, "CLSBS_YRMN")) > 0) {
			if (toNumber(start_yrmn) >= toNumber(this.ds_s06_upso.GetColumn(0,"CLSBS_YRMN")) ||
				toNumber(end_yrmn) >= toNumber(this.ds_s06_upso.GetColumn(0,"CLSBS_YRMN")) ) {
				gfn_Confirm("MB_OK", "폐업월 이후 입금이 발생하였습니다.\n폐업월을 확인하세요", "경고", "0");
				dsTmp.SetColumn(dsTmp.currow, "UPSO_CD"   , "");
				dsTmp.SetColumn(dsTmp.currow, "UPSO_NM"   , "");
				dsTmp.SetColumn(dsTmp.currow, "START_YRMN", "");
				dsTmp.SetColumn(dsTmp.currow, "END_YRMN"  , "");
				dsTmp.SetColumn(dsTmp.currow, "DEMD_MMCNT", null);
				dsTmp.SetColumn(dsTmp.currow, "BALANCE"   , null);
				dsTmp.SetColumn(dsTmp.currow, "NOTE_YRMN" , null);
				return;
			}
		}
*/		
		// 고소 정보 확인
		// 고소업소를 선택했을 경우 입금 못한다는 메시지를 보여준다.
		// 고소입금은 '업소입금등록' 에서만 처리하도록 한다ㅏ. 2010.05.28
		if (this.ds_s06_AccuInfo.rowcount > 0) {
		
			gfn_Confirm("MB_OK", "고소된 업소입니다. 업소입금등록 에서 입금처리하시기 바랍니다.", "경고", "0");
			
			dsTmp.SetColumn(dsTmp.currow, "NOTE_YRMN" , dsTmp.GetColumn(dsTmp.currow, "END_YRMN"));
			dsTmp.SetColumn(dsTmp.currow, "UPSO_CD"   , "");
			dsTmp.SetColumn(dsTmp.currow, "UPSO_NM"   , "");
			dsTmp.SetColumn(dsTmp.currow, "START_YRMN", "");
			dsTmp.SetColumn(dsTmp.currow, "END_YRMN"  , "");
			dsTmp.SetColumn(dsTmp.currow, "DEMD_MMCNT", null);
			dsTmp.SetColumn(dsTmp.currow, "BALANCE"   , null);
			if (this.tab_REPT.TabIndex == 0) {dsTmp.SetColumn(dsTmp.currow, "STAFF_NM", "");}
			
			return;
		}
	}
	else {
		if (length(dsTmp.GetColumn(dsTmp.currow, "UPSO_CD")) > 0) {
		
			ds_s06_closingIn.SetColumn(0, "REPT_DAY", dsTmp.GetColumn(dsTmp.currow, "REPT_DAY"));
			ds_s06_closingIn.SetColumn(0, "UPSO_CD", dsTmp.GetColumn(dsTmp.currow, "UPSO_CD"));
			gfn_syncCall("chk_return_yn","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=chk_return_yn","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
			
			if(parseInt(ds_s06_closingYn.GetColumn(0, "CNT")) > 0)
			{
				gfn_Confirm("MB_OK", "해당입금내역은 반환처리되었습니다.\n삭제할 수 없습니다.", "경고", "0");
				return;
			}
				
			var yesno = gfn_Confirm("MB_YESNO", "삭제하시겠습니까 ?", "경고", "0");

			if (yesno == "6") {
				
				//gfn_syncCall("chk_return_yn","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=chk_return_yn","S=ds_s06_upso_search02","ds_s06_rept_trans02=MRG2","","fn_CallBack");
//trace("this.ds_s06_upso.rowcount : " + this.ds_s06_upso.rowcount);
				if (this.ds_s06_upso.rowcount > 0) {
					dsTmp.SetColumn(dsTmp.currow, "NOTE_YRMN" , dsTmp.GetColumn(dsTmp.currow, "END_YRMN"));
					dsTmp.SetColumn(dsTmp.currow, "UPSO_CD"   , "");
					dsTmp.SetColumn(dsTmp.currow, "UPSO_NM"   , "");
					dsTmp.SetColumn(dsTmp.currow, "START_YRMN", "");
					dsTmp.SetColumn(dsTmp.currow, "END_YRMN"  , "");
					dsTmp.SetColumn(dsTmp.currow, "DEMD_MMCNT", null);
					dsTmp.SetColumn(dsTmp.currow, "BALANCE"   , null);
					if (this.tab_REPT.TabIndex == 0) {dsTmp.SetColumn(dsTmp.currow, "STAFF_NM", "");}
					this.btn_accu.Visible = false;
					this.btn_claim.Visible = false;
				}
				else {
					// 수정된 내역을 정확히 하기 위해 null 와 "" 을 분리하여 초기화 한다.
					dsTmp.SetColumn(dsTmp.currow, "UPSO_CD"   , "");
					dsTmp.SetColumn(dsTmp.currow, "UPSO_NM"   , "");
					dsTmp.SetColumn(dsTmp.currow, "START_YRMN", "");
					dsTmp.SetColumn(dsTmp.currow, "END_YRMN"  , "");
					dsTmp.SetColumn(dsTmp.currow, "DEMD_MMCNT", null);
					dsTmp.SetColumn(dsTmp.currow, "BALANCE"   , null);
					dsTmp.SetColumn(dsTmp.currow, "NOTE_YRMN" , null);
					if (this.tab_REPT.TabIndex == 0) {dsTmp.SetColumn(dsTmp.currow, "STAFF_NM", "");}
				}	

				this.ds_s06_ReptIn.ClearData();
				this.ds_s06_upso.ClearData();
				this.ds_s06_AccuInfo.ClearData();
			}
		}
	}

//trace(dsTmp.saveXML() );
}
//--------------------------------------------------
function grd_bank_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    if(!(nCell == 7 || nCell == 8)){
        return;
    }
	fn_GetUpsoInfo();
}

function ds_s06_bankbook_OnRowPosChanged(obj,nOldRow,nRow)
{
    if(tab_REPT.TabIndex == 0) {
		var UPSO_CD = ds_s06_bankbook.GetColumn(nRow, "UPSO_CD");
		fn_GetReptInfo(UPSO_CD, "");
	}
}

//"센터간 분배정보" 첫번째 테이블의 로우가 변경될때
function ds_s06_rept_trans01_OnRowPosChanged(obj,nOldRow,nRow)
{
	var gv_BRAN_CD = gds_sessioninfo.GetColumn(0, "BRAN_CD");
	
    if((gv_BRAN_CD == "AL" && ds_s06_rept_trans01.rowcount != 0) ||
	   (ds_s06_rept_trans01.GetColumn(nRow,"BRAN_CD") == gv_BRAN_CD &&
		ds_s06_rept_trans01.GetColumn(nRow,"BRAN_CD") == this.cob_BRAN_CD.Value && 
		ds_s06_rept_trans01.rowcount != 0) ||
		gv_USER_ID == "K150009" || gv_USER_ID == "K095060")
	{
        tab_REPT.BRAN_DISTR.grd_rept_trans.Editable = true;
        
        tab_REPT.BRAN_DISTR.btn_AddBran.Enable = true;
	    tab_REPT.BRAN_DISTR.btn_DelBran.Enable = true;
	    tab_REPT.BRAN_DISTR.btn_saveBran.Enable = true;
    }
    else 
    {
        tab_REPT.BRAN_DISTR.grd_rept_trans.Editable = false;
        
        tab_REPT.BRAN_DISTR.btn_AddBran.Enable = false;
	    tab_REPT.BRAN_DISTR.btn_DelBran.Enable = false;
	    tab_REPT.BRAN_DISTR.btn_saveBran.Enable = false;
    }

    ds_s06_upso_search02.SetColumn(0,"REPT_DAY" , ds_s06_rept_trans01.GetColumn(nRow,"REPT_DAY"));
    ds_s06_upso_search02.SetColumn(0,"REPT_NUM" , ds_s06_rept_trans01.GetColumn(nRow,"REPT_NUM"));    
    ds_s06_upso_search02.SetColumn(0,"BRAN_CD"  , ds_s06_rept_trans01.GetColumn(nRow,"BRAN_CD"));    
	ds_s06_upso_search02.SetColumn(0,"START_DAY", this.cal_START_DAY.Value);    
	ds_s06_upso_search02.SetColumn(0,"END_DAY"  , this.cal_END_DAY.Value);

	gfn_syncCall("rept_distr_select02","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_select","S=ds_s06_upso_search02","ds_s06_rept_trans02=MRG2","","fn_CallBack");
}

function ds_s06_rept_trans02_OnRowPosChanged(obj,nOldRow,nRow)
{
	// 자신의 센터코드와 같은 경우만 업소매핑정보를 보여준다
	if (ds_s06_rept_trans02.count > 0) {
		if (length(ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD")) > 0) {
			ds_s06_upso_search02.SetColumn(0,"REPT_DAY" , ds_s06_rept_trans02.GetColumn(nRow, "REPT_DAY"));
			ds_s06_upso_search02.SetColumn(0,"REPT_NUM" , ds_s06_rept_trans02.GetColumn(nRow, "REPT_NUM"));    
			ds_s06_upso_search02.SetColumn(0,"BRAN_CD"  , ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD"));    
			ds_s06_upso_search02.SetColumn(0,"START_DAY", this.cal_START_DAY.Value);    
			ds_s06_upso_search02.SetColumn(0,"END_DAY"  , this.cal_END_DAY.Value);
			//trace(ds_s06_upso_search02.SaveXML());
            ds_s06_rept_trans03.DeleteAll();
			gfn_syncCall("rept_distr_select03","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_select","S=ds_s06_upso_search02","ds_s06_rept_trans03=MRG7","","fn_CallBack");

			var gv_BRAN_CD = gds_sessioninfo.GetColumn(0, "BRAN_CD");
			if (gv_BRAN_CD == "AL" || 
				(ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD") == gv_BRAN_CD &&
				 ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD") == this.cob_BRAN_CD.Value) ||
				 gv_USER_ID == "K150009" || //김은정
				 gv_USER_ID == "K095060"    //류선희
				 ) 
			{
				tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = true;
				tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = true;
				tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = true;
			}
			else {
				tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
				tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
				tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
			}
		}
		else {
			tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
			tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
			tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
		}
	}
	else{
	    ds_s06_rept_trans03.DeleteAll();
	    tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
		tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
		tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
	}
}

//센터간 분배정보 추가
function tab_REPT_BRAN_DISTR_btn_AddBran_OnClick(obj)
{
	var isAdd = false;
	var distrAmt = 0;
	
	for(var i=0; i<ds_s06_rept_trans02.rowcount; i++) {
		distrAmt = distrAmt + toInteger(ds_s06_rept_trans02.GetColumn(i, "DISTR_AMT"));
	}
	if (distrAmt < toInteger(ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow,"REPT_AMT"))) {
		var aRow = ds_s06_rept_trans02.AddRow();
		ds_s06_rept_trans02.SetColumn(aRow,"S_BRAN_CD", ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "BRAN_CD"));
		ds_s06_rept_trans02.SetColumn(aRow,"REPT_NUM" , ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "REPT_NUM"));
		ds_s06_rept_trans02.SetColumn(aRow,"REPT_DAY" , ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "REPT_DAY"));
		ds_s06_rept_trans02.SetColumn(aRow,"REPT_GBN" , ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "REPT_GBN"));
		ds_s06_rept_trans02.SetColumn(aRow,"BRAN_CD"  , ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "BRAN_CD" ));

		bran_distr_MAPPING_DAY = today();
	}
	else {
        gfn_Confirm("MB_OK", "분배할 수 있는 금액이 없습니다.", "경고", "0");
	}
}


//센터간 분배정보 삭제
function tab_REPT_BRAN_DISTR_btn_DelBran_OnClick(obj)
{
	bran_distr_MAPPING_DAY = ds_s06_rept_trans02.GetColumn(ds_s06_rept_trans02.currow, "MAPPING_DAY");
	ds_s06_rept_trans02.DeleteRow(ds_s06_rept_trans02.currow);
	
	if (this.ds_s06_rept_trans02.rowcount == 0) {
		this.tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
		this.tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
		this.tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
	}
}

//센터간 분배정보 저장
function tab_REPT_BRAN_DISTR_btn_saveBran_OnClick(obj)
{
	// 입력 필수 항목 검사;
	if (!gfn_CheckFormNull(this.tab_REPT.BRAN_DISTR)) return;
	
	// 입금 마감 확인은 무통장인 경우 check 하지 않는다.
	// 매핑이 발생한 경우 가수금에서 제외하게 된다.
	this.ds_s06_closingIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
	this.ds_s06_closingIn.SetColumn(0, "REPT_DAY", bran_distr_MAPPING_DAY);
	
	gfn_syncCall("rept_closing","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_closing","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
	if(ds_s06_closingYn.GetColumn(0, "CNT") != "0"){
        gfn_Confirm("MB_OK", "해당기간중 마감내역이 존재합니다. 마감내역을 확인하세요.", "경고", "0");
	    return;
	}

    if(ds_s06_rept_trans02.rowcount > 0 && ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow,"REPT_AMT") != ds_s06_rept_trans02.Sum("DISTR_AMT")){
        gfn_Confirm("MB_OK", "입금금액과 분배금액의 합이 같아야 합니다", "경고", "0");
        return;
    }
    
    // 센터 중복분배 체크 
	if (!fn_CheckBRAN_Dup()) return;


    if(gfn_Confirm("MB_YESNO", "저장하시겠습니까 ?", "경고", "0") != "6"){
        return;
    }

	if (ds_s06_rept_trans02.rowcount == 0) {
		gfn_syncCall("rept_distr_delete","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_delete","S=ds_s06_rept_trans02:U","","","fn_CallBack",gv_TraceLog,GV_FORMID);
	}
	else {
		gfn_syncCall("rept_distr_insert","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_insert","S=ds_s06_rept_trans02:N","","","fn_CallBack",gv_TraceLog,GV_FORMID);
		
		var gv_BRAN_CD = gds_sessioninfo.GetColumn(0, "BRAN_CD");
		if (gv_BRAN_CD == "AL" || 
			(ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD") == gv_BRAN_CD &&
			 ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD") == this.cob_BRAN_CD.Value) ||
			 gv_USER_ID == "K150009" || //김은정
			 gv_USER_ID == "K095060"    //류선희
			 )
		{
			tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = true;
			tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = true;
			tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = true;
		}
		else {
			tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
			tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
			tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
		}
	}
}

// 센터 중복분배 체크
function fn_CheckBRAN_Dup()
{
	var result = true;
	var DUB_BRAN_CD = "";
	
	//trace(ds_s06_rept_trans02.SaveXML());
	
	for (var i=0; i<this.ds_s06_rept_trans02.rowcount; i++) {
		DUB_BRAN_CD = this.ds_s06_rept_trans02.GetColumn(i, "RECV_BRAN_CD");

		if (!fn_CheckBranCD(DUB_BRAN_CD, i)) {
            gfn_Confirm("MB_OK", "중복된 센터가 있습니다.", "경고", "0");
			result = false;
			break;
		}
	}
	
	return result;
}

function fn_CheckBranCD(DUB_BRAN_CD, idx) 
{
	var  result = true;

	for (var i=0; i<idx; i++) {
		if (length(this.ds_s06_rept_trans02.GetColumn(i, "RECV_BRAN_CD")) == 0) {
			break;
		}
		
		if (this.ds_s06_rept_trans02.GetColumn(i, "RECV_BRAN_CD") == DUB_BRAN_CD) {
			result = false;
			break;
		}
	}

	return result;
}


//업소매핑정보 추가
function tab_REPT_BRAN_DISTR_btn_AddUpso_OnClick(obj)
{
	if(ds_s06_rept_trans02.count == 0){
        gfn_Confirm("MB_OK", "선택된 센터간 분배 정보가 없습니다.", "경고", "0");
	    return;
	}

	var isAdd = false;
	var distrAmt = 0;
	for(var i=0; i<ds_s06_rept_trans03.rowcount; i++) {
		distrAmt = distrAmt + toInteger(ds_s06_rept_trans03.GetColumn(i, "DISTR_AMT"));
	}

	if (distrAmt < toInteger(ds_s06_rept_trans02.GetColumn(ds_s06_rept_trans02.currow,"DISTR_AMT"))) {
		var aRow = ds_s06_rept_trans03.AddRow();
		ds_s06_rept_trans03.SetColumn(aRow,"REPT_DAY" , ds_s06_rept_trans02.GetColumn(ds_s06_rept_trans02.currow,"REPT_DAY"));
		ds_s06_rept_trans03.SetColumn(aRow,"REPT_NUM" , ds_s06_rept_trans02.GetColumn(ds_s06_rept_trans02.currow,"REPT_NUM"));
		ds_s06_rept_trans03.SetColumn(aRow,"REPT_GBN" , "03");
		ds_s06_rept_trans03.SetColumn(aRow,"BRAN_CD"  , ds_s06_rept_trans02.GetColumn(ds_s06_rept_trans02.currow,"RECV_BRAN_CD"));
		ds_s06_rept_trans03.SetColumn(aRow,"COMIS"    , "0");
		ds_s06_rept_trans03.SetColumn(aRow,"DISTR_GBN", "41");
		bran_distr_MAPPING_DAY = today();
	}
	else {
        gfn_Confirm("MB_OK", "분배할 수 있는 금액이 없습니다.", "경고", "0");
	}
}

//업소매핑정보 삭제
function tab_REPT_BRAN_DISTR_btn_DeleteUpso_OnClick(obj)
{
	bran_distr_MAPPING_DAY = ds_s06_rept_trans03.GetColumn(ds_s06_rept_trans03.currow, "MAPPING_DAY");
	ds_s06_rept_trans03.DeleteRow(ds_s06_rept_trans03.currow);

	if (this.ds_s06_reptupso02.currow >= 0) {
		fn_GetReptInfo(this.ds_s06_rept_trans03.GetColumn(this.ds_s06_rept_trans03.currow, "UPSO_CD"), "");
	}
}

//업소매핑정보 저장   
function tab_REPT_BRAN_DISTR_btn_SaveUpso_OnClick(obj)
{

/*
	// 청구월이 계산되지 않은 경우의 처리
	if (length(this.ds_s06_rept_trans03.GetColumn(this.ds_s06_rept_trans03.currow, "BALANCE")) == 0) 
	{
		var UPSO_CD  = this.ds_s06_rept_trans03.GetColumn(nRow, "UPSO_CD");
		var distrAmt = toInteger(varNewValue);

		this.ds_s06_upso_search.SetColumn(0, "UPSO_CD" , UPSO_CD);
		this.ds_s06_upso_search.SetColumn(0, "REPT_AMT", distrAmt);
		gfn_syncCall("get_use_amt","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=get_use_amt","S=ds_s06_upso_search","ds_s06_DemdInfo=SEL2","","fn_CallBack");
		
		this.ds_s06_rept_trans03.SetColumn(nRow, "START_YRMN", this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"));
		this.ds_s06_rept_trans03.SetColumn(nRow, "END_YRMN"  , this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
		this.ds_s06_rept_trans03.SetColumn(nRow, "DEMD_MMCNT", this.ds_s06_DemdInfo.GetColumn(0, "DEMD_MMCNT"));
		this.ds_s06_rept_trans03.SetColumn(nRow, "NOTE_YRMN" , substr(this.ds_s06_upso.GetColumn(0, "LAST_YRMN"), 0, 6));

		var demdAmt  = toInteger(this.ds_s06_DemdInfo.GetColumn(0, "DEMD_AMT"));
		var cbalance = toInteger(this.ds_s06_upso.GetColumn(0, "BALANCE"));
		var lbalance = (distrAmt + cbalance) - demdAmt;

		this.ds_s06_rept_trans03.SetColumn(nRow, "BALANCE", lbalance);
	}
*/
	// 입력 필수 항목 검사;
	if (!gfn_CheckFormNull(this.tab_REPT.BRAN_DISTR)) return;

	// 입금 마감 확인은 무통장인 경우 check 하지 않는다.
	// 매핑이 발생한 경우 가수금에서 제외하게 된다.
	this.ds_s06_closingIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
	this.ds_s06_closingIn.SetColumn(0, "REPT_DAY", bran_distr_MAPPING_DAY);

	gfn_syncCall("rept_closing","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_closing","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
	if(ds_s06_closingYn.GetColumn(0, "CNT") != "0"){
        gfn_Confirm("MB_OK", "해당기간중 마감내역이 존재합니다. 마감내역을 확인하세요.", "경고", "0");
	    return;
	}

    if(gfn_Confirm("MB_YESNO", "저장하시겠습니까 ?", "경고", "0") != "6"){
        return;
    }
    
    // 오류정보 초기화
    this.ds_s06_error.ClearData();

	// 센터 분배 금액의 수정여부 검사
	var isBranDistrUpdated = false;
	for (var i=0; i>this.ds_s06_rept_trans02.rowcount; i++) {
		if (this.ds_s06_rept_trans02.GetRowType(i) != "normal") {
			isBranDistrUpdated = true;
			break;
		}
	}
	
	// 수정이 있는 경우 센터 분배정보를 먼저 저장한다.
	if (isBranDistrUpdated) {
		if(ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow,"REPT_AMT") != ds_s06_rept_trans02.Sum("DISTR_AMT")){
			gfn_Confirm("MB_OK", "입금금액과 분배금액의 합이 같아야 합니다", "경고", "0");
			return;
		}

		gfn_syncCall("rept_distr_insert","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_distr_insert","S=ds_s06_rept_trans02:N","","","fn_CallBack",gv_TraceLog,GV_FORMID);
	}

	if(ds_s06_error.count > 0){
        gfn_Confirm("MB_OK", ds_s06_error.GetColumn(ds_s06_error.count-1,"ERR_CTENT"), "오류", "0");
        return;
	}
	//trace("센터분배-업소매칭 풀어.");
	//trace(ds_s06_rept_trans03.SaveXML() );
	gfn_syncCall("rept_upso_distr_insert","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_upso_distr_insert","S=ds_s06_rept_trans03:U","ds_s06_rept_trans03=SEL9 ds_s06_error=SEL10","","fn_CallBack",gv_TraceLog,GV_FORMID);
	//trace(ds_s06_rept_trans03.SaveXML() );

	if(ds_s06_error.count > 0){
        gfn_Confirm("MB_OK", ds_s06_error.GetColumn(ds_s06_error.count-1,"ERR_CTENT"), "오류", "0");
	}
	else {
		fn_GetReptInfo(this.ds_s06_rept_trans03.GetColumn(this.ds_s06_rept_trans03.currow, "UPSO_CD"),
					   this.ds_s06_rept_trans03.GetColumn(this.ds_s06_rept_trans03.currow, "UPSO_NM"));
	}
}

function tab_REPT_BRAN_DISTR_grd_ReptTrans_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 0 && this.ds_s06_rept_trans03.GetRowType(nRow) == "insert" ){
		fn_GetUpsoInfo();
	}
}

//업소간 분배 출발점 RECV_DAY를 저장한다.
function ds_s06_reptupso01_OnRowPosChanged(obj,nOldRow,nRow)
{
    ds_s06_upso_search02.SetColumn(0,"REPT_DAY" , ds_s06_reptupso01.GetColumn(nRow, "REPT_DAY"));
    ds_s06_upso_search02.SetColumn(0,"REPT_NUM" , ds_s06_reptupso01.GetColumn(nRow, "REPT_NUM"));   
    ds_s06_upso_search02.SetColumn(0,"BRAN_CD"  , ds_s06_reptupso01.GetColumn(nRow, "BRAN_CD"));
	ds_s06_upso_search02.SetColumn(0,"START_DAY", this.cal_START_DAY.Value);    
	ds_s06_upso_search02.SetColumn(0,"END_DAY"  , this.cal_END_DAY.Value);
	
    ds_s06_reptupso02.DeleteAll();
//trace(ds_s06_upso_search02.SaveXML() );
	gfn_syncCall("rept_bran_distr_select02","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_bran_distr_select","S=ds_s06_upso_search02","ds_s06_reptupso02=MRG1","","fn_CallBack");
}

//업소매핑정보 추가
function tab_REPT_UPSO_DISTR_btn_AddUpso_OnClick(obj)
{
	if(ds_s06_reptupso01.count == 0){
        gfn_Confirm("MB_OK", "선택된 업소간 분배 정보가 없습니다.", "경고", "0");
	    return;
	}

	var isAdd = false;
	var distrAmt = 0;
	for(var i=0; i<ds_s06_reptupso02.rowcount; i++) {
		distrAmt = distrAmt + toInteger(ds_s06_reptupso02.GetColumn(i, "DISTR_AMT"));
	}

	if (distrAmt < toInteger(ds_s06_reptupso01.GetColumn(ds_s06_reptupso01.currow,"REPT_AMT"))) {
		var aRow = ds_s06_reptupso02.AddRow();
		ds_s06_reptupso02.SetColumn(aRow,"REPT_DAY" , ds_s06_reptupso01.GetColumn(ds_s06_reptupso01.currow,"REPT_DAY"));
		ds_s06_reptupso02.SetColumn(aRow,"REPT_NUM" , ds_s06_reptupso01.GetColumn(ds_s06_reptupso01.currow,"REPT_NUM"));
		ds_s06_reptupso02.SetColumn(aRow,"REPT_GBN" , "03");
		ds_s06_reptupso02.SetColumn(aRow,"BRAN_CD"  , ds_s06_reptupso01.GetColumn(ds_s06_reptupso01.currow,"BRAN_CD"));
		ds_s06_reptupso02.SetColumn(aRow,"COMIS"    , "0");
		ds_s06_reptupso02.SetColumn(aRow,"DISTR_GBN", "42");
		upso_distr_MAPPING_DAY = today();
	}
	else {
        gfn_Confirm("MB_OK", "분배할 수 있는 금액이 없습니다.", "경고", "0");
	}
}

//업소매핑정보 삭제
function tab_REPT_UPSO_DISTR_btn_DeleteUpso_OnClick(obj)
{
	upso_distr_MAPPING_DAY = ds_s06_reptupso02.GetColumn(ds_s06_reptupso02.currow, "MAPPING_DAY");
	ds_s06_reptupso02.DeleteRow(ds_s06_reptupso02.currow);

	if (this.ds_s06_reptupso02.currow >= 0) {
		fn_GetReptInfo(this.ds_s06_rept_trans02.GetColumn(this.ds_s06_reptupso02.currow, "UPSO_CD"), "");
	}
}

//업소매핑정보 저장
function tab_REPT_UPSO_DISTR_btn_SaveUpso_OnClick(obj)
{
/*
	// 청구월이 계산되지 않는 경우의 처리
	if (length(this.ds_s06_reptupso02.GetColumn(this.ds_s06_reptupso02.currow, "BALANCE")) == 0) {
		var UPSO_CD  = this.ds_s06_reptupso02.GetColumn(nRow, "UPSO_CD");
		var distrAmt = toInteger(varNewValue);

		this.ds_s06_upso_search.SetColumn(0, "UPSO_CD" , UPSO_CD);
		this.ds_s06_upso_search.SetColumn(0, "REPT_AMT", distrAmt);
		gfn_syncCall("get_use_amt","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=get_use_amt","S=ds_s06_upso_search","ds_s06_DemdInfo=SEL2","","fn_CallBack");
		
		this.ds_s06_reptupso02.SetColumn(nRow, "START_YRMN", this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"));
		this.ds_s06_reptupso02.SetColumn(nRow, "END_YRMN"  , this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
		this.ds_s06_reptupso02.SetColumn(nRow, "DEMD_MMCNT", this.ds_s06_DemdInfo.GetColumn(0, "DEMD_MMCNT"));
		this.ds_s06_reptupso02.SetColumn(nRow, "NOTE_YRMN" , substr(this.ds_s06_upso.GetColumn(0, "LAST_YRMN"), 0, 6));

		var demdAmt  = toInteger(this.ds_s06_DemdInfo.GetColumn(0, "DEMD_AMT"));
		var cbalance = toInteger(this.ds_s06_upso.GetColumn(0, "BALANCE"));
		var lbalance = (distrAmt + cbalance) - demdAmt;

		this.ds_s06_reptupso02.SetColumn(nRow, "BALANCE", lbalance);
	}
*/
	// 입력 필수 항목 검사;
	if (!gfn_CheckFormNull(this.tab_REPT.UPSO_DISTR)) return;

	// 입금 마감 확인은 무통장인 경우 check 하지 않는다.
	// 매핑이 발생한 경우 가수금에서 제외하게 된다.
	this.ds_s06_closingIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
	this.ds_s06_closingIn.SetColumn(0, "REPT_DAY", upso_distr_MAPPING_DAY);

	gfn_syncCall("rept_closing","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_closing","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
	if(ds_s06_closingYn.GetColumn(0, "CNT") != "0"){
        gfn_Confirm("MB_OK", "해당기간중 마감내역이 존재합니다. 마감내역을 확인하세요.", "경고", "0");
	    return;
	}

    if(gfn_Confirm("MB_YESNO", "저장하시겠습니까 ?", "경고", "0") != "6"){
        return;
    }

    // 오류정보 초기화
    this.ds_s06_error.ClearData();
    
    //trace(ds_s06_reptupso02.SaveXML("ds_s06_reptupso02", "U" ) );
	gfn_syncCall("rept_upso_distr_insert","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_upso_distr_insert","S=ds_s06_reptupso02:U","ds_s06_reptupso02=SEL9 ds_s06_error=SEL10","","fn_CallBack",gv_TraceLog,GV_FORMID);

	if(ds_s06_error.count > 0){
        gfn_Confirm("MB_OK", ds_s06_error.GetColumn(ds_s06_error.count-1,"ERR_CTENT"), "오류", "0");
	}
	else {
		fn_GetReptInfo(this.ds_s06_reptupso02.GetColumn(this.ds_s06_reptupso02.currow, "UPSO_CD"),
					   this.ds_s06_reptupso02.GetColumn(this.ds_s06_reptupso02.currow, "UPSO_NM"));
	}
}


function tab_REPT_UPSO_DISTR_grd_ReptTrans_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 0 && this.ds_s06_reptupso02.GetRowType(nRow) == "insert"){
		
		fn_GetUpsoInfo();
	}
}

function ds_s06_rept_trans03_OnRowPosChanged(obj,nOldRow,nRow)
{
	if(tab_REPT.TabIndex == 1) {
		var UPSO_CD = ds_s06_rept_trans03.GetColumn(nRow, "UPSO_CD");
		fn_GetReptInfo(UPSO_CD, "");
	}
}

function ds_s06_reptupso02_OnRowPosChanged(obj,nOldRow,nRow)
{
	if(tab_REPT.TabIndex == 2) {
		//원장조회
		var UPSO_CD = ds_s06_reptupso02.GetColumn(nRow, "UPSO_CD");
		fn_GetReptInfo(UPSO_CD, "");
	}
}

function cob_BRAN_CD_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	gfn_SetPermission(strCode);
/*
	gfn_SetInnerPermission("tab_REPT.BRAN_DISTR.btn_AddBran,tab_REPT.BRAN_DISTR.btn_DelBran,tab_REPT.BRAN_DISTR.btn_saveBran");
	gfn_SetInnerPermission("tab_REPT.BRAN_DISTR.btn_AddUpso,tab_REPT.BRAN_DISTR.btn_DeleteUpso,tab_REPT.BRAN_DISTR.btn_SaveUpso");
	gfn_SetInnerPermission("tab_REPT.UPSO_DISTR.btn_AddUpso,tab_REPT.UPSO_DISTR.btn_DeleteUpso,tab_REPT.UPSO_DISTR.btn_SaveUpso");
*/
	ds_s06_ReptIn.ClearData();
	ds_s06_upso.ClearData();
	ds_s06_bankbook.ClearData();
	ds_s06_rept_trans01.ClearData();
	ds_s06_rept_trans02.ClearData();
	ds_s06_rept_trans03.ClearData();
	ds_s06_reptupso01.ClearData();
	ds_s06_reptupso02.ClearData();

	this.ds_s06_AccnNumIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
	this.ds_s06_AccnNumIn.SetColumn(0, "USE_TYPE", gfn_GetAccountUsage("03"));	
	gfn_syncCall("find_account","KOMCA?SYSID=PATHFINDER&MENUID=1000001006007&EVENTID=accn_num_select","S=ds_s06_AccnNumIn","ds_s06_bankList=SEL1","","fn_CallBack");
	this.cob_ACCN_NUM.Index = 0;
	
	// 테스트를 위해 처리
	if (this.cob_BRAN_CD.Value == "T") {
		this.ds_s06_banklist.ClearData();
		var nRow = this.ds_s06_banklist.AddRow();

		this.ds_s06_banklist.SetColumn(nRow, 0, "test");
		this.ds_s06_banklist.SetColumn(nRow, 1, "test");
		this.ds_s06_banklist.SetColumn(nRow, 2, "test");
		this.ds_s06_banklist.SetColumn(nRow, 3, "test");
	}
}

function btn_accu_OnClick(obj)
{
	if (this.ds_s06_AccuInfo.rowcount > 0) {
		g_bran_cd   = this.ds_s06_upso.GetColumn    (0, "BRAN_CD"  );
		g_upso_cd   = this.ds_s06_upso.GetColumn    (0, "UPSO_CD"  );
		g_accu_day  = this.ds_s06_AccuInfo.GetColumn(0, "ACCU_DAY" );
		g_accu_num  = this.ds_s06_AccuInfo.GetColumn(0, "ACCU_NUM" );
		g_accu_bran = this.ds_s06_AccuInfo.GetColumn(0, "ACCU_BRAN");
		g_accu_gbn  = this.ds_s06_AccuInfo.GetColumn(0, "ACCU_GBN" );
		var judg_cd = this.ds_s06_AccuInfo.GetColumn(0, "JUDG_CD"  );

		gfn_OpenChildWindow("fi_bra::bra05_s03.xml","고소등록");
	}
}

function tab_REPT_TRANS_grd_ReptTrans_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 9){
		if(this.tab_REPT.TabIndex == 0) {
			//원장조회
			var UPSO_CD = ds_s06_bankbook.GetColumn(nRow, "UPSO_CD");
			fn_GetReptInfo(UPSO_CD, "");
		}
	}
}

// 센터간분배- 업소매칭 그리드의 UPSO_CD 또는 분배금액을 입력했을 경우 호출되는 이벤트
function ds_s06_rept_trans03_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID == "UPSO_CD") {
		if (length(varNewValue) > 0) {
			fn_FindUPSO_CD(this.ds_s06_rept_trans03, nRow);
		}
		else {
			this.ds_s06_rept_trans03.SetColumn(nRow, "UPSO_NM", "");
		}
	}
	else if (strColumnID == "DISTR_AMT") {
		var CHK_RECV_DAY = "";
		if (length(varNewValue) > 0 && toInteger(varNewValue) > 0) {
			var UPSO_CD  = this.ds_s06_rept_trans03.GetColumn(nRow, "UPSO_CD");
			var distrAmt = toInteger(varNewValue);

			CHK_RECV_DAY = ds_s06_rept_trans01.GetColumn(ds_s06_rept_trans01.currow, "RECV_DAY");
			this.ds_s06_upso_search.SetColumn(0, "UPSO_CD" , UPSO_CD);
			this.ds_s06_upso_search.SetColumn(0, "REPT_AMT", distrAmt);
			this.ds_s06_upso_search.SetColumn(0, "RECV_DAY", CHK_RECV_DAY);
			//trace("센터간분배 CHK_RECV_DAY_BRAN:"+CHK_RECV_DAY);
			
			//trace(ds_s06_upso_search.SaveXML());
			gfn_syncCall("get_use_amt","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=get_use_amt","S=ds_s06_upso_search","ds_s06_DemdInfo=SEL2","","fn_CallBack");
			//trace(ds_s06_DemdInfo.SaveXML());
			
			this.ds_s06_rept_trans03.SetColumn(nRow, "START_YRMN", this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"));
			this.ds_s06_rept_trans03.SetColumn(nRow, "END_YRMN"  , this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
			this.ds_s06_rept_trans03.SetColumn(nRow, "DEMD_MMCNT", this.ds_s06_DemdInfo.GetColumn(0, "DEMD_MMCNT"));
			this.ds_s06_rept_trans03.SetColumn(nRow, "NOTE_YRMN" , substr(this.ds_s06_upso.GetColumn(0, "LAST_YRMN"), 0, 6));

			var demdAmt  = toInteger(this.ds_s06_DemdInfo.GetColumn(0, "DEMD_AMT"));
			var cbalance = toInteger(this.ds_s06_upso.GetColumn(0, "BALANCE"));	// 기존 잔고
			//var lbalance = (distrAmt + cbalance) - demdAmt;
			var lbalance;
			
			//trace("센터간분배 demdAmt:"+demdAmt);
			//trace("센터간분배 cbalance:"+cbalance);
			//trace("센터간분배 END_YRMN:"+this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
			
			if(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN") == ""){
				// 1달이 안채워 질경우 모든 입금금액이 잔고로 빠진다.
				lbalance = cbalance + distramt;	// new잔고 = 기존 잔고 + 현재 분배(입금)금액
			}else{
				// 1달 이상이 채워질경우 새로운 잔고 정보 
				lbalance = distramt - demdamt;	// new잔고 = 분배(입금) 금액 - 청구금액
			}
			//trace("센터간분배 lbalance:"+lbalance);

			var C_BALANCE;
		
			// 고소일 경우에는 잔고가 발생하지 않는다.
			if(this.ds_s06_AccuInfo.rowcount){
				C_BALANCE = 0;
				this.ds_s06_rept_trans03.SetColumn(nRow, "BALANCE", 0);
			}else{
				 C_BALANCE = lbalance;
				this.ds_s06_rept_trans03.SetColumn(nRow, "BALANCE", lbalance);
			}
			
			// 현재 시작년월~종료년월에 해당하는 청구금액을 입금하고 남은 잔고가 존재할경우 
			// 다음 1달을 채우기 위해 필요한 금액이 얼마인지 조회한다.
			if(C_BALANCE > 0){
				if (length(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN")) > 0) {
					fn_GetNextUseAmt(UPSO_CD, this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), addMonth(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"),1), CHK_RECV_DAY);
				}else{
					fn_GetNextUseAmt(UPSO_CD, this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), CHK_RECV_DAY);
				}
				
				//var NEXT_AMT = toInteger(this.ds_s06_NextAmt.GetColumn(0, "TOT_DEMD_AMT"));
				//NESS_AMT = NEXT_AMT - distrAmt;
				//그 다음달이 폐업인 경우에는 NEXT_AMT 가 현재 입금 기간과 청구금액이 같기 때문에 NEXX_AMT 정보가 0이다.
				if(NEXT_AMT == 0){
					NESS_AMT = 0;
				}else{
					NESS_AMT = NEXT_AMT - distrAmt;
				}
				
				this.ds_s06_rept_trans03.SetColumn(nRow, "NESS_AMT", NESS_AMT);
			}else{
				this.ds_s06_rept_trans03.SetColumn(nRow, "NESS_AMT", 0);
			}
			//trace("센터간분배 NESS_AMT:"+NESS_AMT);
		}
	}
}

//업소간분배 - 업소매칭 그리드의 UPSO_CD 또는 분배금액을 입력했을 경우 호출되는 이벤트
function ds_s06_reptupso02_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID == "UPSO_CD") {
		if (length(varNewValue) > 0) {
			fn_FindUPSO_CD(this.ds_s06_reptupso02, nRow);
		}
		else {
			this.ds_s06_reptupso02.SetColumn(nRow, "UPSO_NM", "");
		}
	}
	else if (strColumnID == "DISTR_AMT") {
		var CHK_RECV_DAY = "";
		if (length(varNewValue) > 0 && toInteger(varNewValue) > 0) {
			var UPSO_CD  = this.ds_s06_reptupso02.GetColumn(nRow, "UPSO_CD");
			var distrAmt = toInteger(varNewValue);
			
			CHK_RECV_DAY = ds_s06_reptupso01.GetColumn(ds_s06_reptupso01.currow, "RECV_DAY");
			this.ds_s06_upso_search.SetColumn(0, "UPSO_CD" , UPSO_CD);
			this.ds_s06_upso_search.SetColumn(0, "REPT_AMT", distrAmt);
			this.ds_s06_upso_search.SetColumn(0, "RECV_DAY", CHK_RECV_DAY);
			
			gfn_syncCall("get_use_amt","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=get_use_amt","S=ds_s06_upso_search","ds_s06_DemdInfo=SEL2","","fn_CallBack");
			
			this.ds_s06_reptupso02.SetColumn(nRow, "START_YRMN", this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"));
			this.ds_s06_reptupso02.SetColumn(nRow, "END_YRMN"  , this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
			this.ds_s06_reptupso02.SetColumn(nRow, "DEMD_MMCNT", this.ds_s06_DemdInfo.GetColumn(0, "DEMD_MMCNT"));
			this.ds_s06_reptupso02.SetColumn(nRow, "NOTE_YRMN" , substr(this.ds_s06_upso.GetColumn(0, "LAST_YRMN"), 0, 6));

			var demdAmt  = toInteger(this.ds_s06_DemdInfo.GetColumn(0, "DEMD_AMT"));
			var cbalance = toInteger(this.ds_s06_upso.GetColumn(0, "BALANCE"));
			//var lbalance = (distrAmt + cbalance) - demdAmt;
			var lbalance;
			
			//trace("업소분배 demdAmt:"+demdAmt);
			//trace("업소분배 cbalance:"+cbalance);
			//trace("업소분배 END_YRMN CHK:"+this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"));
			
			if(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN") == ""){
				// 1달이 안채워 질경우 모든 입금금액이 잔고로 빠진다.
				lbalance = cbalance + distramt;	// new잔고 = 기존 잔고 + 현재 분배(입금)금액
			}else{
				// 1달 이상이 채워질경우 새로운 잔고 정보 
				lbalance = distramt - demdamt;	// new잔고 = 분배(입금) 금액 - 청구금액
			}
			
			//trace("업소분배 lbalance:"+lbalance);

			var C_BALANCE;
		
			if(this.ds_s06_AccuInfo.rowcount){
				C_BALANCE = 0;
				this.ds_s06_reptupso02.SetColumn(nRow, "BALANCE", 0);
			}else{
				// 현재 시작년월~종료년월에 해당하는 청구금액을 입금하고 남은 잔고가 존재할경우 
				// 다음 1달을 채우기 위해 필요한 금액이 얼마인지 조회한다.
				C_BALANCE = lbalance;
				this.ds_s06_reptupso02.SetColumn(nRow, "BALANCE", lbalance);
			}
				
			
			if(C_BALANCE > 0){
				if (length(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN")) > 0) {
					fn_GetNextUseAmt(UPSO_CD, this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), addMonth(this.ds_s06_DemdInfo.GetColumn(0, "END_YRMN"),1), CHK_RECV_DAY);
				}else{
					fn_GetNextUseAmt(UPSO_CD, this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), this.ds_s06_DemdInfo.GetColumn(0, "START_YRMN"), CHK_RECV_DAY);
				}
				
				//그 다음달이 폐업인 경우에는 NEXT_AMT 가 현재 입금 기간과 청구금액이 같기 때문에 NEXX_AMT 정보가 0이다.
				if(NEXT_AMT == 0){
					NESS_AMT = 0;
				}else{
					NESS_AMT = NEXT_AMT - distrAmt;
				}
				
				this.ds_s06_reptupso02.SetColumn(nRow, "NESS_AMT", NESS_AMT);
			}else{
				this.ds_s06_reptupso02.SetColumn(nRow, "NESS_AMT", 0);
			}
			
			//trace("업소분배 매칭 NESS_AMT : "+NESS_AMT);
		}
	}
}

function fn_SetTabButtonEnabled(enabled)
{
	// 버튼 활성화
	var comps = this.parent.dvtitle.divIcon.Components["Button"];
	for( var i = 0 ; i < comps.Count ; i++)
	{
		objBtn = object("dvtitle.divIcon." + comps[i].id);
		if (objBtn.UserData == "SAVE") 
		{
			objBtn.Enable = enabled;
		}
	}
}

function tab_REPT_OnChanged(obj,nOldIndex,nNewIndex)
{
	NESS_AMT = 0;	// 필요금액 
	NEXT_AMT = 0;	// 다음달 금액
	
	var UPSO_CD = "";
	
	if (nNewIndex == 0) {
		UPSO_CD = this.ds_s06_bankbook.GetColumn(this.ds_s06_bankbook.currow, "UPSO_CD");
		this.cob_ACCN_NUM.Enable = true;
		fn_SetTabButtonEnabled(true);
	}
	else if (nNewIndex == 1) {
		UPSO_CD = this.ds_s06_rept_trans03.GetColumn(this.ds_s06_rept_trans03.currow, "UPSO_CD");
		this.cob_ACCN_NUM.Enable = false;
		fn_SetTabButtonEnabled(false);
	}
	else {
		UPSO_CD = this.ds_s06_reptupso02.GetColumn(this.ds_s06_reptupso02.currow, "UPSO_CD");
		this.cob_ACCN_NUM.Enable = true;
		fn_SetTabButtonEnabled(false);
	}

	fn_GetReptInfo(UPSO_CD, "");
}

function tab_REPT_BRAN_DISTR_grd_rept_trans_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var gv_BRAN_CD = gds_sessioninfo.GetColumn(0, "BRAN_CD");

	if (ds_s06_rept_trans02.rowcount > 0) {
		if (length(ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD")) > 0 &&
		    length(ds_s06_rept_trans02.GetColumn(nRow, "DISTR_AMT")) > 0 ) {
			if (gv_BRAN_CD == "AL" || 
				(ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD") == gv_BRAN_CD) &&
				 ds_s06_rept_trans02.GetColumn(nRow, "RECV_BRAN_CD") == this.cob_BRAN_CD.Value ||
				 gv_USER_ID == "K150009" || //김은정
				 gv_USER_ID == "K095060"    //류선희
				 ) {
				tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = true;
				tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = true;
				tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = true;
			}
			else {
				tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
				tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
				tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
			}
		}
		else {
			tab_REPT.BRAN_DISTR.btn_AddUpso.Enable = false;
			tab_REPT.BRAN_DISTR.btn_DeleteUpso.Enable = false;
			tab_REPT.BRAN_DISTR.btn_SaveUpso.Enable = false;
		}
	}
}

function fn_FindUPSO_CD(dsTmp, nRow)
{
	var BRAN_CD = this.cob_BRAN_CD.Value;
	var UPSO_CD = dsTmp.GetColumn(nRow, "UPSO_CD");
	var result = gfn_GetUPSO_CD(BRAN_CD, UPSO_CD, "");

	if (length(result) > 0) {
		var vArr = result.split(",");
		dsTmp.SetColumn(nRow, "UPSO_NM", vArr[1]);
		fn_GetReptInfo(UPSO_CD, vArr[1]);
	}
}

function ds_s06_bankbook_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID == "UPSO_CD") {
		if (length(varNewValue) > 0) {

			// 저장되지 않은 동일한 업소가 있는지 확인한다.
			// 이 경우 이전 내역을 먼저 저장해야 한다.
			var isCont = true;
			for (var i=0; i<ds_s06_bankbook.rowcount; i++) {
				var pUPSO_CD = ds_s06_bankbook.getColumn(i, "UPSO_CD");
				if (pUPSO_CD == varNewValue && i != ds_s06_bankbook.currow ) {
					if (ds_s06_bankbook.GetRowType(i) == "update") {
						isCont = false;
						break;
					}
				}
			}

			if (!isCont) {
				gfn_Confirm("MB_OK", "한 업소를 2번이상 매칭시킬경우\n이전 내용을 먼저 저장하신후 진행하십시요", "경고", "0");
				if (this.ds_s06_upso.rowcount > 0) {
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_CD"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_NM"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "START_YRMN", "");
					this.ds_s06_bankbook.SetColumn(nRow, "END_YRMN"  , "");
					this.ds_s06_bankbook.SetColumn(nRow, "DEMD_MMCNT", null);
					this.ds_s06_bankbook.SetColumn(nRow, "BALANCE"   , null);
					this.ds_s06_bankbook.SetColumn(nRow, "NOTE_YRMN" , this.ds_s06_upso.GetColumn(0, "LAST_YRMN"));
					this.btn_accu.Visible = false;
					this.btn_claim.Visible = false;
				}else{
					// 수정된 내역을 정확히 하기 위해 null 와 "" 을 분리하여 초기화 한다.
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_CD"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_NM"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "START_YRMN", "");
					this.ds_s06_bankbook.SetColumn(nRow, "END_YRMN"  , "");
					this.ds_s06_bankbook.SetColumn(nRow, "DEMD_MMCNT", null);
					this.ds_s06_bankbook.SetColumn(nRow, "BALANCE"   , null);
					this.ds_s06_bankbook.SetColumn(nRow, "NOTE_YRMN" , null);
				}
				return;
			}
			fn_FindUPSO_CD(this.ds_s06_bankbook, nRow);
		}else{
			this.ds_s06_bankbook.SetColumn(nRow, "UPSO_NM", "");
		}
	}
}

function tab_REPT_TRANS_grd_ReptTrans_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if (nCell == 11) {
		if (length(this.ds_s06_bankbook.GetColumn(nRow, "UPSO_CD")) > 0) {

			this.ds_s06_closingIn.SetColumn(0, "BRAN_CD" , this.cob_BRAN_CD.Value);
			this.ds_s06_closingIn.SetColumn(0, "REPT_DAY", this.ds_s06_bankbook.GetColumn(nRow, "MAPPING_DAY"));
			//trace(ds_s06_closingIn.SaveXML() );
			gfn_syncCall("rept_closing","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=rept_closing","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
			
			if(ds_s06_closingYn.GetColumn(0, "CNT") != "0"){
				gfn_Confirm("MB_OK", "해당기간중 마감내역이 존재합니다. 마감내역을 확인하세요.", "경고", "0");
				return;
			}
			
			ds_s06_closingIn.SetColumn(0, "REPT_DAY", ds_s06_bankbook.GetColumn(nRow, "REPT_DAY"));
			ds_s06_closingIn.SetColumn(0, "UPSO_CD", ds_s06_bankbook.GetColumn(nRow, "UPSO_CD"));
			gfn_syncCall("chk_return_yn","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=chk_return_yn","S=ds_s06_closingIn","ds_s06_closingYn=SEL1","","fn_CallBack");
			
			if(parseInt(ds_s06_closingYn.GetColumn(0, "CNT")) > 0)
			{
				gfn_Confirm("MB_OK", "해당입금내역은 반환처리되었습니다.\n삭제할 수 없습니다.", "경고", "0");
				return;
			}

			var yesno = gfn_Confirm("MB_YESNO", "삭제하시겠습니까 ?", "경고", "0");
			
			if (yesno == "6") {
//trace("this.ds_s06_upso.rowcount : " + this.ds_s06_upso.rowcount);
				if (this.ds_s06_upso.rowcount > 0) {
					this.ds_s06_bankbook.SetColumn(nRow, "NOTE_YRMN" , this.ds_s06_bankbook.GetColumn(nRow, "END_YRMN"));
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_CD"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_NM"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "START_YRMN", "");
					this.ds_s06_bankbook.SetColumn(nRow, "END_YRMN"  , "");
					this.ds_s06_bankbook.SetColumn(nRow, "DEMD_MMCNT", null);
					this.ds_s06_bankbook.SetColumn(nRow, "BALANCE"   , null);
					this.btn_accu.Visible = false;
					this.btn_claim.Visible = false;
				}
				else {
					// 수정된 내역을 정확히 하기 위해 null 와 "" 을 분리하여 초기화 한다.
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_CD"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "UPSO_NM"   , "");
					this.ds_s06_bankbook.SetColumn(nRow, "START_YRMN", "");
					this.ds_s06_bankbook.SetColumn(nRow, "END_YRMN"  , "");
					this.ds_s06_bankbook.SetColumn(nRow, "DEMD_MMCNT", null);
					this.ds_s06_bankbook.SetColumn(nRow, "BALANCE"   , null);
					this.ds_s06_bankbook.SetColumn(nRow, "NOTE_YRMN" , null);
				}	

				this.ds_s06_ReptIn.ClearData();
				this.ds_s06_upso.ClearData();
				this.ds_s06_AccuInfo.ClearData();
			}
		}
	}
//trace(ds_s06_bankbook.saveXML() );
	
}

function btn_claim_OnClick(obj)
{
	alert("채권입력년월 : " + this.ds_s06_upso.GetColumn(0, "CLAIM_APPTN_YRMN"));
}

//자동매칭 버튼을 클릭했을때
//무통장입금등록 grid를 루핑하면서 조건에 맞는 업소를 찾는다.
//입금금액이 당월청구금액 또는 현재미납금과 같은업소 이면서
//입금자 명이 경영주/허가주 명과 같은업소
function tab_REPT_TRANS_btn_auto_matching_OnClick(obj)	//자동매칭 중지라는 말은 실행중이라는 의미다.
{
	if(this.tab_REPT.TRANS.btn_auto_matching.Text == "자동매칭 중지") {
		this.tab_REPT.TRANS.btn_auto_matching.Text = "자동매칭 실행";
	} else {
		this.tab_REPT.TRANS.btn_auto_matching.Text = "자동매칭 중지";
	}

	var v_auto_err = "";
	
	for (var i=0; i<ds_s06_bankbook.GetRowCount() && this.tab_REPT.TRANS.btn_auto_matching.Text == "자동매칭 중지"; i++)
	{
		this.ds_s06_bankbook.row = i;	//currow를 변경시켰다. 나중에 호출할 fn_GetReptInfo에서 currow를 사용하므로.
		
		if(ds_s06_bankbook.GetColumn(ds_s06_bankbook.currow, "UPSO_CD") == "")
		{
			this.ds_auto_match_in.ClearData();
			this.ds_auto_match_out.ClearData();
			this.ds_auto_match_in.AddRow();
			this.ds_auto_match_in.SetColumn(0, "BRAN_CD",	this.cob_BRAN_CD.Value);
			this.ds_auto_match_in.SetColumn(0, "REPTPRES",	ds_s06_bankbook.GetColumn(ds_s06_bankbook.currow, "REPTPRES"));
			this.ds_auto_match_in.SetColumn(0, "REPT_AMT",	ds_s06_bankbook.GetColumn(ds_s06_bankbook.currow, "REPT_AMT"));
			this.ds_auto_match_in.SetColumn(0, "REPT_DAY",	ds_s06_bankbook.GetColumn(ds_s06_bankbook.currow, "REPT_DAY"));
			this.ds_auto_match_in.SetColumn(0, "REPT_NUM",	ds_s06_bankbook.GetColumn(ds_s06_bankbook.currow, "REPT_NUM"));
			
			//trace(this.ds_auto_match_in.SaveXML());
			gfn_syncCall("get_auto_match","KOMCA?SYSID=PATHFINDER&MENUID=1000001006001006&EVENTID=auto_matching_imsi","S=ds_auto_match_in","ds_auto_match_out=SEL11 ds_auto_match_err=SEL28","","fn_CallBack");
			trace(ds_auto_match_out.SaveXML());
			trace(ds_auto_match_err.SaveXML());
			if(ds_auto_match_out.rowcount == 1) //자동매칭성공
			{
				fn_GetReptInfo(ds_auto_match_out.GetColumn(0, "UPSO_CD"), ds_auto_match_out.GetColumn(0, "UPSO_NM"));
			}
			if(ds_auto_match_err.rowcount == 1) //폐업업소
			{
				v_auto_err += ds_auto_match_err.GetColumn(0, "UPSO_CD") + "  ";
			}
		}
		ds_auto_match_err.ClearData();
	}
	
	if(length(v_auto_err) > 0)
	{
		tab_REPT.TRANS.img_auto_err.Visible = true;
		tab_REPT.TRANS.stt_auto_err.Visible = true;
		tab_REPT.TRANS.edt_auto_err.Visible = true;
		tab_REPT.TRANS.edt_auto_err.Text = v_auto_err;
	}
	else
	{
		tab_REPT.TRANS.img_auto_err.Visible = false;
		tab_REPT.TRANS.stt_auto_err.Visible = false;
		tab_REPT.TRANS.edt_auto_err.Visible = false;
		tab_REPT.TRANS.edt_auto_err.Text = "";
	}
	this.tab_REPT.TRANS.btn_auto_matching.Text = "자동매칭 실행";
}

function cal_OnChanged(obj,strOldText,strNewText)
{
	if(obj == cal_START_DAY)
	{
		if(cal_START_DAY.Value > cal_END_DAY.Value)
			cal_END_DAY.Value = cal_START_DAY.Value;
	}
	else if(obj == cal_END_DAY)
	{
		if(cal_START_DAY.Value > cal_END_DAY.Value)
			cal_START_DAY.Value = cal_END_DAY.Value;
	}
}
]]></Script>
</Window>